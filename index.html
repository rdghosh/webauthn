<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>Web Authentication: An API for accessing Scoped Credentials </title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="ED" name="w3c-status">
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-ED" rel="stylesheet" type="text/css">
  <meta content="Bikeshed 1.0.0" name="generator">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure);
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
        .highlight:not(.idl) { background: hsl(24, 20%, 95%); }
        code.highlight { padding: .1em; border-radius: .3em; }
        pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
        .highlight .c { color: #708090 } /* Comment */
        .highlight .k { color: #990055 } /* Keyword */
        .highlight .l { color: #000000 } /* Literal */
        .highlight .n { color: #0077aa } /* Name */
        .highlight .o { color: #999999 } /* Operator */
        .highlight .p { color: #999999 } /* Punctuation */
        .highlight .cm { color: #708090 } /* Comment.Multiline */
        .highlight .cp { color: #708090 } /* Comment.Preproc */
        .highlight .c1 { color: #708090 } /* Comment.Single */
        .highlight .cs { color: #708090 } /* Comment.Special */
        .highlight .kc { color: #990055 } /* Keyword.Constant */
        .highlight .kd { color: #990055 } /* Keyword.Declaration */
        .highlight .kn { color: #990055 } /* Keyword.Namespace */
        .highlight .kp { color: #990055 } /* Keyword.Pseudo */
        .highlight .kr { color: #990055 } /* Keyword.Reserved */
        .highlight .kt { color: #990055 } /* Keyword.Type */
        .highlight .ld { color: #000000 } /* Literal.Date */
        .highlight .m { color: #000000 } /* Literal.Number */
        .highlight .s { color: #a67f59 } /* Literal.String */
        .highlight .na { color: #0077aa } /* Name.Attribute */
        .highlight .nc { color: #0077aa } /* Name.Class */
        .highlight .no { color: #0077aa } /* Name.Constant */
        .highlight .nd { color: #0077aa } /* Name.Decorator */
        .highlight .ni { color: #0077aa } /* Name.Entity */
        .highlight .ne { color: #0077aa } /* Name.Exception */
        .highlight .nf { color: #0077aa } /* Name.Function */
        .highlight .nl { color: #0077aa } /* Name.Label */
        .highlight .nn { color: #0077aa } /* Name.Namespace */
        .highlight .py { color: #0077aa } /* Name.Property */
        .highlight .nt { color: #669900 } /* Name.Tag */
        .highlight .nv { color: #222222 } /* Name.Variable */
        .highlight .ow { color: #999999 } /* Operator.Word */
        .highlight .mb { color: #000000 } /* Literal.Number.Bin */
        .highlight .mf { color: #000000 } /* Literal.Number.Float */
        .highlight .mh { color: #000000 } /* Literal.Number.Hex */
        .highlight .mi { color: #000000 } /* Literal.Number.Integer */
        .highlight .mo { color: #000000 } /* Literal.Number.Oct */
        .highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
        .highlight .sc { color: #a67f59 } /* Literal.String.Char */
        .highlight .sd { color: #a67f59 } /* Literal.String.Doc */
        .highlight .s2 { color: #a67f59 } /* Literal.String.Double */
        .highlight .se { color: #a67f59 } /* Literal.String.Escape */
        .highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
        .highlight .si { color: #a67f59 } /* Literal.String.Interpol */
        .highlight .sx { color: #a67f59 } /* Literal.String.Other */
        .highlight .sr { color: #a67f59 } /* Literal.String.Regex */
        .highlight .s1 { color: #a67f59 } /* Literal.String.Single */
        .highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
        .highlight .vc { color: #0077aa } /* Name.Variable.Class */
        .highlight .vg { color: #0077aa } /* Name.Variable.Global */
        .highlight .vi { color: #0077aa } /* Name.Variable.Instance */
        .highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
        </style>
 <body class="h-entry">
  <div class="head">
   <header>
    <p data-fill-with="logo"><a href="https://www.w3.org/"><img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"></a> </p>
    <h1 class="p-name no-ref" id="title">Web Authentication: An API for accessing Scoped Credentials </h1>
    <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Editor’s Draft, <time class="dt-updated" datetime="2016-08-10">10 August 2016</time></span></h2>
   </header>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://w3c.github.io/webauthn/">http://w3c.github.io/webauthn/</a>
     <dt>Latest published version:
     <dd><a href="http://www.w3.org/TR/webauthn/">http://www.w3.org/TR/webauthn/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:vijay.bharadwaj@microsoft.com">Vijay Bharadwaj</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hlevangong@paypal.com">Hubert Le Van Gong</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:balfanz@google.com">Dirk Balfanz</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:aczeskis@google.com">Alexei Czeskis</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:arnarb@google.com">Arnar Birgisson</a> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:Jeff.Hodges@paypal.com">Jeff Hodges</a> (<span class="p-org org">PayPal</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:mbj@microsoft.com">Michael B. Jones</a> (<span class="p-org org">Microsoft</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:rolf@noknok.com">Rolf Lindemann</a> (<span class="p-org org">Nok Nok Labs</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:jc@mozilla.com">J.C. Jones</a> (<span class="p-org org">Mozilla</span>)
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2016 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This specification defines an API enabling the creation and use of strong, attested, cryptographic scoped credentials

by web applications, for the purpose of strongly authenticating users. Conceptually, one or more credentials, each scoped to a
given Relying Party, are created and stored on an authenticator by the user agent in conjunction with the web application. The
user agent mediates access to scoped credentials in order to preserve user privacy. Authenticators are responsible for ensuring
that no operation is performed without user consent. Authenticators provide cryptographic proof of their properties to relying
parties via attestation. This specification also describes the functional model for WebAuthn conformant authenticators,
including their signature and attestation functionality.</p>
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication. Other
    documents may supersede this document. A list of current <abbr title="World Wide Web Consortium">W3C</abbr> publications and the latest revision of this
    technical report can be found in the <a href="http://www.w3.org/TR/"><abbr title="World Wide Web Consortium">W3C</abbr> technical
    reports index</a> at http://www.w3.org/TR/.</em> </p>
   <p> This document was published by the <a href="https://www.w3.org/webauthn/">Web Authentication Working Group</a> as an Editors' Draft. This document is intended to become a W3C Recommendation.

    Feedback and comments on this specification are welcome. Please use <a href="https://github.com/w3c/reporting/issues">Github issues</a>.
    Discussions may also be found in the <a href="http://lists.w3.org/Archives/Public/public-webauthn/">public-webauthn@w3.org archives</a>. </p>
   <p> Publication as an Editors' Draft does not imply endorsement by the <abbr title="World Wide Web Consortium">W3C</abbr> Membership. This is a draft document and may
    be updated, replaced or obsoleted by other documents at any time. It is inappropriate to cite
    this document as other than work in progress. </p>
   <p> This document was produced by a group operating under the <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. <abbr title="World Wide Web Consortium">W3C</abbr> maintains a <a href="https://www.w3.org/2004/01/pp-impl/87227/status" rel="disclosure">public list of any
    patent disclosures</a> made in connection with the deliverables of the group; that page also
    includes instructions for disclosing a patent. An individual who has actual knowledge of a
    patent which the individual believes contains <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
    Claim(s)</a> must disclose the information in accordance with <a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the <abbr title="World Wide Web Consortium">W3C</abbr> Patent Policy</a>. </p>
   <p> This document is governed by the <a href="http://www.w3.org/2015/Process-20150901/" id="w3c_process_revision">1 September 2015 <abbr title="World Wide Web Consortium">W3C</abbr> Process Document</a>. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li>
     <a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
     <ol class="toc">
      <li>
       <a href="#use-cases"><span class="secno">1.1</span> <span class="content">Use Cases</span></a>
       <ol class="toc">
        <li><a href="#usecase-registration"><span class="secno">1.1.1</span> <span class="content">Registration</span></a>
        <li><a href="#usecase-authentication"><span class="secno">1.1.2</span> <span class="content">Authentication</span></a>
        <li><a href="#other-configurations"><span class="secno">1.1.3</span> <span class="content">Other use cases and configurations</span></a>
       </ol>
     </ol>
    <li>
     <a href="#conformance"><span class="secno">2</span> <span class="content">Conformance</span></a>
     <ol class="toc">
      <li><a href="#dependencies"><span class="secno">2.1</span> <span class="content">Dependencies</span></a>
     </ol>
    <li><a href="#terminology"><span class="secno">3</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#api"><span class="secno">4</span> <span class="content"><span>Web Authentication API</span></span></a>
     <ol class="toc">
      <li>
       <a href="#iface-credential"><span class="secno">4.1</span> <span class="content"><span>WebAuthentication</span> Interface</span></a>
       <ol class="toc">
        <li><a href="#makeCredential"><span class="secno">4.1.1</span> <span class="content">Create a new credential (<span>makeCredential()</span> method)</span></a>
        <li><a href="#getAssertion"><span class="secno">4.1.2</span> <span class="content">Use an existing credential (<span>getAssertion()</span> method)</span></a>
       </ol>
      <li><a href="#iface-credentialInfo"><span class="secno">4.2</span> <span class="content"><span>ScopedCredentialInfo</span> Interface</span></a>
      <li><a href="#iface-account"><span class="secno">4.3</span> <span class="content">User Account Information (dictionary <span>Account</span>)</span></a>
      <li><a href="#credential-params"><span class="secno">4.4</span> <span class="content">Parameters for Credential Generation (dictionary <span>ScopedCredentialParameters</span>)</span></a>
      <li><a href="#credential-options"><span class="secno">4.5</span> <span class="content">Additional options for Credential Generation (dictionary <span>CredentialOptions</span>)</span></a>
      <li><a href="#iface-assertion"><span class="secno">4.6</span> <span class="content">WebAuthn Assertion (interface <span>WebAuthnAssertion</span>)</span></a>
      <li><a href="#assertion-options"><span class="secno">4.7</span> <span class="content">Additional options for Assertion Generation (dictionary <span>AssertionOptions</span>)</span></a>
      <li><a href="#iface-assertion-extensions"><span class="secno">4.8</span> <span class="content">WebAuthn Assertion Extensions (dictionary <span>WebAuthnExtensions</span>)</span></a>
      <li><a href="#iface-attestation"><span class="secno">4.9</span> <span class="content">Credential Attestation Statement (interface <span>WebAuthnAttestation</span>)</span></a>
      <li>
       <a href="#supporting-data-structures"><span class="secno">4.10</span> <span class="content">Supporting Data Structures</span></a>
       <ol class="toc">
        <li><a href="#credentialType"><span class="secno">4.10.1</span> <span class="content">Credential Type enumeration (enum <span>CredentialType</span>)</span></a>
        <li><a href="#credential-identifier"><span class="secno">4.10.2</span> <span class="content">Unique Identifier for Credential (interface <span>Credential</span>)</span></a>
        <li><a href="#credential-dictionary"><span class="secno">4.10.3</span> <span class="content">Credential Descriptor (dictionary <span>CredentialDescription</span>)</span></a>
        <li><a href="#alg-identifier"><span class="secno">4.10.4</span> <span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><span>AlgorithmIdentifier</span></code>)</span></a>
       </ol>
     </ol>
    <li>
     <a href="#authenticator-model"><span class="secno">5</span> <span class="content">WebAuthn Authenticator model</span></a>
     <ol class="toc">
      <li>
       <a href="#authenticator-ops"><span class="secno">5.1</span> <span class="content">Authenticator operations</span></a>
       <ol class="toc">
        <li><a href="#op-make-cred"><span class="secno">5.1.1</span> <span class="content">The <span>authenticatorMakeCredential</span> operation</span></a>
        <li><a href="#op-get-assertion"><span class="secno">5.1.2</span> <span class="content">The <span>authenticatorGetAssertion</span> operation</span></a>
        <li><a href="#op-cancel"><span class="secno">5.1.3</span> <span class="content">The <span>authenticatorCancel</span> operation</span></a>
       </ol>
      <li>
       <a href="#signature-format"><span class="secno">5.2</span> <span class="content">Signature Format</span></a>
       <ol class="toc">
        <li><a href="#sec-client-data"><span class="secno">5.2.1</span> <span class="content">Client data used in WebAuthn signatures (dictionary <span>ClientData</span>)</span></a>
        <li><a href="#sec-authenticator-data"><span class="secno">5.2.2</span> <span class="content">Authenticator data</span></a>
        <li><a href="#authenticator-signature"><span class="secno">5.2.3</span> <span class="content">Generating a signature</span></a>
       </ol>
      <li>
       <a href="#attestation"><span class="secno">5.3</span> <span class="content">Credential Attestation Statements</span></a>
       <ol class="toc">
        <li><a href="#attestation-types"><span class="secno">5.3.1</span> <span class="content">Attestation Types</span></a>
        <li><a href="#verifying-an-attestation-statement"><span class="secno">5.3.2</span> <span class="content">Verifying an Attestation Statement</span></a>
        <li>
         <a href="#sec-attestation-security-considerations"><span class="secno">5.3.3</span> <span class="content">Security Considerations</span></a>
         <ol class="toc">
          <li><a href="#sec-attestation-privacy"><span class="secno">5.3.3.1</span> <span class="content">Privacy</span></a>
          <li><a href="#ca-compromise"><span class="secno">5.3.3.2</span> <span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span></a>
          <li><a href="#cert-hierarchy"><span class="secno">5.3.3.3</span> <span class="content">Attestation Certificate Hierarchy</span></a>
         </ol>
       </ol>
     </ol>
    <li>
     <a href="#defined-attestation-formats"><span class="secno">6</span> <span class="content">Defined Attestation Formats</span></a>
     <ol class="toc">
      <li>
       <a href="#packed-attestation"><span class="secno">6.1</span> <span class="content">Packed Attestation ("packed")</span></a>
       <ol class="toc">
        <li><a href="#sec-raw-data-packed"><span class="secno">6.1.1</span> <span class="content">Attestation rawData</span></a>
        <li><a href="#packed-attestation-signature"><span class="secno">6.1.2</span> <span class="content">Signature</span></a>
        <li><a href="#packed-attestation-cert-requirements"><span class="secno">6.1.3</span> <span class="content">Packed attestation statement certificate requirements</span></a>
       </ol>
      <li>
       <a href="#tpm-attestation"><span class="secno">6.2</span> <span class="content">TPM Attestation ("tpm")</span></a>
       <ol class="toc">
        <li><a href="#sec-raw-data-tpm"><span class="secno">6.2.1</span> <span class="content">Attestation rawData</span></a>
        <li><a href="#tpm-attestation-signature"><span class="secno">6.2.2</span> <span class="content">Signature</span></a>
        <li><a href="#tpm-cert-requirements"><span class="secno">6.2.3</span> <span class="content">TPM attestation statement certificate requirements</span></a>
       </ol>
      <li>
       <a href="#android-attestation"><span class="secno">6.3</span> <span class="content">Android Attestation (type="android")</span></a>
       <ol class="toc">
        <li><a href="#sec-android-attestation-signature"><span class="secno">6.3.1</span> <span class="content">Signature</span></a>
        <li><a href="#verifying-android-contextual-bindings"><span class="secno">6.3.2</span> <span class="content">Verifying AndroidClientData specific contextual bindings</span></a>
       </ol>
     </ol>
    <li>
     <a href="#extensions"><span class="secno">7</span> <span class="content">WebAuthn Extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-id"><span class="secno">7.1</span> <span class="content">Extension identifiers</span></a>
      <li><a href="#extension-specification"><span class="secno">7.2</span> <span class="content">Defining extensions</span></a>
      <li><a href="#extension-request-parameters"><span class="secno">7.3</span> <span class="content">Extending request parameters</span></a>
      <li><a href="#extension-client-processing"><span class="secno">7.4</span> <span class="content">Extending client processing</span></a>
      <li><a href="#extension-authenticator-processing"><span class="secno">7.5</span> <span class="content">Extending authenticator processing</span></a>
      <li><a href="#sample-extensions"><span class="secno">7.6</span> <span class="content">Example extension</span></a>
     </ol>
    <li>
     <a href="#extension-predef"><span class="secno">8</span> <span class="content">Pre-defined extensions</span></a>
     <ol class="toc">
      <li><a href="#extension-txauth"><span class="secno">8.1</span> <span class="content">Transaction authorization</span></a>
      <li><a href="#extension-authenticator-selection"><span class="secno">8.2</span> <span class="content">Authenticator Selection Extension</span></a>
      <li><a href="#supported-extensions-extension"><span class="secno">8.3</span> <span class="content">SupportedExtensions Extension</span></a>
      <li><a href="#uvi-extension"><span class="secno">8.4</span> <span class="content">User Verification Index (UVI) Extension</span></a>
     </ol>
    <li><a href="#iana-considerations"><span class="secno">9</span> <span class="content">IANA Considerations</span></a>
    <li>
     <a href="#sample-scenarios"><span class="secno">10</span> <span class="content">Sample scenarios</span></a>
     <ol class="toc">
      <li><a href="#sample-registration"><span class="secno">10.1</span> <span class="content">Registration</span></a>
      <li><a href="#sample-authentication"><span class="secno">10.2</span> <span class="content">Authentication</span></a>
      <li><a href="#sample-decommissioning"><span class="secno">10.3</span> <span class="content">Decommissioning</span></a>
     </ol>
    <li><a href="#acknowledgements"><span class="secno">11</span> <span class="content">Acknowledgements</span></a>
    <li>
     <a href="#index"><span class="secno"></span> <span class="content">Index</span></a>
     <ol class="toc">
      <li><a href="#index-defined-here"><span class="secno"></span> <span class="content">Terms defined by this specification</span></a>
      <li><a href="#index-defined-elsewhere"><span class="secno"></span> <span class="content">Terms defined by reference</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
    <li><a href="#idl-index"><span class="secno"></span> <span class="content">IDL Index</span></a>
   </ol>
  </nav>
  <main>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>This specification defines an API enabling the creation and use of strong, attested, cryptographic <em><a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-1">scoped
credentials</a></em> by web applications, for the purpose of strongly authenticating users. A <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-2">scoped credential</a> is
created and stored by an <em><a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-1">authenticator</a></em> at the behest of a <em><a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-1">Relying Party</a></em>, subject to <em><a data-link-type="dfn" href="#user-consent" id="ref-for-user-consent-1">user
consent</a></em>. Subsequently, the scoped credential can only be accessed by web origins belonging to that Relying Party.
This scoping is enforced jointly by <em><a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-1">conforming User Agents</a></em> and <em><a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-2">authenticators</a></em>. 
Additionally, privacy across <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-2">Relying Parties</a> is maintained; Relying Parties are not able to detect any properties, or even
the existence, of credentials scoped to other Relying Parties.</p>
   <p>Relying Parties employ the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-1">Web Authentication API</a> during two distinct, but related, <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-1">ceremonies</a> involving a user. The first
is <a data-link-type="dfn" href="#registration" id="ref-for-registration-1">Registration</a>, where a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-3">scoped credential</a> is created on an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-3">authenticator</a>, and associated by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-3">Relying Party</a> with the present user’s account (the account may already exist or may be created at this time). The second is <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-1">Authentication</a>, where the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-4">Relying Party</a> is presented with a <em><a data-link-type="dfn" href="#webauthn-assertion" id="ref-for-webauthn-assertion-1">WebAuthn Assertion</a></em> proving the presence and
consent of the user who registered the <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-4">scoped credential</a>. Functionally, the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-2">Web Authentication API</a> comprises two
methods (along with associated data structures): <a data-link-type="functionish" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-1">makeCredential()</a> and <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-1">getAssertion()</a>. The former is used during <a data-link-type="dfn" href="#registration" id="ref-for-registration-2">Registration</a> and the latter during <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-2">Authentication</a>.</p>
   <p>Broadly, compliant <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-4">authenticators</a> protect <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-5">scoped credentials</a>, and
interact with user agents to implement the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-3">Web Authentication API</a>. Some
authenticators may run on the same computing device (e.g., smart phone, tablet,
desktop PC) as the user agent is running on. For instance, such an authenticator
might consist of a Trusted Execution Environment (TEE) applet, a Trusted
Platform Module (TPM), or a Secure Element (SE) integrated into the computing
device in conjunction with some means for <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-1">user verification</a>, along with
appropriate platform software to mediate access to these components'
functionality. Other authenticators may operate autonomously from the computing
device running the user agent, and be accessed over a transport such as
Universal Serial Bus (USB), Bluetooth Low Energy (BLE) or Near Field
Communications (NFC).</p>
   <h3 class="heading settled" data-level="1.1" id="use-cases"><span class="secno">1.1. </span><span class="content">Use Cases</span><a class="self-link" href="#use-cases"></a></h3>
   <p>The below use case scenarios illustrate use of two very different types of <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-5">authenticators</a>, as well as outline further
scenarios. Additional scenarios, including sample code, are given later in <a href="#sample-scenarios">§10 Sample scenarios</a>.</p>
   <h4 class="heading settled" data-level="1.1.1" id="usecase-registration"><span class="secno">1.1.1. </span><span class="content">Registration</span><a class="self-link" href="#usecase-registration"></a></h4>
   <ul>
    <li data-md="">
     <p>On a phone:</p>
     <ul>
      <li data-md="">
       <p>User navigates to example.com in a browser and signs in to an existing account using whatever method they have been using
(possibly a legacy method such as a password), or creates a new account.</p>
      <li data-md="">
       <p>The phone prompts, "Do you want to register this device with example.com?"</p>
      <li data-md="">
       <p>User agrees.</p>
      <li data-md="">
       <p>The phone prompts the user for a previously configured <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-1">authorization gesture</a> (PIN, biometric, etc.); the user
provides this.</p>
      <li data-md="">
       <p>Website shows message, "Registration complete."</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="1.1.2" id="usecase-authentication"><span class="secno">1.1.2. </span><span class="content">Authentication</span><a class="self-link" href="#usecase-authentication"></a></h4>
   <ul>
    <li data-md="">
     <p>On a laptop:</p>
     <ul>
      <li data-md="">
       <p>User navigates to example.com in a browser, sees an option to "Sign in with your phone."</p>
      <li data-md="">
       <p>User chooses this option and gets a message from the browser, "Please complete this action on your phone."</p>
     </ul>
    <li data-md="">
     <p>Next, on their phone:</p>
     <ul>
      <li data-md="">
       <p>User sees a discreet prompt or notification, "Sign in to example.com."</p>
      <li data-md="">
       <p>User selects this prompt / notification.</p>
      <li data-md="">
       <p>User is shown a list of their example.com identities, e.g., "Sign in as Alice / Sign in as Bob."</p>
      <li data-md="">
       <p>User picks an identity, is prompted for an <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-2">authorization gesture</a> (PIN, biometric, etc.) and provides this.</p>
     </ul>
    <li data-md="">
     <p>Now, back on the laptop:</p>
     <ul>
      <li data-md="">
       <p>Web page shows that the selected user is signed-in, and navigates to the signed-in page.</p>
     </ul>
   </ul>
   <h4 class="heading settled" data-level="1.1.3" id="other-configurations"><span class="secno">1.1.3. </span><span class="content">Other use cases and configurations</span><a class="self-link" href="#other-configurations"></a></h4>
   <p>A variety of additional use cases and configurations are also possible, including (but not limited to):</p>
   <ul>
    <li data-md="">
     <p>User navigates to example.com on their laptop, is guided through a flow to create and register a credential on their phone.</p>
    <li data-md="">
     <p>A Relying Party prompts the user for their <a data-link-type="dfn" href="#authorization-gesture" id="ref-for-authorization-gesture-3">authorization gesture</a> in order to authorize a single transaction, such as a payment
or other financial transaction.</p>
   </ul>
   <h2 class="heading settled" data-level="2" id="conformance"><span class="secno">2. </span><span class="content">Conformance</span><a class="self-link" href="#conformance"></a></h2>
   <p>This specification defines criteria for a <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-2">Conforming User Agent</a>: a User Agent MUST behave as described in this
specification in order to be considered conformant. <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-3">Conforming User Agents</a> MAY implement algorithms given in this
specification in any way desired, so long as the end result is indistinguishable from the result that would be obtained by the
specification’s algorithms. A conforming User Agent MUST also be a conforming implementation of the IDL fragments of this
specification, as described in the “Web IDL” specification. <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a></p>
   <p>This specification also defines a model of a conformant <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-6">authenticator</a> (see <a href="#authenticator-model">§5 WebAuthn Authenticator model</a>). This is a set of
functional and security requirements for an authenticator to be usable by a <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-4">Conforming User Agent</a>. As described in <a href="#use-cases">§1.1 Use Cases</a>, an authenticator may be implemented in the operating system underlying the User Agent, or in external hardware,
or a combination of both.</p>
   <h3 class="heading settled" data-level="2.1" id="dependencies"><span class="secno">2.1. </span><span class="content">Dependencies</span><a class="self-link" href="#dependencies"></a></h3>
   <p>This specification relies on several other underlying specifications.</p>
   <dl>
    <dt data-md="">
     <p>HTML5</p>
    <dd data-md="">
     <p>The concept of <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="origin">origin</dfn> and the <dfn data-dfn-type="dfn" data-noexport="" id="navigator-dfn-interface-are-defined-in-html5">Navigator/dfn> interface are defined in <a data-link-type="biblio" href="#biblio-html5">[HTML5]</a>.<a class="self-link" href="#navigator-dfn-interface-are-defined-in-html5"></a></dfn></p>
    <dt data-md="">
     <p>Web IDL</p>
    <dd data-md="">
     <p>Many of the interface definitions and all of the IDL in this specification depend on <a data-link-type="biblio" href="#biblio-webidl-1">[WebIDL-1]</a>. This updated version of
the Web IDL standard adds support for <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="promises">Promises</dfn>, which are now the preferred mechanism for asynchronous
interaction in all new web APIs.</p>
    <dt data-md="">
     <p>DOM</p>
    <dd data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="domexception">DOMException</dfn> and the DOMException values used in this specification are defined in <a data-link-type="biblio" href="#biblio-dom4">[DOM4]</a>.</p>
    <dt data-md="">
     <p>Web Cryptography API</p>
    <dd data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-algorithmidentifier">AlgorithmIdentifier</dfn> type and the method for normalizing an algorithm are defined in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-dictionary">Web Cryptography API §algorithm-dictionary</a>.</p>
    <dd data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-cryptokey">CryptoKey</dfn> type for representing cryptographic keys is defined in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#cryptokey-interface">Web Cryptography API §cryptokey-interface</a>.</p>
    <dd data-md="">
     <p>The <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-jsonwebkey">JsonWebKey</dfn> dictionary for representing cryptographic keys is defined in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#JsonWebKey-dictionary">Web Cryptography API §JsonWebKey-dictionary</a>.</p>
    <dt data-md="">
     <p>Base64url encoding</p>
    <dd data-md="">
     <p>The term <dfn data-dfn-type="dfn" data-noexport="" id="base64url-encoding">Base64url Encoding<a class="self-link" href="#base64url-encoding"></a></dfn> refers to the base64 encoding using the URL- and filename-safe character set defined
in Section 5 of <a data-link-type="biblio" href="#biblio-rfc4648">[RFC4648]</a>, with all trailing '=' characters omitted (as permitted by Section 3.2) and without the
inclusion of any line breaks, whitespace, or other additional characters. This is the same encoding as used by JSON Web
Signature (JWS) <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a>.</p>
   </dl>
   <p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
"OPTIONAL" in this document are to be interpreted as described in <a data-link-type="biblio" href="#biblio-rfc2119">[RFC2119]</a>.</p>
   <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <dl>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="assertion">Assertion<a class="self-link" href="#assertion"></a></dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#webauthn-assertion" id="ref-for-webauthn-assertion-2">WebAuthn Assertion</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestation-certificate">Attestation Certificate</dfn></p>
    <dd data-md="">
     <p>A X.509 Certificate for a key pair used by an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-7">Authenticator</a> to attest to its manufacture and capabilities. The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-8">Authenticator</a> uses the attestation private key to sign the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-5">Relying Party</a>-specific public key (and additional data) it
generates and returns upon invocation via the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-1">authenticatorMakeCredential</a> operation.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authentication">Authentication</dfn></p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-2">ceremony</a> where a user, and the user’s computing device(s) (containing at least one <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-9">authenticator</a>) work in
concert to cryptographically prove to an <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-6">Relying Party</a> that the user controls the private key associated with a
previously-registered <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-6">scoped credential</a> (see <a data-link-type="dfn" href="#registration" id="ref-for-registration-3">Registration</a>). Note that this includes employing <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-2">user
verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticator">Authenticator</dfn></p>
    <dd data-md="">
     <p>A cryptographic device used by a <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-1">WebAuthn Client</a> to (i) generate a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-7">scoped credential</a> and register it with a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-7">Relying Party</a>,
and (ii) subsequently used to cryptographically sign and return, in the form of an <a data-link-type="dfn" href="#webauthn-assertion" id="ref-for-webauthn-assertion-3">WebAuthn Assertion</a>, a challenge
and other data presented by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-8">Relying Party</a> (in concert with the <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-2">WebAuthn Client</a>) in order to effect authentication.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authorization-gesture">Authorization Gesture</dfn></p>
    <dd data-md="">
     <p>Essentially the same as <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-3">user verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="ceremony">Ceremony</dfn></p>
    <dd data-md="">
     <p>The concept of a ceremony <a data-link-type="biblio" href="#biblio-ceremony">[Ceremony]</a> is an extension of the concept of a network protocol, with human nodes alongside
computer nodes and with communication links that include UI, human-to-human communication and transfers of physical objects
that carry data. What is out-of-band to a protocol is in-band to a ceremony. In this specification, <a data-link-type="dfn" href="#registration" id="ref-for-registration-4">Registration</a>, <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-3">Authentication</a>, and <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-4">user verification</a> are ceremonies.</p>
    <dt data-md="">
     <p><dfn data-dfn-type="dfn" data-noexport="" id="client">Client<a class="self-link" href="#client"></a></dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-5">Conforming User Agent</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="conforming-user-agent">Conforming User Agent</dfn></p>
    <dd data-md="">
     <p>A user agent implementing, in conjunction with the underlying platform, the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-4">Web Authentication API</a> and algorithms
given in this specification, and handling communication between <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-10">Authenticators</a> and <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-9">Relying Parties</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="etld1">eTLD+1</dfn></p>
    <dd data-md="">
     <p>Also known as a <em>Registered Domain</em> <a data-link-type="biblio" href="#biblio-psl">[PSL]</a>, an eTLD+1 is an <em>effective Top-Level Domain Name</em> (eTLD), plus the
next domain name label, proceding from right to left. An eTLD is also known as a <em>public suffix</em> <a data-link-type="biblio" href="#biblio-rfc7719">[RFC7719]</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="registration">Registration</dfn></p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#ceremony" id="ref-for-ceremony-3">ceremony</a> where a user, a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-10">Relying Party</a>, and the user’s computing device(s) (containing at least one <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-11">authenticator</a>) work in concert to create a <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-8">scoped credential</a> and associate it with the user’s <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-11">Relying Party</a> account. Note that this includes employing <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-5">user verification</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="relying-party">Relying Party</dfn></p>
    <dd data-md="">
     <p>The entity whose web application utilizes the <a data-link-type="dfn" href="#web-authentication-api" id="ref-for-web-authentication-api-5">Web Authentication API</a> to register and authenticate users. See <a data-link-type="dfn" href="#registration" id="ref-for-registration-5">Registration</a> and <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-4">Authentication</a>, respectively.</p>
     <p class="note" role="note">Note: While the term Relying Party is used in other contexts (e.g., X.509 and OAuth), an entity acting as an Relying Party in one context is
    not necessarily an Relying Party in others.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="relying-party-identifier">Relying Party Identifier</dfn></p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="rp-id">RP ID</dfn></p>
    <dd data-md="">
     <p>A Relying Party Identifier is derived from a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-12">Relying Party</a>’s web origin’s hostname by computing the hostname’s <a data-link-type="dfn" href="#etld1" id="ref-for-etld1-1">eTLD+1</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="scoped-credential">Scoped Credential</dfn></p>
    <dd data-md="">
     <p>Generically, a credential is data one entity presents to another in order to authenticate the former’s identity <a data-link-type="biblio" href="#biblio-rfc4949">[RFC4949]</a>.
A WebAuthn <em><a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-9">scoped credential</a></em> is a <code>{ identifier, type }</code> pair identifying authentication
information established by the authenticator and the Relying Party, together, at <a data-link-type="dfn" href="#registration" id="ref-for-registration-6">registration</a> time. 
The authentication information consists of an asymmetric key pair, where the public key portion is returned to the Relying Party. who
stores it in conjunction with the present user’s account.
The authenticator maps the private key to the Relying Party’s <a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-1">RP ID</a> and stores it. 
Subsequently, only that Relying Party, as identified by its <a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-2">RP ID</a>, is able to employ the <a data-link-type="dfn" href="#scoped-credential" id="ref-for-scoped-credential-10">scoped credential</a> in <a data-link-type="dfn" href="#authentication" id="ref-for-authentication-5">authentication</a> ceremonies, via the <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-2">getAssertion()</a> method. 
The Relying Party uses its copy of the stored public key to verify the resultant <a data-link-type="dfn" href="#webauthn-assertion" id="ref-for-webauthn-assertion-4">WebAuthn Assertion</a>.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="user-consent">User Consent</dfn></p>
    <dd data-md="">
     <p>User consent means the user agrees with what they are being asked, i.e., it encompasses reading and understanding prompts. <a data-link-type="dfn" href="#user-verification" id="ref-for-user-verification-6">User verification</a> encompasses the means employed by the user to indicate consent.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="user-verification">User Verification</dfn></p>
    <dd data-md="">
     <p>The process by which an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-12">authenticator</a> <em>locally authorizes</em> the invocation of the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-2">authenticatorMakeCredential</a> and <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-1">authenticatorGetAssertion</a> operations, for example through a touch plus pin
code, a password, a gesture (e.g., presenting a fingerprint), or other modality. Note that invocation of said operations
implies use of key material managed by the authenticator.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="webauthn-assertion">WebAuthn Assertion</dfn></p>
    <dd data-md="">
     <p>The cryptographically signed <code class="idl"><a data-link-type="idl" href="#webauthnassertion" id="ref-for-webauthnassertion-1">WebAuthnAssertion</a></code> object returned by an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-13">authenticator</a> as the result of a <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-2">authenticatorGetAssertion</a> operation.</p>
    <dt data-md="">
     <p><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="webauthn-client">WebAuthn Client</dfn></p>
    <dd data-md="">
     <p>See <a data-link-type="dfn" href="#conforming-user-agent" id="ref-for-conforming-user-agent-6">Conforming User Agent</a>.</p>
   </dl>
   <h2 class="heading settled" data-level="4" id="api"><span class="secno">4. </span><span class="content"><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="web-authentication-api">Web Authentication API</dfn></span><a class="self-link" href="#api"></a></h2>
   <p>This section normatively specifies the API for creating and using scoped credentials. Support for deleting credentials is
deliberately omitted; this is expected to be done through platform-specific user interfaces rather than from a script. The basic 
idea is that the credentials belong to the user and are managed by an authenticator, with which the Relying Party interacts through the 
client (consisting of the browser and underlying OS platform). Scripts can (with the user’s consent) request the browser to 
create a new credential for future use by the Relying Party. Scripts can also request the user’s permission to perform authentication 
operations with an existing credential. All such operations are performed in the authenticator and are mediated by the browser 
and/or platform on the user’s behalf. At no point does the script get access to the credentials themselves; it only gets 
information about the credentials in the form of objects.</p>
   <p>The security properties of this API are provided by the client and the authenticator working together. The authenticator, which
holds and manages credentials, ensures that all operations are scoped to a particular web origin, and cannot be replayed against
a different origin, by incorporating the origin in its responses. Specifically, as defined in <a href="#signature-format">§5.2 Signature Format</a>, the full
origin of the requester is included, and signed over, in the attestation statement produced when a new credential is created as
well as in all assertions produced by WebAuthn credentials.</p>
   <p>Additionally, to maintain user privacy and prevent malicious Relying Parties from probing for the presence of credentials belonging to
other Relying Parties, each credential is also associated with a Relying Party Identifier, or RP ID. This RP ID is provided by the client
to the authenticator for all operations, and the authenticator ensures that credentials created by a Relying Party can only be used in
operations requested by the same RP ID. Separating the origin from the RP ID in this way allows the API to be used in cases
where a single Relying Party maintains multiple web origins.</p>
   <p>The client facilitates these security measures by providing correct web origins and RP IDs to the authenticator for each
operation. Since this is an integral part of the WebAuthn security model, user agents MUST only expose this API to callers in <dfn data-dfn-type="dfn" data-noexport="" id="secure-contexts">secure contexts<a class="self-link" href="#secure-contexts"></a></dfn>, as defined in <a data-link-type="biblio" href="#biblio-secure-contexts">[secure-contexts]</a>.</p>
   <p>The API is defined by the following Web IDL fragment.</p>
<pre class="idl highlight def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthentication" id="ref-for-webauthentication-1">WebAuthentication</a> <dfn class="nv idl-code" data-dfn-for="Navigator" data-dfn-type="attribute" data-export="" data-readonly="" data-type="WebAuthentication" id="dom-navigator-authentication">authentication<a class="self-link" href="#dom-navigator-authentication"></a></dfn>;
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthentication" id="ref-for-webauthentication-2">WebAuthentication</a> {
    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-1">ScopedCredentialInfo</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-2">makeCredential</a> (
        <a class="n" data-link-type="idl-name" href="#dictdef-account" id="ref-for-dictdef-account-1">Account</a>                                 <dfn class="nv idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">accountInformation<a class="self-link" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation"></a></dfn>,
        <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-1">ScopedCredentialParameters</a> > <dfn class="nv idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">cryptoParameters<a class="self-link" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters"></a></dfn>,
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                            <dfn class="nv idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">attestationChallenge<a class="self-link" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge"></a></dfn>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-credentialoptions" id="ref-for-dictdef-credentialoptions-1">CredentialOptions</a>              <dfn class="nv idl-code" data-dfn-for="WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge, options), WebAuthentication/makeCredential(accountInformation, cryptoParameters, attestationChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">options<a class="self-link" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options"></a></dfn>
    );

    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#webauthnassertion" id="ref-for-webauthnassertion-2">WebAuthnAssertion</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-3">getAssertion</a> (
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>               <dfn class="nv idl-code" data-dfn-for="WebAuthentication/getAssertion(assertionChallenge, options), WebAuthentication/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">assertionChallenge<a class="self-link" href="#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge"></a></dfn>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-assertionoptions" id="ref-for-dictdef-assertionoptions-1">AssertionOptions</a>  <dfn class="nv idl-code" data-dfn-for="WebAuthentication/getAssertion(assertionChallenge, options), WebAuthentication/getAssertion(assertionChallenge)" data-dfn-type="argument" data-export="" id="dom-webauthentication-getassertion-assertionchallenge-options-options">options<a class="self-link" href="#dom-webauthentication-getassertion-assertionchallenge-options-options"></a></dfn>
    );
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-2">ScopedCredentialInfo</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#credential" id="ref-for-credential-1">Credential</a>           <dfn class="nv idl-code" data-dfn-for="ScopedCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Credential" id="dom-scopedcredentialinfo-credential">credential<a class="self-link" href="#dom-scopedcredentialinfo-credential"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#dictdef-cryptokey" id="ref-for-dictdef-cryptokey-1">CryptoKey</a>            <dfn class="nv idl-code" data-dfn-for="ScopedCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="CryptoKey" id="dom-scopedcredentialinfo-publickey">publicKey<a class="self-link" href="#dom-scopedcredentialinfo-publickey"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthnattestation" id="ref-for-webauthnattestation-1">WebAuthnAttestation</a>  <dfn class="nv idl-code" data-dfn-for="ScopedCredentialInfo" data-dfn-type="attribute" data-export="" data-readonly="" data-type="WebAuthnAttestation" id="dom-scopedcredentialinfo-attestation">attestation<a class="self-link" href="#dom-scopedcredentialinfo-attestation"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-account" id="ref-for-dictdef-account-2">Account</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span> <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-rpdisplayname">rpDisplayName<a class="self-link" href="#dom-account-rpdisplayname"></a></dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString " id="dom-account-displayname">displayName<a class="self-link" href="#dom-account-displayname"></a></dfn>;
    <span class="kt">DOMString</span>          <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-name">name<a class="self-link" href="#dom-account-name"></a></dfn>;
    <span class="kt">DOMString</span>          <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-id">id<a class="self-link" href="#dom-account-id"></a></dfn>;
    <span class="kt">DOMString</span>          <dfn class="nv idl-code" data-dfn-for="Account" data-dfn-type="dict-member" data-export="" data-type="DOMString          " id="dom-account-imageurl">imageURL<a class="self-link" href="#dom-account-imageurl"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-2">ScopedCredentialParameters</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-1">CredentialType</a>        <dfn class="nv idl-code" data-dfn-for="ScopedCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="CredentialType        " id="dom-scopedcredentialparameters-type">type<a class="self-link" href="#dom-scopedcredentialparameters-type"></a></dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-1">AlgorithmIdentifier</a>   <dfn class="nv idl-code" data-dfn-for="ScopedCredentialParameters" data-dfn-type="dict-member" data-export="" data-type="AlgorithmIdentifier   " id="dom-scopedcredentialparameters-algorithm">algorithm<a class="self-link" href="#dom-scopedcredentialparameters-algorithm"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-credentialoptions" id="ref-for-dictdef-credentialoptions-2">CredentialOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                       <dfn class="nv idl-code" data-dfn-for="CredentialOptions" data-dfn-type="dict-member" data-export="" data-type="unsigned long                       " id="dom-credentialoptions-timeoutseconds">timeoutSeconds<a class="self-link" href="#dom-credentialoptions-timeoutseconds"></a></dfn>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-credentialdescription" id="ref-for-dictdef-credentialdescription-1">CredentialDescription</a> >  <dfn class="nv idl-code" data-dfn-for="CredentialOptions" data-dfn-type="dict-member" data-export="" data-type="sequence < CredentialDescription >  " id="dom-credentialoptions-excludelist">excludeList<a class="self-link" href="#dom-credentialoptions-excludelist"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions" id="ref-for-dictdef-webauthnextensions-1">WebAuthnExtensions</a>                  <dfn class="nv idl-code" data-dfn-for="CredentialOptions" data-dfn-type="dict-member" data-export="" data-type="WebAuthnExtensions                  " id="dom-credentialoptions-extensions">extensions<a class="self-link" href="#dom-credentialoptions-extensions"></a></dfn>;
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthnassertion" id="ref-for-webauthnassertion-3">WebAuthnAssertion</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#credential" id="ref-for-credential-2">Credential</a>  <dfn class="nv idl-code" data-dfn-for="WebAuthnAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="Credential" id="dom-webauthnassertion-credential">credential<a class="self-link" href="#dom-webauthnassertion-credential"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <dfn class="nv idl-code" data-dfn-for="WebAuthnAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-webauthnassertion-clientdata">clientData<a class="self-link" href="#dom-webauthnassertion-clientdata"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <dfn class="nv idl-code" data-dfn-for="WebAuthnAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-webauthnassertion-authenticatordata">authenticatorData<a class="self-link" href="#dom-webauthnassertion-authenticatordata"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <dfn class="nv idl-code" data-dfn-for="WebAuthnAssertion" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-webauthnassertion-signature">signature<a class="self-link" href="#dom-webauthnassertion-signature"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-assertionoptions" id="ref-for-dictdef-assertionoptions-2">AssertionOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                      <dfn class="nv idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="unsigned long                      " id="dom-assertionoptions-timeoutseconds">timeoutSeconds<a class="self-link" href="#dom-assertionoptions-timeoutseconds"></a></dfn>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-credentialdescription" id="ref-for-dictdef-credentialdescription-2">CredentialDescription</a> > <dfn class="nv idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="sequence < CredentialDescription > " id="dom-assertionoptions-allowlist">allowList<a class="self-link" href="#dom-assertionoptions-allowlist"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions" id="ref-for-dictdef-webauthnextensions-2">WebAuthnExtensions</a>                 <dfn class="nv idl-code" data-dfn-for="AssertionOptions" data-dfn-type="dict-member" data-export="" data-type="WebAuthnExtensions                 " id="dom-assertionoptions-extensions">extensions<a class="self-link" href="#dom-assertionoptions-extensions"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-webauthnextensions" id="ref-for-dictdef-webauthnextensions-3">WebAuthnExtensions</a> {
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthnattestation" id="ref-for-webauthnattestation-2">WebAuthnAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv idl-code" data-dfn-for="WebAuthnAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-webauthnattestation-type">type<a class="self-link" href="#dom-webauthnattestation-type"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv idl-code" data-dfn-for="WebAuthnAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-webauthnattestation-clientdata">clientData<a class="self-link" href="#dom-webauthnattestation-clientdata"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">any</span>           <dfn class="nv idl-code" data-dfn-for="WebAuthnAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="any" id="dom-webauthnattestation-statement">statement<a class="self-link" href="#dom-webauthnattestation-statement"></a></dfn>;
};

<span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-2">CredentialType</a> {
    <dfn class="s idl-code" data-dfn-for="CredentialType" data-dfn-type="enum-value" data-export="" data-lt="&quot;ScopedCred&quot;|ScopedCred" id="dom-credentialtype-scopedcred">"ScopedCred"<a class="self-link" href="#dom-credentialtype-scopedcred"></a></dfn>
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#credential" id="ref-for-credential-3">Credential</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-3">CredentialType</a> <dfn class="nv idl-code" data-dfn-for="Credential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="CredentialType" id="dom-credential-type">type<a class="self-link" href="#dom-credential-type"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>    <dfn class="nv idl-code" data-dfn-for="Credential" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-credential-id">id<a class="self-link" href="#dom-credential-id"></a></dfn>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-credentialdescription" id="ref-for-dictdef-credentialdescription-3">CredentialDescription</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-4">CredentialType</a> <dfn class="nv idl-code" data-dfn-for="CredentialDescription" data-dfn-type="dict-member" data-export="" data-type="CredentialType " id="dom-credentialdescription-type">type<a class="self-link" href="#dom-credentialdescription-type"></a></dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>   <dfn class="nv idl-code" data-dfn-for="CredentialDescription" data-dfn-type="dict-member" data-export="" data-type="BufferSource   " id="dom-credentialdescription-id">id<a class="self-link" href="#dom-credentialdescription-id"></a></dfn>;
};
</pre>
   <h3 class="heading settled" data-level="4.1" id="iface-credential"><span class="secno">4.1. </span><span class="content"><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="webauthentication">WebAuthentication</dfn> Interface</span><a class="self-link" href="#iface-credential"></a></h3>
   <p>This interface has two methods, which are described in the following subsections.</p>
   <h4 class="heading settled" data-level="4.1.1" id="makeCredential"><span class="secno">4.1.1. </span><span class="content">Create a new credential (<dfn class="dfn-paneled idl-code" data-dfn-for="WebAuthentication" data-dfn-type="method" data-export="" data-lt="makeCredential(accountInformation, cryptoParameters, attestationChallenge, options)|makeCredential(accountInformation, cryptoParameters, attestationChallenge)" id="dom-webauthentication-makecredential">makeCredential()</dfn> method)</span><a class="self-link" href="#makeCredential"></a></h4>
   <p>With this method, a script can request the User Agent to create a new credential of a given type and persist it to the
underlying platform, which may involve data storage managed by the browser or the OS. The user agent will prompt the user to
approve this operation. On success, the promise will be resolved with a <code class="idl"><a data-link-type="idl" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-3">ScopedCredentialInfo</a></code> object describing the newly
created credential.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="accountinformation">accountInformation</dfn> parameter specifies information about the user account for which the credential is being
created. This is meant for later use by the authenticator when it needs to prompt the user to select a credential.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="cryptoparameters">cryptoParameters</dfn> parameter supplies information about the desired properties of the credential to be created.
The sequence is ordered from most preferred to least preferred. The platform makes a best effort to create the most
preferred credential that it can.</p>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="attestationchallenge">attestationChallenge</dfn> parameter contains a challenge intended to be used for generating the attestation
statement of the newly created credential.</p>
    <li data-md="">
     <p>The optional <dfn data-dfn-for="makeCredential()" data-dfn-type="dfn" data-noexport="" id="makecredential-options">options<a class="self-link" href="#makecredential-options"></a></dfn> parameter specifies additional options, as described in <a href="#credential-options">§4.5 Additional options for Credential Generation (dictionary CredentialOptions)</a>.</p>
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <ol>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#credentialoptions-timeoutseconds" id="ref-for-credentialoptions-timeoutseconds-1">timeoutSeconds</a> was specified, check if its value lies within a reasonable range as defined
by the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted
value. If <a data-link-type="dfn" href="#credentialoptions-timeoutseconds" id="ref-for-credentialoptions-timeoutseconds-2">timeoutSeconds</a> was not specified then set <var>adjustedTimeout</var> to a platform-specific
default.</p>
    <li data-md="">
     <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-1">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds.
Then asynchronously continue executing the following steps.</p>
    <li data-md="">
     <p>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="#origin" id="ref-for-origin-1">origin</a> of the caller. Derive the RP ID from <var>callerOrigin</var> by computing the
"public suffix + 1" or "PS+1" (which is also referred to as the "Effective Top-Level Domain plus One" or "<a data-link-type="dfn" href="#etld1" id="ref-for-etld1-2">eTLD+1</a>")
part of <var>callerOrigin</var> <a data-link-type="biblio" href="#biblio-psl">[PSL]</a>. Set <var>rpIdHash</var> to the SHA-256 hash of the UTF-8 encoding of the lowercase form of this RP
ID.</p>
    <li data-md="">
     <p>Initialize <var>issuedRequests</var> to an empty list.</p>
    <li data-md="">
     <p>Process each element of <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-1">cryptoParameters</a> using the following steps, to produce a new sequence <code>normalizedParameters</code>:</p>
     <ul>
      <li data-md="">
       <p>Let <var>current</var> be the currently selected element of <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-2">cryptoParameters</a>.</p>
      <li data-md="">
       <p>If <code>current.type</code> does not contain a <code class="idl"><a data-link-type="idl" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-5">CredentialType</a></code> supported by this implementation, then stop processing <var>current</var> and move on to the next element in <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-3">cryptoParameters</a>.</p>
      <li data-md="">
       <p>Let <code>normalizedAlgorithm</code> be the result of normalizing an algorithm using the procedure defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>,
with <var>alg</var> set to <code>current.algorithm</code> and <var>op</var> set to 'generateKey'. If an error occurs during this procedure, then
stop processing <var>current</var> and move on to the next element in <a data-link-type="dfn" href="#cryptoparameters" id="ref-for-cryptoparameters-4">cryptoParameters</a>.</p>
      <li data-md="">
       <p>Add a new object of type <code class="idl"><a data-link-type="idl" href="#dictdef-scopedcredentialparameters" id="ref-for-dictdef-scopedcredentialparameters-3">ScopedCredentialParameters</a></code> to <code>normalizedParameters</code>, with <var>type</var> set to <code>current.type</code> and <var>algorithm</var> set to <code>normalizedAlgorithm</code>.</p>
     </ul>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#credentialoptions-excludelist" id="ref-for-credentialoptions-excludelist-1">excludeList</a> is undefined, set it to the empty list.</p>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#credentialoptions-extensions" id="ref-for-credentialoptions-extensions-1">extensions</a> was specified, process any extensions supported by this client platform, to
produce the extension data that needs to be sent to the authenticator. Call this data <var>clientExtensions</var>.</p>
    <li data-md="">
     <p>For each authenticator currently available on this platform: asynchronously invoke the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-3">authenticatorMakeCredential</a> operation on that authenticator with <var>callerOrigin</var>, <var>rpIdHash</var>, <a data-link-type="dfn" href="#accountinformation" id="ref-for-accountinformation-1">accountInformation</a>, <code>normalizedParameters</code>, <a data-link-type="dfn" href="#credentialoptions-excludelist" id="ref-for-credentialoptions-excludelist-2">excludeList</a>, <a data-link-type="dfn" href="#attestationchallenge" id="ref-for-attestationchallenge-1">attestationChallenge</a> and <var>clientExtensions</var> as
parameters. Add a corresponding entry to <var>issuedRequests</var>.</p>
    <li data-md="">
     <p>While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses
from the authenticators:</p>
     <ul>
      <li data-md="">
       <p>If the <var>adjustedTimeout</var> timer expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-1">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s
entry from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-2">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.</p>
      <li data-md="">
       <p>If any authenticator indicates success:</p>
       <ul>
        <li data-md="">
         <p>Remove this authenticator’s entry from <var>issuedRequests</var>.</p>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#scopedcredentialinfo" id="ref-for-scopedcredentialinfo-4">ScopedCredentialInfo</a></code> object named <var>value</var> and populate its fields with the values returned from the
authenticator.</p>
        <li data-md="">
         <p>For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-3">authenticatorCancel</a> operation on that authenticator and
remove its entry from the list.</p>
        <li data-md="">
         <p>Resolve <var>promise</var> with <var>value</var> and terminate this algorithm.</p>
       </ul>
     </ul>
    <li data-md="">
     <p>Resolve <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-1">DOMException</a> whose name is "NotFoundError", and terminate this algorithm.</p>
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and
authorizing an authenticator.</p>
   <h4 class="heading settled" data-level="4.1.2" id="getAssertion"><span class="secno">4.1.2. </span><span class="content">Use an existing credential (<dfn class="dfn-paneled idl-code" data-dfn-for="WebAuthentication" data-dfn-type="method" data-export="" data-lt="getAssertion(assertionChallenge, options)|getAssertion(assertionChallenge)" id="dom-webauthentication-getassertion">getAssertion()</dfn> method)</span><a class="self-link" href="#getAssertion"></a></h4>
   <p>This method is used to discover and use an existing scoped credential, with the user’s consent. The script optionally specifies
some criteria to indicate what credentials are acceptable to it. The user agent and/or platform locates credentials matching the
specified criteria, and guides the user to pick one that the script should be allowed to use. The user may choose not to provide
a credential even if one is present, for example to maintain privacy.</p>
   <p>This method takes the following parameters:</p>
   <ul>
    <li data-md="">
     <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="assertionchallenge">assertionChallenge</dfn> parameter contains a challenge that the selected authenticator is expected to sign to
produce the assertion.</p>
    <li data-md="">
     <p>The optional <dfn data-dfn-for="getAssertion()" data-dfn-type="dfn" data-noexport="" id="getassertion-options">options<a class="self-link" href="#getassertion-options"></a></dfn> parameter specifies additional options, as described in <a href="#assertion-options">§4.7 Additional options for Assertion Generation (dictionary AssertionOptions)</a>.</p>
   </ul>
   <p>When this method is invoked, the user agent MUST execute the following algorithm:</p>
   <ol>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#assertionoptions-timeoutseconds" id="ref-for-assertionoptions-timeoutseconds-1">timeoutSeconds</a> was specified, check if its value lies within a reasonable range as defined
by the platform and if not, correct it to the closest value lying within that range. Set <var>adjustedTimeout</var> to this adjusted
value. If <a data-link-type="dfn" href="#assertionoptions-timeoutseconds" id="ref-for-assertionoptions-timeoutseconds-2">timeoutSeconds</a> was not specified then set <var>adjustedTimeout</var> to a platform-specific
default.</p>
    <li data-md="">
     <p>Let <var>promise</var> be a new <a data-link-type="dfn" href="#promises" id="ref-for-promises-2">Promise</a>. Return <var>promise</var> and start a timer for <var>adjustedTimeout</var> seconds.
Then asynchronously continue executing the following steps.</p>
    <li data-md="">
     <p>Set <var>callerOrigin</var> to the <a data-link-type="dfn" href="#origin" id="ref-for-origin-2">origin</a> of the caller. Derive the RP ID from <var>callerOrigin</var> by computing the
"public suffix + 1" or "PS+1" (which is also referred to as the "Effective Top-Level Domain plus One" or "<a data-link-type="dfn" href="#etld1" id="ref-for-etld1-3">eTLD+1</a>")
part of <var>callerOrigin</var> <a data-link-type="biblio" href="#biblio-psl">[PSL]</a>. Set <var>rpIdHash</var> to the SHA-256 hash of the UTF-8 encoding of the lowercase form of this RP
ID.</p>
    <li data-md="">
     <p>Initialize <var>issuedRequests</var> to an empty list.</p>
    <li data-md="">
     <p>If <a data-link-type="dfn" href="#assertionoptions-extensions" id="ref-for-assertionoptions-extensions-1">extensions</a> was specified, process any extensions supported by this client platform, to
produce the extension data that needs to be sent to the authenticator. Call this data <var>clientExtensions</var>.</p>
    <li data-md="">
     <p>For each authenticator currently available on this platform, perform the following steps:</p>
     <ul>
      <li data-md="">
       <p>If <a data-link-type="dfn" href="#assertionoptions-allowlist" id="ref-for-assertionoptions-allowlist-1">allowList</a> is undefined or empty, let <var>credentialList</var> be a list containing a single wildcard entry. Otherwise,
execute a platform-specific procedure to determine which of these credentials might be present on this authenticator,
and set <var>credentialList</var> to this filtered list.</p>
      <li data-md="">
       <p>If <var>credentialList</var> is empty, ignore this authenticator and do not perform any of the following per-authenticator steps.</p>
      <li data-md="">
       <p>Asynchronously invoke the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-3">authenticatorGetAssertion</a> operation on this authenticator with <var>callerOrigin</var>, <var>rpIdHash</var>, <a data-link-type="dfn" href="#assertionchallenge" id="ref-for-assertionchallenge-1">assertionChallenge</a>, <var>credentialList</var>, and <var>clientExtensions</var> as parameters.</p>
      <li data-md="">
       <p>Add an entry to <var>issuedRequests</var>, corresponding to this request.</p>
     </ul>
    <li data-md="">
     <p>While <var>issuedRequests</var> is not empty, perform the following actions depending upon the <var>adjustedTimeout</var> timer and responses
from the authenticators:</p>
     <ul>
      <li data-md="">
       <p>If the timer for <var>adjustedTimeout</var> expires, then for each entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-4">authenticatorCancel</a> operation on that authenticator and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns a status indicating that the user cancelled the operation, delete that authenticator’s entry
from <var>issuedRequests</var>. For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-5">authenticatorCancel</a> operation on
that authenticator, and remove its entry from the list.</p>
      <li data-md="">
       <p>If any authenticator returns an error status, delete the corresponding entry from <var>issuedRequests</var>.</p>
      <li data-md="">
       <p>If any authenticator returns success:</p>
       <ul>
        <li data-md="">
         <p>Remove this authenticator’s entry from <var>issuedRequests</var>.</p>
        <li data-md="">
         <p>Create a new <code class="idl"><a data-link-type="idl" href="#webauthnassertion" id="ref-for-webauthnassertion-4">WebAuthnAssertion</a></code> object named <var>value</var> and populate its fields with the values returned from the
authenticator.</p>
        <li data-md="">
         <p>For each remaining entry in <var>issuedRequests</var> invoke the <a data-link-type="dfn" href="#authenticatorcancel" id="ref-for-authenticatorcancel-6">authenticatorCancel</a> operation on that authenticator and
remove its entry from the list.</p>
        <li data-md="">
         <p>Resolve <var>promise</var> with <var>value</var> and terminate this algorithm.</p>
       </ul>
     </ul>
    <li data-md="">
     <p>Resolve <var>promise</var> with a <a data-link-type="dfn" href="#domexception" id="ref-for-domexception-2">DOMException</a> whose name is "NotFoundError", and terminate this algorithm.</p>
   </ol>
   <p>During the above process, the user agent SHOULD show some UI to the user to guide them in the process of selecting and
authorizing an authenticator with which to complete the operation.</p>
   <h3 class="heading settled" data-level="4.2" id="iface-credentialInfo"><span class="secno">4.2. </span><span class="content"><dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="scopedcredentialinfo">ScopedCredentialInfo</dfn> Interface</span><a class="self-link" href="#iface-credentialInfo"></a></h3>
   <div>
     This interface represents a newly-created scoped credential. It contains information about the credential that can be used
    to locate it later for use, and also contains metadata that can be used by the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-13">Relying Party</a> to assess the strength of the
    credential during registration. 
    <p>The <dfn data-dfn-for="ScopedCredentialInfo" data-dfn-type="dfn" data-noexport="" id="scopedcredentialinfo-credential">credential<a class="self-link" href="#scopedcredentialinfo-credential"></a></dfn> attribute contains a unique identifier for the credential represented by this object.</p>
    <p>The <dfn data-dfn-for="ScopedCredentialInfo" data-dfn-type="dfn" data-noexport="" id="scopedcredentialinfo-publickey">publicKey<a class="self-link" href="#scopedcredentialinfo-publickey"></a></dfn> attribute contains the public key associated with the credential, represented as a
    CryptoKey object as defined in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#cryptokey-interface">Web Cryptography API §cryptokey-interface</a>.</p>
    <p>The <dfn data-dfn-for="ScopedCredentialInfo" data-dfn-type="dfn" data-noexport="" id="scopedcredentialinfo-attestation">attestation<a class="self-link" href="#scopedcredentialinfo-attestation"></a></dfn> attribute contains a key attestation statement returned by the authenticator. This provides
    information about the credential and the authenticator it is held in, such as the level of security assurance provided by
    the authenticator.</p>
   </div>
   <h3 class="heading settled" data-level="4.3" id="iface-account"><span class="secno">4.3. </span><span class="content">User Account Information (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-account">Account</dfn>)</span><a class="self-link" href="#iface-account"></a></h3>
   <div>
     This dictionary is used by the caller to specify information about the user account and <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-14">Relying Party</a> with which a credential
    is to be associated. It is intended to help the authenticator in providing a friendly credential selection interface for the
    user. 
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-rpdisplayname">rpDisplayName<a class="self-link" href="#account-rpdisplayname"></a></dfn> member contains the friendly name of the Relying Party, such as "Acme Corporation", "Widgets Inc" or
    "Awesome Site".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-displayname">displayName<a class="self-link" href="#account-displayname"></a></dfn> member contains the friendly name associated with the user account by the Relying Party, such as "John P.
    Smith".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-name">name<a class="self-link" href="#account-name"></a></dfn> member contains a detailed name for the account, such as "john.p.smith@example.com".</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-id">id<a class="self-link" href="#account-id"></a></dfn> member contains an identifier for the account, stored for the use of the Relying Party. This is not meant to be
    displayed to the user.</p>
    <p>The <dfn data-dfn-for="Account" data-dfn-type="dfn" data-noexport="" id="account-imageurl">imageURL<a class="self-link" href="#account-imageurl"></a></dfn> member contains a URL that resolves to the user’s account image. This may be a URL that can be used
    to retrieve an image containing the user’s current avatar, or a data URI that contains the image data.</p>
   </div>
   <h3 class="heading settled" data-level="4.4" id="credential-params"><span class="secno">4.4. </span><span class="content">Parameters for Credential Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-scopedcredentialparameters">ScopedCredentialParameters</dfn>)</span><a class="self-link" href="#credential-params"></a></h3>
   <div>
     This dictionary is used to supply additional parameters when creating a new credential. 
    <p>The <dfn data-dfn-for="ScopedCredentialParameters" data-dfn-type="dfn" data-noexport="" id="scopedcredentialparameters-type">type<a class="self-link" href="#scopedcredentialparameters-type"></a></dfn> member specifies the type of credential to be created.</p>
    <p>The <dfn data-dfn-for="ScopedCredentialParameters" data-dfn-type="dfn" data-noexport="" id="scopedcredentialparameters-algorithm">algorithm<a class="self-link" href="#scopedcredentialparameters-algorithm"></a></dfn> member specifies the cryptographic algorithm with which the newly generated credential will be
    used.</p>
   </div>
   <h3 class="heading settled" data-level="4.5" id="credential-options"><span class="secno">4.5. </span><span class="content">Additional options for Credential Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-credentialoptions">CredentialOptions</dfn>)</span><a class="self-link" href="#credential-options"></a></h3>
   <div>
     This dictionary is used to supply additional options when creating a new credential. All these parameters are optional. 
    <ul>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-for="CredentialOptions" data-dfn-type="dfn" data-noexport="" id="credentialoptions-timeoutseconds">timeoutSeconds</dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the call to
complete. This is treated as a hint, and may be overridden by the platform.</p>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-for="CredentialOptions" data-dfn-type="dfn" data-noexport="" id="credentialoptions-excludelist">excludeList</dfn> parameter is intended for use by <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-15">Relying Parties</a> that wish to limit the creation of multiple
credentials for the same account on a single authenticator. The platform is requested to return an error if the new
credential would be created on an authenticator that also contains one of the credentials enumerated in this parameter.</p>
     <li data-md="">
      <p>The <dfn class="dfn-paneled" data-dfn-for="CredentialOptions" data-dfn-type="dfn" data-noexport="" id="credentialoptions-extensions">extensions</dfn> parameter contains additional parameters requesting additional processing by the client and
authenticator. For example, the caller may request that only authenticators with certain capabilities be used to create
the credential, or that additional information be returned in the attestation statement. Alternatively, the caller may
specify an additional message that they would like the authenticator to display to the user. Extensions are defined in <a href="#extensions">§7 WebAuthn Extensions</a>.</p>
    </ul>
   </div>
   <h3 class="heading settled" data-level="4.6" id="iface-assertion"><span class="secno">4.6. </span><span class="content">WebAuthn Assertion (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="webauthnassertion">WebAuthnAssertion</dfn>)</span><a class="self-link" href="#iface-assertion"></a></h3>
   <p>Scoped credentials produce a cryptographic signature that provides proof of possession of a private key as well as evidence of
user consent to a specific transaction. The structure of these signatures is defined as follows.</p>
   <div>
     The <dfn data-dfn-for="WebAuthnAssertion" data-dfn-type="dfn" data-noexport="" id="webauthnassertion-credential">credential<a class="self-link" href="#webauthnassertion-credential"></a></dfn> member represents the credential that was used to generate this assertion. 
    <p>The <dfn data-dfn-for="WebAuthnAssertion" data-dfn-type="dfn" data-noexport="" id="webauthnassertion-clientdata">clientData<a class="self-link" href="#webauthnassertion-clientdata"></a></dfn> member contains the parameters sent to the authenticator by the client, in serialized form. See <a href="#sec-client-data">§5.2.1 Client data used in WebAuthn signatures (dictionary ClientData)</a> for the format of this parameter and how it is generated.</p>
    <p>The <b><em>authenticatorData</em></b> member contains the serialized data returned by the authenticator. See <a href="#sec-authenticator-data">§5.2.2 Authenticator data</a>.</p>
    <p>The <dfn data-dfn-for="WebAuthnAssertion" data-dfn-type="dfn" data-noexport="" id="webauthnassertion-signature">signature<a class="self-link" href="#webauthnassertion-signature"></a></dfn> member contains the raw signature returned from the authenticator. See <a href="#authenticator-signature">§5.2.3 Generating a signature</a>.</p>
   </div>
   <h3 class="heading settled" data-level="4.7" id="assertion-options"><span class="secno">4.7. </span><span class="content">Additional options for Assertion Generation (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-assertionoptions">AssertionOptions</dfn>)</span><a class="self-link" href="#assertion-options"></a></h3>
   <div>
     This dictionary is used to supply additional options when generating an assertion. All these parameters are optional. 
    <ul>
     <li data-md="">
      <p>The optional <dfn class="dfn-paneled" data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-timeoutseconds">timeoutSeconds</dfn> parameter specifies a time, in seconds, that the caller is willing to wait for the
call to complete. This is treated as a hint, and may be overridden by the platform.</p>
     <li data-md="">
      <p>The optional <dfn class="dfn-paneled" data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-allowlist">allowList</dfn> member contains a list of credentials acceptable to the caller, in order of the caller’s
preference.</p>
     <li data-md="">
      <p>The optional <dfn class="dfn-paneled" data-dfn-for="AssertionOptions" data-dfn-type="dfn" data-noexport="" id="assertionoptions-extensions">extensions</dfn> parameter contains additional parameters requesting additional processing by the client
and authenticator. For example, if transaction confirmation is sought from the user, then the prompt string would be
included in an extension. Extensions are defined in a companion specification.</p>
    </ul>
   </div>
   <h3 class="heading settled" data-level="4.8" id="iface-assertion-extensions"><span class="secno">4.8. </span><span class="content">WebAuthn Assertion Extensions (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-webauthnextensions">WebAuthnExtensions</dfn>)</span><a class="self-link" href="#iface-assertion-extensions"></a></h3>
   <p>This is a dictionary containing zero or more extensions as defined in <a href="#extensions">§7 WebAuthn Extensions</a>. An extension is an additional parameter
that can be passed to the <a data-link-type="functionish" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-4">getAssertion()</a> method and triggers some additional processing by the client platform and/or the
authenticator.</p>
   <p>If the caller wants to pass extensions to the platform, it SHOULD do so by adding one entry per extension to this dictionary
with the extension identifier as the key, and the extension’s value as the value (see <a href="#signature-format">§5.2 Signature Format</a> for details).</p>
   <h3 class="heading settled" data-level="4.9" id="iface-attestation"><span class="secno">4.9. </span><span class="content">Credential Attestation Statement (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="webauthnattestation">WebAuthnAttestation</dfn>)</span><a class="self-link" href="#iface-attestation"></a></h3>
   <p>Authenticators also provide some form of attestation. The basic requirement is that the authenticator can produce, for each
credential public key, attestation information that can be verified by a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-16">Relying Party</a>. Typically, this information contains a
signature by an attesting key over the attested public key and a challenge, as well as a certificate or similar information
providing provenance information for the attesting key, enabling a trust decision to be made.</p>
   <div>
     The <dfn data-dfn-for="WebAuthnAttestation" data-dfn-type="dfn" data-noexport="" id="webauthnattestation-type">type<a class="self-link" href="#webauthnattestation-type"></a></dfn> member specifies the type of attestation statement contained in this structure. This specification
    defines a number of attestation formats, in <a href="#defined-attestation-formats">§6 Defined Attestation Formats</a>. Other attestation formats may be defined in
    later versions of this specification. 
    <p>The <dfn data-dfn-for="WebAuthnAttestation" data-dfn-type="dfn" data-noexport="" id="webauthnattestation-clientdata">clientData<a class="self-link" href="#webauthnattestation-clientdata"></a></dfn> member contains the <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-1">clientDataJSON</a> (see <a href="#signature-format">§5.2 Signature Format</a>). The exact JSON encoding
    must be preserved as the hash (clientDataHash) has been computed over it.</p>
    <p>The <dfn data-dfn-for="WebAuthnAttestation" data-dfn-type="dfn" data-noexport="" id="webauthnattestation-statement">statement<a class="self-link" href="#webauthnattestation-statement"></a></dfn> element contains the actual attestation statement. The structure of this object depends on the
    attestation format. For more details, see <a href="#attestation">§5.3 Credential Attestation Statements</a>.</p>
   </div>
   <p>This attestation statement is delivered to the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-17">Relying Party</a> by the Relying Party’s script running on the client, using methods outside
the scope of this specification. It contains all the information that the Relying Party’s server requires to validate the statement, as
well as to decode and validate the bindings of both the client and authenticator data.</p>
   <h3 class="heading settled" data-level="4.10" id="supporting-data-structures"><span class="secno">4.10. </span><span class="content">Supporting Data Structures</span><a class="self-link" href="#supporting-data-structures"></a></h3>
   <p>The scoped credential type uses certain data structures that are specified in supporting specifications. These are as follows.</p>
   <h4 class="heading settled" data-level="4.10.1" id="credentialType"><span class="secno">4.10.1. </span><span class="content">Credential Type enumeration (enum <dfn class="dfn-paneled idl-code" data-dfn-type="enum" data-export="" id="enumdef-credentialtype">CredentialType</dfn>)</span><a class="self-link" href="#credentialType"></a></h4>
   <div>
     This enumeration defines the valid credential types. It is an extension point; values may be added to it in the future, as
    more credential types are defined. The values of this enumeration are used for versioning the WebAuthn assertion and
    attestation statement according to the type of the authenticator. 
    <p>Currently one credential type is defined, namely "<dfn data-dfn-for="CredentialType" data-dfn-type="dfn" data-noexport="" id="credentialtype-scopedcred">ScopedCred<a class="self-link" href="#credentialtype-scopedcred"></a></dfn>".</p>
   </div>
   <h4 class="heading settled" data-level="4.10.2" id="credential-identifier"><span class="secno">4.10.2. </span><span class="content">Unique Identifier for Credential (interface <dfn class="dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="credential">Credential</dfn>)</span><a class="self-link" href="#credential-identifier"></a></h4>
   <p>This interface contains the attributes that are returned to the caller when a new credential is created, and can be used later
by the caller to select a credential for use.</p>
   <div>
     The <dfn data-dfn-for="Credential" data-dfn-type="dfn" data-noexport="" id="credential-type">type<a class="self-link" href="#credential-type"></a></dfn> attribute contains a value of type <code class="idl"><a data-link-type="idl" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-6">CredentialType</a></code>, indicating the specification and version that
    this credential conforms to. 
    <p>The <dfn data-dfn-for="Credential" data-dfn-type="dfn" data-noexport="" id="credential-id">id<a class="self-link" href="#credential-id"></a></dfn> attribute contains an identifier for the credential, chosen by the platform with help from the
    authenticator. This identifier is used to look up credentials for use, and is therefore expected to be globally unique with
    high probability across all credentials of the same type, across all authenticators. This API does not constrain the format
    or length of this identifier, except that it must be sufficient for the platform to uniquely select a key. For example, an
    authenticator without on-board storage may create identifiers that consist of the key material wrapped with a key that is
    burned into the authenticator.</p>
   </div>
   <h4 class="heading settled" data-level="4.10.3" id="credential-dictionary"><span class="secno">4.10.3. </span><span class="content">Credential Descriptor (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-credentialdescription">CredentialDescription</dfn>)</span><a class="self-link" href="#credential-dictionary"></a></h4>
   <p>This dictionary contains the attributes that are specified by a caller when referring to a credential as an input parameter to
the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-3">makeCredential()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-5">getAssertion()</a></code> method. It mirrors the fields of the <code class="idl"><a data-link-type="idl" href="#credential" id="ref-for-credential-4">Credential</a></code> object returned by these methods.</p>
   <div>
     The <dfn data-dfn-for="CredentialDescription" data-dfn-type="dfn" data-noexport="" id="credentialdescription-type">type<a class="self-link" href="#credentialdescription-type"></a></dfn> attribute contains the type of the credential the caller is referring to. 
    <p>The <dfn data-dfn-for="CredentialDescription" data-dfn-type="dfn" data-noexport="" id="credentialdescription-id">id<a class="self-link" href="#credentialdescription-id"></a></dfn> attribute contains the identifier of the credential that the caller is referring to.</p>
   </div>
   <h4 class="heading settled" data-level="4.10.4" id="alg-identifier"><span class="secno">4.10.4. </span><span class="content">Cryptographic Algorithm Identifier (type <code class="idl"><a data-link-type="idl" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-2">AlgorithmIdentifier</a></code>)</span><a class="self-link" href="#alg-identifier"></a></h4>
   <p>A string or dictionary identifying a cryptographic algorithm and optionally a set of parameters for that algorithm. This type is
defined in <a data-link-type="biblio" href="#biblio-webcryptoapi">[WebCryptoAPI]</a>.</p>
   <h2 class="heading settled" data-level="5" id="authenticator-model"><span class="secno">5. </span><span class="content">WebAuthn Authenticator model</span><a class="self-link" href="#authenticator-model"></a></h2>
   <p>The API defined in this specification implies a specific abstract functional model for an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-14">authenticator</a>. This section
describes the authenticator model. Client platforms may implement and expose this abstract model in any way desired. However,
the behavior of the client’s Web Authentication API implementation, when operating on the authenticators
supported by that platform, MUST be indistinguishable from the behavior specified in <a href="#api">§4 Web Authentication API</a>.</p>
   <p>In this abstract model, each authenticator stores some number of scoped credentials. Each scoped credential has an identifier
which is unique (or extremely unlikely to be duplicated) among all scoped credentials. Each credential is also associated with a <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-18">Relying Party</a>, whose identity is represented by a <a data-link-type="dfn" href="#relying-party-identifier" id="ref-for-relying-party-identifier-1">Relying Party Identifier</a> (<a data-link-type="dfn" href="#rp-id" id="ref-for-rp-id-3">RP ID</a>).</p>
   <h3 class="heading settled" data-level="5.1" id="authenticator-ops"><span class="secno">5.1. </span><span class="content">Authenticator operations</span><a class="self-link" href="#authenticator-ops"></a></h3>
   <p>A client must connect to an authenticator in order to invoke any of the operations of that authenticator. This connection
defines an authenticator session. An authenticator must maintain isolation between sessions. It may do this by only allowing one
session to exist at any particular time, or by providing more complicated session management.</p>
   <p>The following operations can be invoked by the client in an authenticator session.</p>
   <h4 class="heading settled" data-level="5.1.1" id="op-make-cred"><span class="secno">5.1.1. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatormakecredential">authenticatorMakeCredential</dfn> operation</span><a class="self-link" href="#op-make-cred"></a></h4>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following
input parameters:</p>
   <ul>
    <li data-md="">
     <p>The web origin of the script on whose behalf the operation is being initiated, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>The SHA-256 hash of the RP ID corresponding to the above web origin, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>The <code class="idl"><a data-link-type="idl" href="#dictdef-account" id="ref-for-dictdef-account-3">Account</a></code> information provided by the Relying Party.</p>
    <li data-md="">
     <p>The <code class="idl"><a data-link-type="idl" href="#enumdef-credentialtype" id="ref-for-enumdef-credentialtype-7">CredentialType</a></code> requested by the Relying Party.</p>
    <li data-md="">
     <p>The cryptographic parameters requested by the Relying Party, with the cryptographic algorithms normalized as per the procedure in <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#algorithm-normalization-normalize-an-algorithm">Web Cryptography API §algorithm-normalization-normalize-an-algorithm</a>.</p>
    <li data-md="">
     <p>A list of <code class="idl"><a data-link-type="idl" href="#credential" id="ref-for-credential-5">Credential</a></code> objects provided by the Relying Party with the intention that, if any of these are known to the authenticator,
it should not create a new credential.</p>
    <li data-md="">
     <p>A challenge provided by the Relying Party to assure freshness of the attestation statement of the new credential.</p>
    <li data-md="">
     <p>Extension data created by the client based on the extensions requested by the Relying Party.</p>
   </ul>
   <p>When this operation is invoked, the authenticator obtains user consent for creating a new credential. The prompt for obtaining
this consent is shown by the authenticator if it has its own output capability, or by the user agent otherwise. Once user 
consent is obtained, the authenticator generates the appropriate cryptographic keys and creates a new credential. It also 
generates an identifier for the credential, such that this identifier is globally unique with high probability across all 
credentials with the same type across all authenticators. It then associates the credential with the specified RP ID hash such
that it will be able to retrieve the RP ID hash later, given the credential ID. Finally, it generates an attestation statement
that describes its own attributes as well as some attributes of the credential. For more details on attestation, see <a href="#attestation">§5.3 Credential Attestation Statements</a>.</p>
   <p>On successful completion of this operation, the authenticator returns the following to the client:</p>
   <ul>
    <li data-md="">
     <p>The type and unique identifier of the new credential.</p>
    <li data-md="">
     <p>The public key associated with the new credential.</p>
    <li data-md="">
     <p>The attestation statement, including information about the attestation format used.</p>
   </ul>
   <p>If the user refuses consent, the authenticator returns an appropriate error status to the client.</p>
   <h4 class="heading settled" data-level="5.1.2" id="op-get-assertion"><span class="secno">5.1.2. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatorgetassertion">authenticatorGetAssertion</dfn> operation</span><a class="self-link" href="#op-get-assertion"></a></h4>
   <p>This operation must be invoked in an authenticator session which has no other operations in progress. It takes the following
input parameters:</p>
   <ul>
    <li data-md="">
     <p>The web origin of the script on whose behalf the operation is being initiated, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>The RP ID hash corresponding to the above web origin, as determined by the user agent and the client.</p>
    <li data-md="">
     <p>A challenge provided by the Relying Party to assure freshness of the assertion produced.</p>
    <li data-md="">
     <p>A list of credentials acceptable to the Relying Party (possibly filtered by the client).</p>
    <li data-md="">
     <p>Extension data created by the client based on the extensions requested by the Relying Party.</p>
   </ul>
   <p>When this method is invoked, the authenticator allows the user to select a credential from among the credentials associated with
that Relying Party (as determined by an exact match of the RP ID hash) and matching the specified criteria, then obtains user consent
for using that credential. The prompt for obtaining this consent may be shown by the authenticator if it has its own output
capability, or by the user agent otherwise. Once a credential is selected and user consent is obtained, the authenticator
computes a cryptographic signature using the credential’s private key and constructs an assertion signature as specified in <a href="#signature-format">§5.2 Signature Format</a>.</p>
   <p>On successful completion, the authenticator returns to the user agent:</p>
   <ul>
    <li data-md="">
     <p>The identifier of the credential used to generate the signature.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-1">authenticatorData</a> used to generate the signature.</p>
    <li data-md="">
     <p>The signature itself.</p>
   </ul>
   <p>If the authenticator cannot find any credential corresponding to the specified Relying Party that matches the specified criteria, it
terminates the operation and returns an error.</p>
   <p>If the user refuses consent, the authenticator returns an appropriate error status to the client.</p>
   <h4 class="heading settled" data-level="5.1.3" id="op-cancel"><span class="secno">5.1.3. </span><span class="content">The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatorcancel">authenticatorCancel</dfn> operation</span><a class="self-link" href="#op-cancel"></a></h4>
   <p>This operation takes no input parameters and returns no result.</p>
   <p>When this operation is invoked by the client in an authenticator session, it has the effect of terminating any <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-4">authenticatorMakeCredential</a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-4">authenticatorGetAssertion</a> operation currently in progress in that authenticator
session. The authenticator stops prompting for, or accepting, any user input related to authorizing the canceled operation. The
client ignores any further responses from the authenticator for the canceled operation.</p>
   <p>This operation is ignored if it is invoked in an authenticator session which does not have an <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-5">authenticatorMakeCredential</a> or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-5">authenticatorGetAssertion</a> operation currently in progress.</p>
   <h3 class="heading settled" data-level="5.2" id="signature-format"><span class="secno">5.2. </span><span class="content">Signature Format</span><a class="self-link" href="#signature-format"></a></h3>
   <p>WebAuthn signatures are bound to various contextual data. These data are observed, and added at different levels of the stack as
a signature request passes from the server to the authenticator. In verifying a signature, the server checks these bindings
against expected values.</p>
   <p>The components of a system using WebAuthn can be divided into three layers:</p>
   <ol>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-19">Relying Party</a> (RP), which uses the WebAuthn services. The RP consists of a server component and a web-application running
in a browser.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#webauthn-client" id="ref-for-webauthn-client-3">WebAuthn Client</a> platform, which consists of the User Agent and the OS and device on which it executes.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-15">Authenticator</a> itself, which provides key management and cryptographic signatures. This may be embedded in the
WebAuthn client, or housed in a separate device entirely. In the latter case, the interface between the WebAuthn client and
the authenticator is a separately-defined protocol.</p>
   </ol>
   <p>This specification defines the common signature format shared by all the above layers. This includes how the different
contextual bindings are encoded, signed over, and delivered to the RP.</p>
   <p>The goals of this design can be summarized as follows.</p>
   <ul>
    <li data-md="">
     <p>The scheme for generating signatures should accommodate cases where the link between the client platform and authenticator
is very limited, in bandwidth and/or latency. Examples include Bluetooth Low Energy and Near-Field Communication.</p>
    <li data-md="">
     <p>The data processed by the authenticator should be small and easy to interpret in low-level code. In particular, authenticators
should not have to parse high-level encodings such as JSON.</p>
    <li data-md="">
     <p>Both the client platform and the authenticator should have the flexibility to add contextual bindings as needed.</p>
    <li data-md="">
     <p>The design aims to reuse as much as possible of existing encoding formats in order to aid adoption and implementation.</p>
   </ul>
   <p>The contextual bindings are divided in two: Those added by the RP or the client platform, referred to as client data; and those
added by the authenticator, referred to as the authenticator data. The client data must be signed over, but an authenticator is
otherwise not interested in its contents. To save bandwidth and processing requirements on the authenticator, the client
platform hashes the client data and sends only the result to the authenticator. The authenticator signs over the combination of
this hash, and its own authenticator data.</p>
   <h4 class="heading settled" data-level="5.2.1" id="sec-client-data"><span class="secno">5.2.1. </span><span class="content">Client data used in WebAuthn signatures (dictionary <dfn class="dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-clientdata">ClientData</dfn>)</span><a class="self-link" href="#sec-client-data"></a></h4>
   <p>The client data represents the contextual bindings of both the Relying Party and the client platform. It is a key-value mapping with
string-valued keys. Values may be any type that has a valid encoding in JSON. Its structure is defined by the following Web IDL.</p>
<pre class="idl highlight def"><span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-1">ClientData</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span>           <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString           " id="dom-clientdata-challenge">challenge<a class="self-link" href="#dom-clientdata-challenge"></a></dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString           " id="dom-clientdata-facet">facet<a class="self-link" href="#dom-clientdata-facet"></a></dfn>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString           " id="dom-clientdata-rpid">rpId<a class="self-link" href="#dom-clientdata-rpid"></a></dfn>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier" id="ref-for-dictdef-algorithmidentifier-3">AlgorithmIdentifier</a> <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="AlgorithmIdentifier " id="dom-clientdata-hashalg">hashAlg<a class="self-link" href="#dom-clientdata-hashalg"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-jsonwebkey" id="ref-for-dictdef-jsonwebkey-1">JsonWebKey</a>                   <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="JsonWebKey                   " id="dom-clientdata-tokenbinding">tokenBinding<a class="self-link" href="#dom-clientdata-tokenbinding"></a></dfn>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions" id="ref-for-dictdef-webauthnextensions-4">WebAuthnExtensions</a>           <dfn class="nv idl-code" data-dfn-for="ClientData" data-dfn-type="dict-member" data-export="" data-type="WebAuthnExtensions           " id="dom-clientdata-extensions">extensions<a class="self-link" href="#dom-clientdata-extensions"></a></dfn>;
};
</pre>
   <div>
     The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-challenge">challenge<a class="self-link" href="#clientdata-challenge"></a></dfn> member contains the base64url encoding of the challenge provided by the RP. 
    <p>The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-facet">facet<a class="self-link" href="#clientdata-facet"></a></dfn> member contains the fully qualified web origin of the requester, as provided to the authenticator by
    the client, in the syntax defined by <a data-link-type="biblio" href="#biblio-rfc6454">[RFC6454]</a>.</p>
    <p>The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-rpid">rpId<a class="self-link" href="#clientdata-rpid"></a></dfn> member contains the RP ID of the requester, as computed by the client.</p>
    <p>The <dfn class="dfn-paneled" data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-hashalg">hashAlg</dfn> member specifies the hash algorithm used to compute clientDataHash (see <a href="#authenticator-signature">§5.2.3 Generating a signature</a>). Use "S256" for SHA-256, "S384" for SHA384, "S512" for SHA512, and "SM3" for SM3 (see <a href="#iana-considerations">§9 IANA Considerations</a>).</p>
    <p>The <dfn data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-tokenbinding">tokenBinding<a class="self-link" href="#clientdata-tokenbinding"></a></dfn> member contains a JsonWebKey object as defined by <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#JsonWebKey-dictionary">Web Cryptography API §JsonWebKey-dictionary</a> describing the public key that this client uses for the Token Binding protocol when communicating with the Relying Party. This can be
    omitted if no Token Binding has been negotiated between the client and the Relying Party.</p>
    <p>The optional <dfn class="dfn-paneled" data-dfn-for="ClientData" data-dfn-type="dfn" data-noexport="" id="clientdata-extensions">extensions</dfn> member contains additional parameters generated by processing the extensions passed in
    by the Relying Party. WebAuthn extensions are detailed in Section <a href="#extensions">§7 WebAuthn Extensions</a>.</p>
   </div>
   <h4 class="heading settled" data-level="5.2.2" id="sec-authenticator-data"><span class="secno">5.2.2. </span><span class="content">Authenticator data</span><a class="self-link" href="#sec-authenticator-data"></a></h4>
   <p>The authenticator data encodes contextual bindings made by the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-16">authenticator</a> itself. The authenticator data has a compact
but extensible encoding. This is desired since authenticators can be devices with limited capabilities and low power
requirements, with much simpler software stacks than the client platform components.</p>
   <p>The encoding of authenticator data is a byte array of 37 bytes or more, as follows.</p>
   <table class="complex data longlastcol">
    <tbody>
     <tr>
      <th>Byte index
      <th>Description
     <tr>
      <td>0-31
      <td> SHA-256 hash of the RP ID associated with the credential. 
     <tr>
      <td>32
      <td>
        Flags (bit 0 is the least significant bit): 
       <ul>
        <li data-md="">
         <p>Bit 0: Test of User Presence (<code>TUP</code>) result.</p>
        <li data-md="">
         <p>Bits 1-6: Reserved for future use (<code>RFU</code>).</p>
        <li data-md="">
         <p>Bit 7: Extension data included (<code>ED</code>). Indicates if the authenticator data has extensions.</p>
       </ul>
     <tr>
      <td>33-36
      <td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.
     <tr>
      <td>37-
      <td> Extension-defined authenticator data. This is a CBOR <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a> map with extension identifiers as keys, and
            extension authenticator data values as values. See <a href="#extensions">§7 WebAuthn Extensions</a> for details. 
   </table>
   <p>Note that the RP ID hash is originally received from the client when the credential is created, and again when an assertion is
generated. However, it differs from other client data in some important ways. First, unlike the client data, the RP ID of a
credential does not change between operations but instead remains the same for the lifetime of that credential. Secondly, it is
validated by the authenticator during the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-6">authenticatorGetAssertion</a> operation, by making sure that the RP ID hash
associated with the requested credential exactly matches the RP ID hash supplied by the client. These differences also explain
why the RP ID hash is always a SHA-256 hash instead of being crypto-agile like the <var>clientDataHash</var>; for a given RP ID, we need
the hash to be computed the same way by all clients for all operations so that authenticators can move between clients without
losing interoperability.</p>
   <p>The <code>TUP</code> flag SHALL be set if and only if the authenticator detected a user through an authenticator specific gesture. The <code>RFU</code> bits in the flags byte SHALL be set to zero.</p>
   <p>If the authenticator does not include any extension data, it MUST set the <code>ED</code> flag in the first byte to zero, and to one if
extension data is included.</p>
   <p>The figure below shows a visual representation of the authenticator data structure.</p>
   <figure>
     <img src="img/fido-signature-formats-figure1.svg"> 
    <figcaption><dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="authenticatordata">authenticatorData</dfn> layout.</figcaption>
   </figure>
   <p class="note" role="note">Note: The <code>authenticatorData</code> describes its own length: If the ED flag is not set, it is always 37 bytes long. If the ED flag is set,
it is 37 bytes plus the CBOR map that follows.</p>
   <h4 class="heading settled" data-level="5.2.3" id="authenticator-signature"><span class="secno">5.2.3. </span><span class="content">Generating a signature</span><a class="self-link" href="#authenticator-signature"></a></h4>
   <p>Before making a request to an authenticator, the client platform layer SHALL perform the following steps.</p>
   <ol>
    <li data-md="">
     <p>Represent the parameters passed in by the RP in the form of a <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-2">ClientData</a></code> structure.</p>
    <li data-md="">
     <p>Let <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="clientdatajson">clientDataJSON</dfn> be the UTF-8 encoded JSON serialization <a data-link-type="biblio" href="#biblio-rfc7159">[RFC7159]</a> of this ClientData dictionary.</p>
    <li data-md="">
     <p>Let <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="clientdatahash">clientDataHash</dfn> be the hash (computed using <a data-link-type="dfn" href="#clientdata-hashalg" id="ref-for-clientdata-hashalg-1">hashAlg</a>) of <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-2">clientDataJSON</a>, as an array.</p>
   </ol>
   <p>The <var>clientDataHash</var> value is delivered to the authenticator.</p>
   <p>The hash algorithm <a data-link-type="dfn" href="#clientdata-hashalg" id="ref-for-clientdata-hashalg-2">hashAlg</a> used to compute <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-1">clientDataHash</a> is included in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-3">ClientData</a></code> object. This way it
is available to the Relying Party and it is also hashed over when computing <a data-link-type="dfn" href="#clientdatahash" id="ref-for-clientdatahash-2">clientDataHash</a> and hence anchored in the signature
itself.</p>
   <p>A raw cryptographic signature must assert the integrity of both the client data and the authenticator data. Thus, an <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-17">authenticator</a> SHALL compute a signature over the concatenation of the <var>authenticatorData</var> and the <var>clientDataHash</var>.</p>
   <figure id="fig-signature">
     <img src="img/fido-signature-formats-figure2.svg"> 
    <figcaption>Generating a signature on the authenticator.</figcaption>
   </figure>
   <p class="note" role="note">Note: A simple, undelimited concatenation is safe to use here because the <var>authenticatorData</var> describes its own length. The <var>clientDataHash</var> (which potentially has a variable length) is always the last element.</p>
   <p>The authenticator MUST return both the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-2">authenticatorData</a> and the raw signature back to the client. The client, in turn,
MUST return <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-3">clientDataJSON</a>, <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-3">authenticatorData</a> and the signature to the RP. The <a data-link-type="dfn" href="#clientdatajson" id="ref-for-clientdatajson-4">clientDataJSON</a> is returned
in the <code>clientData</code> member of the <code class="idl"><a data-link-type="idl" href="#webauthnassertion" id="ref-for-webauthnassertion-5">WebAuthnAssertion</a></code> and <code class="idl"><a data-link-type="idl" href="#webauthnattestation" id="ref-for-webauthnattestation-3">WebAuthnAttestation</a></code> structures.</p>
   <h3 class="heading settled" data-level="5.3" id="attestation"><span class="secno">5.3. </span><span class="content">Credential Attestation Statements</span><a class="self-link" href="#attestation"></a></h3>
   <p>An attestation statement is a specific type of signature, which contains statements about a credential itself and the
authenticator that holds it. Therefore, the procedures for generating attestation statements closely parallel those for
generating WebAuthn assertions as described in <a href="#signature-format">§5.2 Signature Format</a>, though the semantics of the contextual bindings are quite
different.</p>
   <p>This specification defines a number of attestation formats, i.e., ways to serialize the data being attested to by the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-18">Authenticator</a>. The reason is to be able to support existing devices like TPMs and other platform-specific formats. Each
attestation format provides the ability to cryptographically attest to a public key, the authenticator model, and contextual data
to a remote party. They differ in the details of how the attestation statement is laid out, and how its components are computed.
The different attestation formats are defined in <a href="#defined-attestation-formats">§6 Defined Attestation Formats</a>.</p>
   <p>This specification also defines a number of attestation types. These define how a Relying Party establishes trust in a particular
attestation statement, after verifying that it is cryptographically valid.</p>
   <p>Attestation formats are orthogonal to attestation types, i.e. attestation formats in general are not restricted to a single
attestation type. For example the "packed" attestation format (see below) can be used in conjunction with all attestation types.
Broadly speaking, attestation formats pertain to the formatting / encoding of the attestation statement
rawData, while attestation types pertain to the semantics.
The privacy, the security and the operational characteristic of attestation mainly depends 
on the attestation type while it is largely independent from the attestation format.</p>
   <h4 class="heading settled" data-level="5.3.1" id="attestation-types"><span class="secno">5.3.1. </span><span class="content">Attestation Types</span><a class="self-link" href="#attestation-types"></a></h4>
   <p>WebAuthn supports multiple attestation types:</p>
   <dl>
    <dt data-md="">
     <p>Full Basic Attestation</p>
    <dd data-md="">
     <p>In the case of full basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the Authenticator’s attestation private key is specific to an
Authenticator model.  That means that an Authenticator of the same model typically shares the same attestation private key.
This model is also used for FIDO UAF 1.0 and FIDO U2F 1.0.</p>
    <dt data-md="">
     <p>Surrogate Basic Attestation</p>
    <dd data-md="">
     <p>In the case of surrogate basic attestation <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a>, the Authenticator doesn’t have any specific attestation key.
Instead it uses the authentication key to (self-)sign the (surrogate) attestation message. Authenticators without meaningful
protection measures for an attestation private key typically use this attestation type.</p>
    <dt data-md="">
     <p>Privacy CA</p>
    <dd data-md="">
     <p>In this case, the Authenticator owns an authenticator-specific (endorsement) key. This key is used to securely communicate
with a trusted third party, the Privacy CA.  The Authenticator can generate multiple attestation key pairs and asks the
Privacy CA to issue an attestation certificate for it. Using this approach, the Authenticator can limit the exposure of the
endorsement key (which is a global correlation handle) to Privacy CA(s). Attestation keys can be requested for each scoped
credential individually.</p>
     <p class="note" role="note">Note: This concept typically leads to multiple attestation certificates. The attestation certificate requested most recently
    is called "active".</p>
    <dt data-md="">
     <p>Direct Anonymous Attestation (DAA)</p>
    <dd data-md="">
     <p>In this case, the Authenticator receives DAA credentials from a single DAA-Issuer. These DAA credentials are used along with
blinding to sign the attestation data. The concept of blinding avoids the DAA credentials being misused as global
correlation handle. WebAuthn supports DAA using elliptic curve cryptography and bilinear pairings, called ECDAA (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>) in this specification.</p>
   </dl>
   <p>Compliant servers MUST support all attestation types. Authenticators can choose what attestation type to implement.</p>
   <p class="note" role="note">Note: Relying Parties can always decide what attestation types are acceptable to them by policy.</p>
   <h4 class="heading settled" data-level="5.3.2" id="verifying-an-attestation-statement"><span class="secno">5.3.2. </span><span class="content">Verifying an Attestation Statement</span><a class="self-link" href="#verifying-an-attestation-statement"></a></h4>
   <p>This section outlines the recommended algorithm for verifying an attestation statement, independent of attestation format.</p>
   <p>Upon receiving an attestation statement, the Relying Party shall:</p>
   <ol>
    <li data-md="">
     <p>Verify that the attestation statement is properly formatted.</p>
    <li data-md="">
     <p>If <code>alg</code> is not ECDAA (e.g., not "ED256" and not "ED512"):</p>
     <ul>
      <li data-md="">
       <p>Look up the attestation root certificate from a trusted source. The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides
an easy way to access such information. The <code>claimedAAGUID</code> can be used for this lookup.</p>
      <li data-md="">
       <p>Verify that the attestation certificate chain is valid and chains up to a trusted root (following <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a>).</p>
      <li data-md="">
       <p>Verify that the attestation certificate has the right Extended Key Usage (EKU) based on the WebAuthn Authenticator type
(as denoted by the <code>type</code> member). In case of a type="tpm", this EKU shall be OID "2.23.133.8.3". Defined attestation
formats are in <a href="#defined-attestation-formats">§6 Defined Attestation Formats</a>.</p>
      <li data-md="">
       <p>If the attestation format is "android", verify that the attestation certificate is issued to the hostname
"attest.android.com" (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response"> SafetyNet online documentation</a>).</p>
      <li data-md="">
       <p>Verify that all issuing CA certificates in the chain are valid and not revoked.</p>
      <li data-md="">
       <p>Verify the <code>signature</code> on <code>rawData</code> using the attestation certificate public key and algorithm as identified by <code>alg</code>.</p>
      <li data-md="">
       <p>Verify <code>rawData</code> syntax and that it doesn’t contradict the signing algorithm specified in <code>alg</code>.</p>
      <li data-md="">
       <p>If the attestation certificate contains an extension with OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) verify
that the value of this extension matches <code>claimedAAGUID</code>.  This identifies the Authenticator model.</p>
      <li data-md="">
       <p>If such extension doesn’t exist, the attestation root certificate is dedicated to a single Authenticator model.</p>
     </ul>
    <li data-md="">
     <p>If <code>alg</code> is ECDAA (e.g., "ED256", "ED512"):</p>
     <ul>
      <li data-md="">
       <p>Look up the DAA root key from a trusted source.  The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to
access such information. The <code>claimedAAGUID</code> can be used for this lookup.</p>
      <li data-md="">
       <p>Perform DAA-Verify on <code>signature</code> for <code>rawData</code> (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).</p>
      <li data-md="">
       <p>Verify <code>rawData</code> syntax and that it doesn’t contradict the signing algorithm specified in <code>alg</code>.</p>
      <li data-md="">
       <p>The DAA root key is dedicated to a single Authenticator model.</p>
     </ul>
    <li data-md="">
     <p>Verify the contextual bindings (e.g., channel binding) from the clientData (see <a href="#authenticator-signature">§5.2.3 Generating a signature</a>).</p>
    <li data-md="">
     <p>Verify that user verification method and other authenticator characteristics related to this authenticator model, match the
Relying Party policy. The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access the authenticator
characteristics.</p>
   </ol>
   <p>The Relying Party MAY take any of the below actions when verification of an attestation statement fails:</p>
   <ul>
    <li data-md="">
     <p>Reject the request, such as a registration request, associated with the attestation statement.</p>
    <li data-md="">
     <p>Accept the request associated with the attestation statement but treat the attested Scoped Credential as one with surrogate
basic attestation (see <a href="#attestation-types">§5.3.1 Attestation Types</a>), if policy allows it. If doing so, there is no cryptographic proof that the
Scoped Credential has been generated by a particular Authenticator model. See <a data-link-type="biblio" href="#biblio-fidosecref">[FIDOSecRef]</a> and <a data-link-type="biblio" href="#biblio-uafprotocol">[UAFProtocol]</a> for more
details on the relevance on attestation.</p>
   </ul>
   <p>Verification of attestation statements requires that the relying party trusts the root of the attestation certificate chain.
Also, the Relying Party must have access to certificate status information for the intermediate CA certificates. The relying party must
also be able to build the attestation certificate chain if the client didn’t provide this chain in the attestation information.</p>
   <h4 class="heading settled" data-level="5.3.3" id="sec-attestation-security-considerations"><span class="secno">5.3.3. </span><span class="content">Security Considerations</span><a class="self-link" href="#sec-attestation-security-considerations"></a></h4>
   <h5 class="heading settled" data-level="5.3.3.1" id="sec-attestation-privacy"><span class="secno">5.3.3.1. </span><span class="content">Privacy</span><a class="self-link" href="#sec-attestation-privacy"></a></h5>
   <p>Attestation keys may be used to track users or link various online identities of the same user together. This may be mitigated
in several ways, including:</p>
   <ul>
    <li data-md="">
     <p>A WebAuthn <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-19">Authenticator</a> manufacturer may choose to ship all of their devices with the same (or a fixed number of)
attestation key(s) (called Full Basic Attestation). This will anonymize the user at the risk of not being able to revoke a
particular attestation key should its WebAuthn Authenticator be compromised.</p>
    <li data-md="">
     <p>A WebAuthn Authenticator may be capable of dynamically generating different attestation keys (and requesting related
certificates) per origin (following the Privacy CA approach). For example, a WebAuthn Authenticator can ship with a master
attestation key (and certificate), and combined with a cloud operated privacy CA, can dynamically generate per origin
attestation keys and attestation certificates.</p>
    <li data-md="">
     <p>A WebAuthn Authenticator can implement direct anonymous attestation (see <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a>).  Using this scheme, the
authenticator generates a blinded attestation signature.  This allows the Relying Party to verify the signature using the DAA root
key, but the attestation signature doesn’t serve as a global correlation handle.</p>
   </ul>
   <h5 class="heading settled" data-level="5.3.3.2" id="ca-compromise"><span class="secno">5.3.3.2. </span><span class="content">Attestation Certificate and Attestation Certificate CA Compromise</span><a class="self-link" href="#ca-compromise"></a></h5>
   <p>When an intermediate CA or a root CA used for issuing attestation certificates is compromised, WebAuthn <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-20">Authenticator</a> attestation keys are still safe although their certificates can no longer be trusted. A WebAuthn Authenticator manufacturer that
has recorded the public attestation keys for their devices can issue new attestation certificates for these keys from a new
intermediate CA or from a new root CA. If the root CA changes, the Relying Parties must update their trusted root certificates
accordingly.</p>
   <p>A WebAuthn Authenticator attestation certificate must be revoked by the issuing CA if its key has been compromised. A WebAuthn
Authenticator manufacturer may need to ship a firmware update and inject new attestation keys and certificates into already
manufactured WebAuthn Authenticators, if the exposure was due to a firmware flaw. (The process by which this happens is out of
scope for this specification.) No further valid attestation statements can be made by the affected WebAuthn Authenticators
unless the WebAuthn Authenticator manufacturer has this capability.</p>
   <p>If attestation certificate validation fails due to a revoked intermediate attestation CA certificate, and the Relying Party’s policy
requires rejecting the registration/authentication request in these situations, then it is recommended that the Relying Party also
un-registers (or marks as "surrogate attestation" (see <a href="#attestation-types">§5.3.1 Attestation Types</a>), policy permitting) scoped credentials that were
registered post the CA compromise date using an attestation certificate chaining up to the same intermediate CA. It is thus
recommended that Relying Parties remember intermediate attestation CA certificates during Authenticator registration in order to
un-register related Scoped Credentials if the registration was performed after revocation of such certificates.</p>
   <p>If a DAA attestation key has been compromised, it can be added to the RogueList (i.e., the list of revoked authenticators)
maintained by the related DAA-Issuer. The Relying Party should verify whether an authenticator belongs to the RogueList when performing
DAA-Verify. The FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a> provides an easy way to access such information.</p>
   <h5 class="heading settled" data-level="5.3.3.3" id="cert-hierarchy"><span class="secno">5.3.3.3. </span><span class="content">Attestation Certificate Hierarchy</span><a class="self-link" href="#cert-hierarchy"></a></h5>
   <p>A 3 tier hierarchy for attestation certificates is recommended (i.e., Attestation Root, Attestation Issuing CA, Attestation
Certificate). It is also recommended that for each WebAuthn Authenticator device line (i.e., model), a separate issuing CA is
used to help facilitate isolating problems with a specific version of a device.</p>
   <p>If the attestation root certificate is not dedicated to a single WebAuthn Authenticator device line (i.e., AAGUID), the AAGUID
must be specified either in the attestation certificate itself or it must be specified in <code>rawData</code>.</p>
   <h2 class="heading settled" data-level="6" id="defined-attestation-formats"><span class="secno">6. </span><span class="content">Defined Attestation Formats</span><a class="self-link" href="#defined-attestation-formats"></a></h2>
   <p>WebAuthn supports pluggable attestation data formats. This allows support of TPM generated attestation data as well as support of
other WebAuthn <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-21">authenticators</a>. As mentioned in <a href="#attestation">§5.3 Credential Attestation Statements</a>, these differ in how the attestation statement is
computed and formatted. This section defines these details.</p>
   <p>The contents of the attestation data must be controlled (i.e., generated or at least verified) by the authenticator itself.</p>
   <h3 class="heading settled" data-level="6.1" id="packed-attestation"><span class="secno">6.1. </span><span class="content">Packed Attestation ("packed")</span><a class="self-link" href="#packed-attestation"></a></h3>
   <p>Packed attestation is a WebAuthn optimized format of attestation data. It uses a very compact but still extensible encoding
method. Encoding this format can even be implemented by <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-22">authenticators</a> with very limited resources (e.g., secure
elements).</p>
   <p>A Packed Attestation statement has the following format:</p>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="attestationstatement">AttestationStatement<a class="self-link" href="#attestationstatement"></a></dfn> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="unsigned long" id="dom-attestationstatement-version">version<a class="self-link" href="#dom-attestationstatement-version"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-attestationstatement-claimedaaguid">claimedAAGUID<a class="self-link" href="#dom-attestationstatement-claimedaaguid"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>[]   <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString[]" id="dom-attestationstatement-x5c">x5c<a class="self-link" href="#dom-attestationstatement-x5c"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-attestationstatement-alg">alg<a class="self-link" href="#dom-attestationstatement-alg"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-attestationstatement-rawdata">rawData<a class="self-link" href="#dom-attestationstatement-rawdata"></a></dfn>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <dfn class="nv idl-code" data-dfn-for="AttestationStatement" data-dfn-type="attribute" data-export="" data-readonly="" data-type="ArrayBuffer" id="dom-attestationstatement-signature">signature<a class="self-link" href="#dom-attestationstatement-signature"></a></dfn>;
};
</pre>
   <div>
     The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-version">version<a class="self-link" href="#attestationstatement-version"></a></dfn> member specifies the version number of the rawData object. Only version="1" is defined at this time. 
    <p>The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-claimedaaguid">claimedAAGUID<a class="self-link" href="#attestationstatement-claimedaaguid"></a></dfn> element contains the claimed Authenticator Attestation GUID (a version 4 GUID, see <a data-link-type="biblio" href="#biblio-rfc4122">[RFC4122]</a>). This value is used by the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-20">Relying Party</a> to look up the trust anchor for verifying the following signature. If
    the verification succeeds, the AAGUID related to the trust anchor is trusted. This field MUST be present, if either no
    attestation certificates are used (e.g., DAA) or if the attestation certificate doesn’t contain the AAGUID value in an
    extension.</p>
    <p>The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-x5c">x5c<a class="self-link" href="#attestationstatement-x5c"></a></dfn> attribute contains the attestation certificate and its certificate chain as described in <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> section 4.1.6.</p>
    <p>The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-alg">alg<a class="self-link" href="#attestationstatement-alg"></a></dfn> element contains the name of the algorithm used to generate the attestation signature according to <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a> section 3.1.</p>
    <p>The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-rawdata">rawData<a class="self-link" href="#attestationstatement-rawdata"></a></dfn> object contains the attested public key and the <var>clientDataHash</var>. See <a href="#sec-raw-data-packed">§6.1.1 Attestation rawData</a> for
    details.</p>
    <p>The <dfn data-dfn-for="AttestationStatement" data-dfn-type="dfn" data-noexport="" id="attestationstatement-signature">signature<a class="self-link" href="#attestationstatement-signature"></a></dfn> element contains the attestation signature. See <a href="#packed-attestation-signature">§6.1.2 Signature</a> for details.</p>
   </div>
   <h4 class="heading settled" data-level="6.1.1" id="sec-raw-data-packed"><span class="secno">6.1.1. </span><span class="content">Attestation rawData</span><a class="self-link" href="#sec-raw-data-packed"></a></h4>
   <p>The attestation data encodes contextual bindings made by the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-23">authenticator</a> itself. Unlike client data, the authenticator
data has a compact but extensible encoding. This is desired since authenticators can be devices with limited capabilities and
low power requirements, with much simpler software stacks than the client platform components.</p>
   <p>The field <code>rawData</code> for this type is a variable-length byte array, consisting of various fixed-length and variable-length fields
arranged as given below:</p>
   <table class="complex data longlastcol">
    <tbody>
     <tr>
      <th>Length (in bytes)
      <th>Description
     <tr>
      <td>2
      <td> 0xF1D0, fixed big-endian TAG to make sure this object won’t be confused with other (non-WebAuthn) binary objects. 
     <tr>
      <td>2
      <td>Byte length l of AAGUID
     <tr>
      <td>(length)
      <td>AAGUID (l bytes)
     <tr>
      <td>1
      <td>
        Flags (bit 0 is the least significant bit): 
       <ul>
        <li data-md="">
         <p>Bit 0: Test of User Presence (<code>TUP</code>) result.</p>
        <li data-md="">
         <p>Bits 1-6: Reserved for future use (<code>RFU</code>).</p>
        <li data-md="">
         <p>Bit 7: Extension data included (<code>ED</code>). Indicates whether the authenticator added extensions (see below).</p>
       </ul>
     <tr>
      <td>4
      <td>Signature counter (<code>signCount</code>), 32-bit unsigned big-endian integer.
     <tr>
      <td>2
      <td>
        Public key algorithm and encoding (16-bit big-endian value). Allowed values are: 
       <ol>
        <li data-md="">
         <p>0x0100. This is raw ANSI X9.62 formatted Elliptic Curve public key <a data-link-type="biblio" href="#biblio-sec1">[SEC1]</a>, i.e., <code>[0x04, X (n bytes), Y (n bytes)]</code>, where the byte <code>0x04</code> denotes the uncompressed point compression method and
n denotes the key length in bytes.</p>
        <li data-md="">
         <p>0x0102.  Raw encoded RSA PKCS1 or RSASSA-PSS public key <a data-link-type="biblio" href="#biblio-rfc3447">[RFC3447]</a>. In the case of RSASSA-PSS, the default
parameters according to <a data-link-type="biblio" href="#biblio-rfc4055">[RFC4055]</a> MUST be assumed, i.e.,</p>
         <ul>
          <li data-md="">
           <p>Mask Generation Algorithm MGF1 with SHA256</p>
          <li data-md="">
           <p>Salt Length of 32 bytes, i.e., the length of a SHA256 hash value.</p>
          <li data-md="">
           <p>Trailer Field value of 1, which represents the trailer field with hexadecimal value <code>0xBC</code>.</p>
         </ul>
         <p>That is, <code>[modulus (256 bytes), e (m-n bytes)]</code>, where <code>m</code> is the total length of the field. This total length
should be taken from the object containing this key</p>
       </ol>
     <tr>
      <td>2
      <td>Byte length m of following public key bytes (16 bit value with most significant byte first).
     <tr>
      <td>(length)
      <td>The public key (m bytes) according to the encoding denoted before.
     <tr>
      <td>2
      <td>Byte length l of Credential ID
     <tr>
      <td>(length)
      <td>Credential ID (l bytes)
     <tr>
      <td>2
      <td>Byte length n of clientDataHash
     <tr>
      <td>n
      <td> clientDataHash (see <a href="#authenticator-signature">§5.2.3 Generating a signature</a>). This is the hash of <code>clientDataJSON</code>. The hash algorithm itself
            is stored in the <code>clientData</code> object <a href="#signature-format">§5.2 Signature Format</a>. 
     <tr>
      <td>As defined by the extension map
      <td> Extension-defined authenticator data. This is a CBOR <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a> map with extension identifiers as keys, and
            extension authenticator data values as values. See <a href="#extensions">§7 WebAuthn Extensions</a> for a description of the extension mechanism.
            See <a href="#extension-predef">§8 Pre-defined extensions</a> for pre-defined extensions. 
   </table>
   <p>The <code>TUP</code> flag SHALL be set if and only if the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-24">authenticator</a> detected a user through an authenticator-specific gesture.
The <code>RFU</code> bits in the flags byte SHALL be cleared (i.e., zeroed).</p>
   <div class="note" role="note">
     Note: The authenticator model (identified by the AAGUID) can be derived from 
    <ul>
     <li data-md="">
      <p>here, or</p>
     <li data-md="">
      <p>from the attestation certificate (if we have an authenticator specific or authenticator model specific attestation
certificate), or</p>
     <li data-md="">
      <p>from the claimed AAGUID in the client encoded attestation statement (if there is one attestation root certificate
per authenticator model).</p>
    </ul>
    <p>In the case of DAA there is no need for an X.509 attestation certificate hierarchy. Instead the trust anchor being
  known to the Relying Party is the DAA root key (i.e., ECPoint2 X, Y).  This root key must be dedicated to a single
  authenticator model.</p>
   </div>
   <p>If the authenticator does not wish to add extensions, it MUST clear the <code>ED</code> flag in the third byte.</p>
   <h4 class="heading settled" data-level="6.1.2" id="packed-attestation-signature"><span class="secno">6.1.2. </span><span class="content">Signature</span><a class="self-link" href="#packed-attestation-signature"></a></h4>
   <p>The <code>signature</code> is computed over the <code>rawData</code> field. The following algorithms must be implemented by servers:</p>
   <ol>
    <li data-md="">
     <p>"ES256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
    <li data-md="">
     <p>"RS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
    <li data-md="">
     <p>"PS256" <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a></p>
    <li data-md="">
     <p>"ED256" <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a></p>
   </ol>
   <p><a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-25">Authenticators</a> can choose which algorithm(s) to implement. Relying Parties must implement all the algorithms implemented by the
authenticators that they support.</p>
   <h4 class="heading settled" data-level="6.1.3" id="packed-attestation-cert-requirements"><span class="secno">6.1.3. </span><span class="content">Packed attestation statement certificate requirements</span><a class="self-link" href="#packed-attestation-cert-requirements"></a></h4>
   <p class="note" role="note">Note: In the case of DAA attestation <a data-link-type="biblio" href="#biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]</a> no <a data-link-type="dfn" href="#attestation-certificate" id="ref-for-attestation-certificate-1">attestation certificate</a> is used.</p>
   <p>The attestation certificate MUST have the following fields/extensions:</p>
   <ul>
    <li data-md="">
     <p>Version must be set to 3.</p>
    <li data-md="">
     <p>Subject field MUST be set to:</p>
     <dl>
      <dt data-md="">
       <p>Subject-C</p>
      <dd data-md="">
       <p>Country where the Authenticator vendor is incorporated</p>
      <dt data-md="">
       <p>Subject-O</p>
      <dd data-md="">
       <p>Legal name of the Authenticator vendor</p>
      <dt data-md="">
       <p>Subject-OU</p>
      <dd data-md="">
       <p>Authenticator Attestation</p>
      <dt data-md="">
       <p>Subject-CN</p>
      <dd data-md="">
       <p>No stipulation.</p>
     </dl>
    <li data-md="">
     <p>If the related attestation root certificate is used for multiple authenticator models, the Extension OID <code>1 3 6 1 4 1 45724 1 1 4</code> (id-fido-gen-ce-aaguid) MUST be present, containing the AAGUID as value.</p>
    <li data-md="">
     <p>The Basic Constraints extension MUST have the CA component set to false</p>
    <li data-md="">
     <p>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are both optional as the status of attestation certificates is available through the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="6.2" id="tpm-attestation"><span class="secno">6.2. </span><span class="content">TPM Attestation ("tpm")</span><a class="self-link" href="#tpm-attestation"></a></h3>
   <p>This attestation format returns an attestation statement in the same format as defined in <a href="#packed-attestation">§6.1 Packed Attestation ("packed")</a>. However the <code>rawData</code> and <code>signature</code> fields are computed differently, as described below.</p>
   <h4 class="heading settled" data-level="6.2.1" id="sec-raw-data-tpm"><span class="secno">6.2.1. </span><span class="content">Attestation rawData</span><a class="self-link" href="#sec-raw-data-tpm"></a></h4>
   <p>The value of <code>rawData</code> is either a TPM_CERTIFY_INFO or a TPM_CERTIFY_INFO2 structure <a data-link-type="biblio" href="#biblio-tpmv1-2-part2">[TPMv1-2-Part2]</a> sections 11.1 and 11.2,
if <code>version</code> equals 1. Else, if <code>version</code> equals 2, it MUST be a TPMS_ATTEST structure as defined in <a data-link-type="biblio" href="#biblio-tpmv2-part2">[TPMv2-Part2]</a> section
10.12.9.</p>
   <p>The field "extraData" (in the case of TPMS_ATTEST) or the field "data" (in the case of TPM_CERTIFY_INFO or TPM_CERTIFY_INFO2)
MUST contain the <code>clientDataHash</code> (see <a href="#signature-format">§5.2 Signature Format</a>).</p>
   <h4 class="heading settled" data-level="6.2.2" id="tpm-attestation-signature"><span class="secno">6.2.2. </span><span class="content">Signature</span><a class="self-link" href="#tpm-attestation-signature"></a></h4>
   <p>If <code>version</code> equals 1, (i.e., for TPM 1.2), RSASSA-PKCS1-v1_5 signature algorithm (section 8.2 of <a data-link-type="biblio" href="#biblio-rfc3447">[RFC3447]</a>) can be used by
WebAuthn Authenticators (i.e., <code>alg</code>="RS256").</p>
   <p>If <code>version</code> equals 2, the following algorithms can be used by WebAuthn Authenticators:</p>
   <ol>
    <li data-md="">
     <p>TPM_ALG_RSASSA (0x14).  This is the same algorithm RSASSA-PKCS1-v1_5 as for version 1 but for use with TPMv2. <code>alg</code>="RS256".</p>
    <li data-md="">
     <p>TPM_ALG_RSAPSS (0x16); <code>alg</code>="PS256".</p>
    <li data-md="">
     <p>TPM_ALG_ECDSA (0x18); <code>alg</code>="ES256".</p>
    <li data-md="">
     <p>TPM_ALG_ECDAA (0x1A); <code>alg</code>="ED256".</p>
    <li data-md="">
     <p>TPM_ALG_SM2 (0x1B); <code>alg</code>="SM256".</p>
   </ol>
   <p>Relying Parties must implement all the algorithms implemented by the authenticators that they support.</p>
   <p>The <code>signature</code> is computed over the <code>rawData</code> field.</p>
   <h4 class="heading settled" data-level="6.2.3" id="tpm-cert-requirements"><span class="secno">6.2.3. </span><span class="content">TPM attestation statement certificate requirements</span><a class="self-link" href="#tpm-cert-requirements"></a></h4>
   <p>TPM <a data-link-type="dfn" href="#attestation-certificate" id="ref-for-attestation-certificate-2">attestation certificate</a> MUST have the following fields/extensions:</p>
   <ul>
    <li data-md="">
     <p>Version must be set to 3.</p>
    <li data-md="">
     <p>Subject field MUST be set to empty.</p>
    <li data-md="">
     <p>The Subject Alternative Name extension must be set as defined in <a data-link-type="biblio" href="#biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]</a> section 3.2.9 if "version" equals 2 and <a data-link-type="biblio" href="#biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]</a> section 3.2.9 if "version" equals 1.</p>
    <li data-md="">
     <p>The Extended Key Usage extension MUST contain the
"joint-iso-itu-t(2) internationalorganizations(23) 133 tcg-kp(8) tcg-kp-AIKCertificate(3)" OID.</p>
    <li data-md="">
     <p>The Basic Constraints extension MUST have the CA component set to false</p>
    <li data-md="">
     <p>An Authority Information Access (AIA) extension with entry <code>id-ad-ocsp</code> and a CRL Distribution Point extension <a data-link-type="biblio" href="#biblio-rfc5280">[RFC5280]</a> are
both optional as the status of attestation certificates is available through the FIDO Metadata Service <a data-link-type="biblio" href="#biblio-fidometadataservice">[FIDOMetadataService]</a>.</p>
   </ul>
   <h3 class="heading settled" data-level="6.3" id="android-attestation"><span class="secno">6.3. </span><span class="content">Android Attestation (type="android")</span><a class="self-link" href="#android-attestation"></a></h3>
   <p>When the <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-26">Authenticator</a> in question is a platform-provided Authenticator on the Android platform, the attestation
statement is based on the <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response">SafetyNet
API</a>.</p>
   <p>This type of attestation statement is formatted as follows:</p>
<pre class="idl highlight def"><span class="kt">interface</span> <dfn class="nv idl-code" data-dfn-type="interface" data-export="" id="androidattestation">AndroidAttestation<a class="self-link" href="#androidattestation"></a></dfn> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <dfn class="nv idl-code" data-dfn-for="AndroidAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="unsigned long" id="dom-androidattestation-version">version<a class="self-link" href="#dom-androidattestation-version"></a></dfn>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span>     <dfn class="nv idl-code" data-dfn-for="AndroidAttestation" data-dfn-type="attribute" data-export="" data-readonly="" data-type="DOMString" id="dom-androidattestation-safetynetresponse">safetyNetResponse<a class="self-link" href="#dom-androidattestation-safetynetresponse"></a></dfn>;
};
</pre>
   <div>
     The <dfn data-dfn-for="AndroidAttestation" data-dfn-type="dfn" data-noexport="" id="androidattestation-version">version<a class="self-link" href="#androidattestation-version"></a></dfn> element is set to the version number of Google Play Services responsible for providing the SafetyNet
    API. 
    <p>The <dfn data-dfn-for="AndroidAttestation" data-dfn-type="dfn" data-noexport="" id="androidattestation-safetynetresponse">safetyNetResponse<a class="self-link" href="#androidattestation-safetynetresponse"></a></dfn> element contains the value returned by the above SafetyNet API. This value is a JWS <a data-link-type="biblio" href="#biblio-rfc7515">[RFC7515]</a> object (see <a href="https://developer.android.com/training/safetynet/index.html#compat-check-response"> SafetyNet online documentation</a>) in Compact Serialization.</p>
   </div>
   <h4 class="heading settled" data-level="6.3.1" id="sec-android-attestation-signature"><span class="secno">6.3.1. </span><span class="content">Signature</span><a class="self-link" href="#sec-android-attestation-signature"></a></h4>
   <p>For this attestation format, the ClientData dictionary is extended in the following way:</p>
<pre class="idl highlight def"><span class="kt">dictionary</span> <dfn class="nv idl-code" data-dfn-type="dictionary" data-export="" id="dictdef-androidattestationclientdata">AndroidAttestationClientData<a class="self-link" href="#dictdef-androidattestationclientdata"></a></dfn> : <a class="n" data-link-type="idl-name" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-4">ClientData</a> {
    <a class="n" data-link-type="idl-name" href="#dictdef-jsonwebkey" id="ref-for-dictdef-jsonwebkey-2">JsonWebKey</a>    <dfn class="nv idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="JsonWebKey    " id="dom-androidattestationclientdata-publickey">publicKey<a class="self-link" href="#dom-androidattestationclientdata-publickey"></a></dfn>;
    <span class="kt">boolean</span>       <dfn class="nv idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="boolean       " id="dom-androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware<a class="self-link" href="#dom-androidattestationclientdata-isinsidesecurehardware"></a></dfn>;
    <span class="kt">DOMString</span>     <dfn class="nv idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="DOMString     " id="dom-androidattestationclientdata-userauthentication">userAuthentication<a class="self-link" href="#dom-androidattestationclientdata-userauthentication"></a></dfn>;
    <span class="kt">unsigned</span> <span class="kt">long</span> <dfn class="nv idl-code" data-dfn-for="AndroidAttestationClientData" data-dfn-type="dict-member" data-export="" data-type="unsigned long " id="dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds<a class="self-link" href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds"></a></dfn>; // optional
};
</pre>
   <div>
    <dl>
     <dt data-md="">
      <p>JsonWebKey <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-publickey">publicKey<a class="self-link" href="#androidattestationclientdata-publickey"></a></dfn></p>
     <dd data-md="">
      <p>The public key generated by the Authenticator, as a JsonWebKey object (see <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html#JsonWebKey-dictionary">Web Cryptography API §JsonWebKey-dictionary</a>).</p>
     <dt data-md="">
      <p>boolean <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware<a class="self-link" href="#androidattestationclientdata-isinsidesecurehardware"></a></dfn></p>
     <dd data-md="">
      <p><code>true</code> if the key resides inside secure hardware (e.g., Trusted Execution Environment (TEE) or Secure Element (SE)).</p>
     <dt data-md="">
      <p>DOMString <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-userauthentication">userAuthentication<a class="self-link" href="#androidattestationclientdata-userauthentication"></a></dfn></p>
     <dd data-md="">
      <p>One of "none", "keyguard", or "fingerprint".</p>
      <ul>
       <li data-md="">
        <p>"none" means that the user has not enrolled a fingerprint, or set up a secure lock screen, and that therefore the key
has not been linked to user authentication.</p>
       <li data-md="">
        <p>"keyguard" means that the generated key only be used after the user unlocks a secure lock screen.</p>
       <li data-md="">
        <p>"fingerprint" means that each operation involving the generated key must be individually authorized by the user by
presenting a fingerprint.</p>
      </ul>
     <dt data-md="">
      <p>optional unsigned long <dfn data-dfn-for="AndroidAttestationClientData" data-dfn-type="dfn" data-noexport="" id="androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds<a class="self-link" href="#androidattestationclientdata-userauthenticationvaliditydurationseconds"></a></dfn></p>
     <dd data-md="">
      <p>If the <code>userAuthentication</code> is set to "keyguard", then this parameter specifies the duration of time (seconds) for which
this key is authorized to be used after the user is successfully authenticated.</p>
    </dl>
   </div>
   <p>In order to generate an attestation statement, the client MUST create clientDataJSON by UTF8-encoding a structure of type
AndroidAttestationClientData, and compute clientDataHash as the hash of clientDataJSON. It must then provide clientDataHash as
the Nonce value when requesting the SafetyNet attestation.</p>
   <h4 class="heading settled" data-level="6.3.2" id="verifying-android-contextual-bindings"><span class="secno">6.3.2. </span><span class="content">Verifying AndroidClientData specific contextual bindings</span><a class="self-link" href="#verifying-android-contextual-bindings"></a></h4>
   <p>A Relying Party shall verify the clientData contextual bindings (see step 4 in <a href="#verifying-an-attestation-statement">§5.3.2 Verifying an Attestation Statement</a>) as follows:</p>
   <ul>
    <li data-md="">
     <p>Check that <code>AndroidAttestationClientData.challenge</code> equals the attestationChallenge that was passed into the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-4">makeCredential()</a></code> call.</p>
    <li data-md="">
     <p>Check that the <code>facet</code> and <code>tokenBinding</code> parameters in the <code>AndroidAttestationClientData</code> match the Relying Party App.</p>
    <li data-md="">
     <p>Check that <code>AndroidAttestationClientData.publicKey</code> is the same key as the one returned in the <code>ScopedCredentialInfo</code> by the <code>makeCredential</code> call.</p>
    <li data-md="">
     <p>Check that the hash of the clientDataJSON matches the <code>nonce</code> attribute in the payload of the <code>safetynetResponse</code> JWS.</p>
    <li data-md="">
     <p>Check that the <code>ctsProfileMatch</code> attribute in the payload of the <code>safetynetResponse</code> is true.</p>
    <li data-md="">
     <p>Check that the <code>apkPackageName</code> attribute in the payload of the <code>safetynetResponse</code> matches package name of the application
calling SafetyNet API.</p>
    <li data-md="">
     <p>Check that the <code>apkDigestSha256</code> attribute in the payload of the <code>safetynetResponse</code> matches the package hash of the
application calling SafetyNet API.</p>
    <li data-md="">
     <p>Check that the <code>apkCertificateDigestSha256</code> attribute in the payload of the <code>safetynetResponse</code> matches the hash of the
signing certificate of the application calling SafetyNet API.</p>
   </ul>
   <h2 class="heading settled" data-level="7" id="extensions"><span class="secno">7. </span><span class="content">WebAuthn Extensions</span><a class="self-link" href="#extensions"></a></h2>
   <p>The mechanism for generating scoped credentials, as well as requesting and generating WebAuthn assertions, as defined in <a href="#api">§4 Web Authentication API</a>, can be extended to suit particular use cases. Each case is addressed by defining a registration extension and/or a
authentication extension. Extensions can define additions to the following steps and data:</p>
   <ul>
    <li data-md="">
     <p><code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-5">makeCredential()</a></code> request parameters for registration extension.</p>
    <li data-md="">
     <p><code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-6">getAssertion()</a></code> request parameters for authentication extensions.</p>
    <li data-md="">
     <p>Client processing, and the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-5">ClientData</a></code> structure, for registration extensions and authentication extensions.</p>
    <li data-md="">
     <p>Authenticator processing, and the <a data-link-type="dfn" href="#authenticatordata" id="ref-for-authenticatordata-4">authenticatorData</a> structure, for registration extensions and authentication
extensions.</p>
   </ul>
   <p>When requesting an assertion for a scoped credential, a Relying Party can list a set of extensions to be used, if they are supported by
the client and/or the authenticator. It sends the client arguments for each extension in the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-7">getAssertion()</a></code> call (for
authentication extensions) or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-6">makeCredential()</a></code> call (for registration extensions) to the client platform. The client
platform performs additional processing for each extension that it supports, and augments <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-6">ClientData</a></code> as required by the
extension. In addition, the client collects the authenticator arguments for the above extensions, and passes them to the
authenticator in the <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-6">authenticatorMakeCredential</a> call (for registration extensions) or <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-7">authenticatorGetAssertion</a> call (for authentication extensions). These authenticator arguments are passed as name-value pairs, with the extension
identifier as the name, and the corresponding authenticator argument as the value. The authenticator, in turn, performs
additional processing for the extensions that it supports, and augments <var>authenticatorData</var> as specified by the extension.</p>
   <p>All WebAuthn extensions are optional for both clients and authenticators. Thus, any extensions requested by a Relying Party may be
ignored by the client browser or OS and not passed to the authenticator at all, or they may be ignored by the authenticator.
Ignoring an extension is never considered a failure in WebAuthn API processing, so when Relying Parties include extensions with any API
calls, they must be prepared to handle cases where some or all of those extensions are ignored.</p>
   <p>Clients wishing to support the widest possible range of extensions may choose to pass through any extensions that they do not
recognize to authenticators, generating the authenticator argument by simply encoding the client argument in CBOR. All
WebAuthn extensions MUST be defined in such a way that this implementation choice does not endanger the user’s security or
privacy. For instance, if an extension requires client processing, it could be defined in a manner that ensures such a naïve
pass-through will produce a semantically invalid authenticator argument, resulting in the extension being ignored by the
authenticator. Since all extensions are optional, this will not cause a functional failure in the API operation.</p>
   <h3 class="heading settled" data-level="7.1" id="extension-id"><span class="secno">7.1. </span><span class="content">Extension identifiers</span><a class="self-link" href="#extension-id"></a></h3>
   <p>Extensions are identified by a string, chosen by the extension author. Extension identifiers should aim to be globally unique,
e.g., by including the defining entity such as <code>myCompany_extension</code>.</p>
   <p>Extensions that may exist in multiple versions should take care to include a version in their identifier. In effect, different
versions are thus treated as different extensions, e.g., <code>myCompany_extension_01</code></p>
   <p>Extensions defined in this specification use a fixed prefix of <code>webauthn</code> for the extension identifiers. This prefix should not
be used for extensions not defined by the W3C.</p>
   <h3 class="heading settled" data-level="7.2" id="extension-specification"><span class="secno">7.2. </span><span class="content">Defining extensions</span><a class="self-link" href="#extension-specification"></a></h3>
   <p>A definition of an extension must specify, at minimum, an extension identifier and an extension client argument sent via the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-8">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-7">makeCredential()</a></code> call. Additionally, extensions may specify additional values in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-7">ClientData</a></code>, <code>authenticatorData</code> (in the case of authentication extensions), or both. Finally, if the extension requires any authenticator 
processing, it must also specify an authenticator argument to be sent via the <a data-link-type="dfn" href="#authenticatorgetassertion" id="ref-for-authenticatorgetassertion-8">authenticatorGetAssertion</a> or <a data-link-type="dfn" href="#authenticatormakecredential" id="ref-for-authenticatormakecredential-7">authenticatorMakeCredential</a> call.</p>
   <p>Any extension that requires client processing MUST specify a method of augmenting <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-8">ClientData</a></code> that unambiguously lets the
Relying Party know that the extension was honored by the client. Similarly, any extension that requires authenticator processing MUST
specify a method of augmenting <code>authenticatorData</code> to let the Relying Party know that the extension was honored by the authenticator.</p>
   <h3 class="heading settled" data-level="7.3" id="extension-request-parameters"><span class="secno">7.3. </span><span class="content">Extending request parameters</span><a class="self-link" href="#extension-request-parameters"></a></h3>
   <p>An extension defines up to two request arguments. The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="client-argument">client argument</dfn> is passed from the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-21">Relying Party</a> to the client
in the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-9">getAssertion()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-8">makeCredential()</a></code> call, while the <dfn data-dfn-type="dfn" data-noexport="" id="authenticator-argument">authenticator argument<a class="self-link" href="#authenticator-argument"></a></dfn> is passed from the client
to the authenticator during the processing of these calls.</p>
   <p>A Relying Party simultaneously requests the use of an extension and sets its client argument by including an entry in the <a data-link-type="dfn" href="#credentialoptions-extensions" id="ref-for-credentialoptions-extensions-2">extensions</a> option to the <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-9">makeCredential()</a></code> or <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-getassertion" id="ref-for-dom-webauthentication-getassertion-10">getAssertion()</a></code> call. The entry key MUST be
the extension identifier, and the value MUST be the <a data-link-type="dfn" href="#client-argument" id="ref-for-client-argument-1">client argument</a>.</p>
<pre class="example highlight" id="example-5d06d72b"><a class="self-link" href="#example-5d06d72b"></a>var assertionPromise = credentials.getAssertion(..., /* extensions */ {
    "webauthnExample_foobar": 42
});
</pre>
   <p>Extension definitions MUST specify the valid values for their client argument. Clients SHOULD ignore extensions with an invalid
client argument. If an extension does not require any parameters from the Relying Party, it SHOULD be defined as taking a Boolean client
argument, set to <code>true</code> to signify that the extension is requested by the Relying Party.</p>
   <p>Extensions that only affect client processing need not specify an authenticator argument. Extensions that affect authenticator
processing MUST specify a method of computing the authenticator argument from the client argument. For extensions that do not
require additional parameters, and are defined as taking a Boolean client argument set to <code>true</code>, this method SHOULD consist of
passing an authenticator argument of <code>true</code> (CBOR major type 7, value 21).</p>
   <p class="note" role="note">Note: Extensions should aim to define authenticator arguments that are as small as possible. Some authenticators communicate
    over low-bandwidth links such as Bluetooth Low-Energy or NFC.</p>
   <h3 class="heading settled" data-level="7.4" id="extension-client-processing"><span class="secno">7.4. </span><span class="content">Extending client processing</span><a class="self-link" href="#extension-client-processing"></a></h3>
   <p>Extensions may define additional processing requirements on the client platform during the creation of credentials or the
generation of an assertion. In order for the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-22">Relying Party</a> to verify the processing took place, or if the processing has a result
value that the Relying Party needs to be aware of, the extension should specify a client data value to be included in the <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-9">ClientData</a></code> structure.</p>
   <p>The client data value may be any value that can be encoded using JSON. If any extension processed by a client defines such a
value, the client SHOULD include a dictionary in <code class="idl"><a data-link-type="idl" href="#dictdef-clientdata" id="ref-for-dictdef-clientdata-10">ClientData</a></code> with the key <a data-link-type="dfn" href="#clientdata-extensions" id="ref-for-clientdata-extensions-1">extensions</a>. For each such
extension, the client SHOULD add an entry to this dictionary with the extension identifier as the key, and the extension’s
client data value.</p>
   <p>Extensions that require authenticator processing MUST define the process by which the client argument can be used to determine
the authenticator argument.</p>
   <h3 class="heading settled" data-level="7.5" id="extension-authenticator-processing"><span class="secno">7.5. </span><span class="content">Extending authenticator processing</span><a class="self-link" href="#extension-authenticator-processing"></a></h3>
   <p>Extensions that define additional authenticator processing may similarly define an authenticator data value. The value may be
any data that can be encoded in CBOR. An authenticator that processes a authentication extension that defines such a value must
include it in the <code>authenticatorData</code>.</p>
   <p>As specified in <a href="#sec-authenticator-data">§5.2.2 Authenticator data</a>, the authenticator data value of each processed extension is included in the
extended data part of the <code>authenticatorData</code>. This part is a CBOR map, with extension identifiers as keys, and the
authenticator data value of each extension as the value.</p>
   <h3 class="heading settled" data-level="7.6" id="sample-extensions"><span class="secno">7.6. </span><span class="content">Example extension</span><a class="self-link" href="#sample-extensions"></a></h3>
   <p><em>This section is not normative.</em></p>
   <p>To illustrate the requirements above, consider a hypothetical extension "Geo". This extension, if supported, lets both clients
and authenticators embed their geolocation in assertions.</p>
   <p>The extension identifier is chosen as <code>webauthnExample_geo</code>. The client argument is the constant value <code>true</code>, since the
extension does not require the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-23">Relying Party</a> to pass any particular information to the client, other than that it requests the use
of the extension. The Relying Party sets this value in its request for an assertion:</p>
<pre class="highlight">var assertionPromise =
    credentials.getAssertion("SGFuIFNvbG8gc2hvdCBmaXJzdC4",
        {}, /* Empty filter */
        { 'webauthnExample_geo': true });
</pre>
   <p>The extension defines the additional client data to be the client’s location, if known, as a GeoJSON <a data-link-type="biblio" href="#biblio-geojson">[GeoJSON]</a> point. The
client constructs the following client data:</p>
<pre class="highlight">{
    ...,
    'extensions': {
        'webauthnExample_geo': {
            'type': 'Point',
            'coordinates': [65.059962, -13.993041]
        }
    }
}
</pre>
   <p>The extension also requires the client to set the authenticator parameter to the fixed value <code>true</code>.</p>
   <p>Finally, the extension requires the authenticator to specify its geolocation in the authenticator data, if known. The extension
e.g. specifies that the location shall be encoded as a two-element array of floating point numbers, encoded with CBOR. An
authenticator does this by including it in the <code>authenticatorData</code>. As an example, authenticator data may be as follows
(notation taken from <a data-link-type="biblio" href="#biblio-rfc7049">[RFC7049]</a>):</p>
<pre class="highlight">81 (hex)                                    -- Flags, ED and TUP both set.
20 05 58 1F                                 -- Signature counter
A1                                          -- CBOR map of one element
    73                                      -- Key 1: CBOR text string of 19 bytes
        77 65 62 61 75 74 68 6E 45 78 61
        6D 70 6C 65 5F 67 65 6F             -- "webauthnExample_geo" UTF-8 string
    82                                      -- Value 1: CBOR array of two elements
        FA 42 82 1E B3                      -- Element 1: Latitude as CBOR encoded float
        FA C1 5F E3 7F                      -- Element 2: Longitude as CBOR encoded float
</pre>
   <h2 class="heading settled" data-level="8" id="extension-predef"><span class="secno">8. </span><span class="content">Pre-defined extensions</span><a class="self-link" href="#extension-predef"></a></h2>
   <p>This section defines an initial set of extensions. These are recommended for implementation by user agents targeting broad
interoperability.</p>
   <h3 class="heading settled" data-level="8.1" id="extension-txauth"><span class="secno">8.1. </span><span class="content">Transaction authorization</span><a class="self-link" href="#extension-txauth"></a></h3>
   <p>This authentication extension allows for a simple form of transaction authorization. A Relying Party can specify a prompt string,
intended for display on a trusted device on the authenticator.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_txAuthSimple</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A single UTF-8 encoded string prompt.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The client argument encoded as a CBOR text string (major type 3).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The authenticator MUST display the prompt to the user before performing the user verification / test of user presence. The
authenticator may insert line breaks if needed.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>A single UTF-8 string, representing the prompt as displayed (including any eventual line breaks).</p>
   </dl>
   <p>The generic version of this extension allows images to be used as prompts as well.  This allows authenticators without a font
rendering engine to be used and also supports a richer visual appearance.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_txAuthGeneric</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A CBOR map with one pair of data items (CBOR tagged as 0xa1). The pair of data items consists of</p>
     <ol>
      <li data-md="">
       <p>one UTF-8 encoded string <dfn data-dfn-type="dfn" data-noexport="" id="contenttype">contentType<a class="self-link" href="#contenttype"></a></dfn>, containing the MIME-Type of the content, e.g. "image/png"</p>
      <li data-md="">
       <p>and the <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="content">content</dfn> itself, encoded as CBOR byte array.</p>
     </ol>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The client argument encoded as a CBOR map.</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The authenticator MUST display the <a data-link-type="dfn" href="#content" id="ref-for-content-1">content</a> to the user before performing the user verification / test of user
presence. The authenticator may add other information below the <a data-link-type="dfn" href="#content" id="ref-for-content-2">content</a>. No changes are allowed to the <a data-link-type="dfn" href="#content" id="ref-for-content-3">content</a> itself, i.e., inside <a data-link-type="dfn" href="#content" id="ref-for-content-4">content</a> boundary box.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The hash value of the <a data-link-type="dfn" href="#content" id="ref-for-content-5">content</a> which was displayed. The authenticator MUST use the same hash algorithm as it uses for
the signature itself.</p>
   </dl>
   <h3 class="heading settled" data-level="8.2" id="extension-authenticator-selection"><span class="secno">8.2. </span><span class="content">Authenticator Selection Extension</span><a class="self-link" href="#extension-authenticator-selection"></a></h3>
   <p>This registration extension allows a Relying Party to guide the selection of the authenticator that will be leveraged when creating the
credential. It is intended primarily for Relying Parties that wish to tightly control the experience around credential creation.</p>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_authnSel</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>A sequence of AAGUIDs:</p>
<pre class="idl highlight def"><span class="kt">typedef</span> <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#typedefdef-aaguid" id="ref-for-typedefdef-aaguid-1">AAGUID</a> > <dfn class="nv dfn-paneled idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-authenticatorselectionlist">AuthenticatorSelectionList</dfn>;
</pre>
     <p>Each AAGUID corresponds to an authenticator model that is acceptable to the Relying Party for this credential creation. The
list is ordered by decreasing preference.</p>
     <p>An AAGUID is defined as an array containing the globally unique identifier of the authenticator model being sought.</p>
<pre class="idl highlight def"><span class="kt">typedef</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a> <dfn class="nv dfn-paneled idl-code" data-dfn-type="typedef" data-export="" id="typedefdef-aaguid">AAGUID</dfn>;
</pre>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>This extension can only be used during <code class="idl"><a data-link-type="idl" href="#dom-webauthentication-makecredential" id="ref-for-dom-webauthentication-makecredential-10">makeCredential()</a></code>. If the client supports the Authenticator Selection Extension, it
MUST use the first available authenticator whose AAGUID is present in the <dfn data-dfn-type="dfn" data-noexport="" id="authenticatorselectionlist">AuthenticatorSelectionList<a class="self-link" href="#authenticatorselectionlist"></a></dfn>. If none of
the available authenticators match a provided AAGUID, the client MUST select an authenticator from among the available
authenticators to generate the credential. If an authenticator was selected from <code class="idl"><a data-link-type="idl" href="#typedefdef-authenticatorselectionlist" id="ref-for-typedefdef-authenticatorselectionlist-1">AuthenticatorSelectionList</a></code>, its
AAGUID MUST be added by the client to the ClientData as the client data value for this extension.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>There is no authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>None.</p>
   </dl>
   <h3 class="heading settled" data-level="8.3" id="supported-extensions-extension"><span class="secno">8.3. </span><span class="content">SupportedExtensions Extension</span><a class="self-link" href="#supported-extensions-extension"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_exts</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code> to indicate that this extension is requested by the Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-27">authenticator</a> augments the authenticator data with a list of extensions that the authenticator supports, as
defined below. This extension can be added to attestation statements.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The SupportedExtensions extension is a list (CBOR array) of extension identifiers encoded as UTF-8 Strings.</p>
   </dl>
   <h3 class="heading settled" data-level="8.4" id="uvi-extension"><span class="secno">8.4. </span><span class="content">User Verification Index (UVI) Extension</span><a class="self-link" href="#uvi-extension"></a></h3>
   <dl>
    <dt data-md="">
     <p>Extension identifier</p>
    <dd data-md="">
     <p><code>webauthn_uvi</code></p>
    <dt data-md="">
     <p>Client argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code> to indicate that this extension is requested by the Relying Party.</p>
    <dt data-md="">
     <p>Client processing</p>
    <dd data-md="">
     <p>None, except default forwarding of client argument to authenticator argument.</p>
    <dt data-md="">
     <p>Authenticator argument</p>
    <dd data-md="">
     <p>The Boolean value <code>true</code>, encoded in CBOR (major type 7, value 21).</p>
    <dt data-md="">
     <p>Authenticator processing</p>
    <dd data-md="">
     <p>The <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-28">authenticator</a> augments the authenticator data with a user verification index indicating the method used by the
user to authorize the operation, as defined below. This extension can be added to attestation statements and assertions.</p>
    <dt data-md="">
     <p>Authenticator data</p>
    <dd data-md="">
     <p>The user verification index (UVI) is a value uniquely identifying a user verification data record. The UVI is encoded as CBOR
byte string (type 0x58). Each UVI value MUST be specific to the related key (in order to provide unlinkability). It also
must contain sufficient entropy that makes guessing impractical. UVI values MUST NOT be reused by the Authenticator (for
other biometric data or users).</p>
     <p>The UVI data can be used by servers to understand whether an authentication was authorized by the exact same biometric data
as the initial key generation. This allows the detection and prevention of "friendly fraud".</p>
     <p>As an example, the UVI could be computed as SHA256(KeyID | SHA256(rawUVI)), where the rawUVI reflects (a) the biometric
reference data, (b) the related OS level user ID and (c) an identifier which changes whenever a factory reset is performed
for the device, e.g. rawUVI = biometricReferenceData | OSLevelUserID | FactoryResetCounter.</p>
     <p>Servers supporting UVI extensions MUST support a length of up to 32 bytes for the UVI value.</p>
     <p>Example for rawData containing one UVI extension</p>
<pre class="highlight">F1 D0                                       -- This is a WebAuthn packed rawData object
81                                          -- TUP and ED set
00 00 00 01                                 -- (initial) signature counter
...                                         -- all public key alg etc.
A1                                          -- extension: CBOR map of one element
    6C                                      -- Key 1: CBOR text string of 11 bytes
        77 65 62 61 75 74 68 6E 5F 75 76 69 -- "webauthn_uvi" UTF-8 string
    58 20                                   -- Value 1: CBOR byte string with 0x20 bytes
        00 43 B8 E3 BE 27 95 8C             -- the UVI value itself
        28 D5 74 BF 46 8A 85 CF
        46 9A 14 F0 E5 16 69 31
        DA 4B CF FF C1 BB 11 32
        82
</pre>
   </dl>
   <h2 class="heading settled" data-level="9" id="iana-considerations"><span class="secno">9. </span><span class="content">IANA Considerations</span><a class="self-link" href="#iana-considerations"></a></h2>
   <p>This specification registers the algorithm names "S256", "S384", "S512", and "SM3" with the IANA JSON Web Algorithms registry as
defined in section "Cryptographic Algorithms for Digital Signatures and MACs" in <a data-link-type="biblio" href="#biblio-rfc7518">[RFC7518]</a>.</p>
   <p>These names follow the naming strategy in <a href="https://tools.ietf.org/html/draft-ietf-oauth-spop-15"> draft-ietf-oauth-spop-15</a>.</p>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S256"
     <tr>
      <td>Algorithm Description
      <td>The SHA256 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional+
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S384"
     <tr>
      <td>Algorithm Description
      <td>The SHA384 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"S512"
     <tr>
      <td>Algorithm Description
      <td>The SHA512 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional+
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-fips-180-4">[FIPS-180-4]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td><a data-link-type="biblio" href="#biblio-sp800-107r1">[SP800-107r1]</a>
   </table>
   <table class="def">
    <tbody>
     <tr>
      <td>Algorithm Name
      <td>"SM3"
     <tr>
      <td>Algorithm Description
      <td>The SM3 hash algorithm.
     <tr>
      <td>Algorithm Usage Location(s)
      <td>"alg", i.e., used with JWS.
     <tr>
      <td>JOSE Implementation Requirements
      <td>Optional
     <tr>
      <td>Change Controller
      <td><a href="https://fidoalliance.org/contact/">FIDO Alliance</a>
     <tr>
      <td>Specification Documents
      <td><a data-link-type="biblio" href="#biblio-oscca-sm3">[OSCCA-SM3]</a> 
     <tr>
      <td>Algorithm Analysis Document(s)
      <td>N/A
   </table>
   <h2 class="heading settled" data-level="10" id="sample-scenarios"><span class="secno">10. </span><span class="content">Sample scenarios</span><a class="self-link" href="#sample-scenarios"></a></h2>
   <p><em>This section is not normative.</em></p>
   <p>In this section, we walk through some events in the lifecycle of a scoped credential, along with the corresponding sample code
for using this API. Note that this is an example flow, and does not limit the scope of how the API can be used.</p>
   <p>As was the case in earlier sections, this flow focuses on a use case involving an external first-factor <a data-link-type="dfn" href="#authenticator" id="ref-for-authenticator-29">authenticator</a> with its own display. One example of such an authenticator would be a smart phone. Other authenticator types are also supported
by this API, subject to implementation by the platform. For instance, this flow also works without modification for the case of
an authenticator that is embedded in the client platform. The flow also works for the case of an authenticator without
its own display (similar to a smart card) subject to specific implementation considerations. Specifically, the client platform
needs to display any prompts that would otherwise be shown by the authenticator, and the authenticator needs to allow the client
platform to enumerate all the authenticator’s credentials so that the client can have information to show appropriate prompts.</p>
   <h3 class="heading settled" data-level="10.1" id="sample-registration"><span class="secno">10.1. </span><span class="content">Registration</span><a class="self-link" href="#sample-registration"></a></h3>
   <p>This is the first time flow, when a new credential is created and registered with the server.</p>
   <ol>
    <li data-md="">
     <p>The user visits example.com, which serves up a script. At this point, the user must already be logged in using a legacy
username and password, or additional authenticator, or other means acceptable to the Relying Party.</p>
    <li data-md="">
     <p>The Relying Party script runs the code snippet below.</p>
    <li data-md="">
     <p>The client platform searches for and locates the authenticator.</p>
    <li data-md="">
     <p>The client platform connects to the authenticator, performing any pairing actions if necessary.</p>
    <li data-md="">
     <p>The authenticator shows appropriate UI for the user to select the authenticator on which the new credential will be
created, and obtains a biometric or other authorization gesture from the user.</p>
    <li data-md="">
     <p>The authenticator returns a response to the client platform, which in turn returns a response to the Relying Party script. If
the user declined to select an authenticator or provide authorization, an appropriate error is returned.</p>
    <li data-md="">
     <p>If a new credential was created,</p>
     <ul>
      <li data-md="">
       <p>The Relying Party script sends the newly generated public key to the server, along with additional information about public key
such as attestation that it is held in trusted hardware.</p>
      <li data-md="">
       <p>The server stores the public key in its database and associates it with the user as well as with the strength of
authentication indicated by attestation, also storing a friendly name for later use.</p>
      <li data-md="">
       <p>The script may store data such as the credential ID in local storage, to improve future UX by narrowing the choice of
credential for the user.</p>
     </ul>
   </ol>
   <p>The sample code for generating and registering a new key follows:</p>
<pre class="example highlight" id="example-e4bb31ae"><a class="self-link" href="#example-e4bb31ae"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var userAccountInformation = {
    rpDisplayName: "Acme",
    displayName: "John P. Smith",
    name: "johnpsmith@example.com",
    id: "1098237235409872",
    imageURL: "https://pics.acme.com/00/p/aBjjjpqPb.png"
};

// This Relying Party will accept either an ES256 or RS256 credential, but
// prefers an ES256 credential.
var cryptoParams = [
    {
        type: "ScopedCred",
        algorithm: "ES256"
    },
    {
        type: "ScopedCred",
        algorithm: "RS256"
    }
];
var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var options = { timeoutSeconds: 300,  // 5 minutes
                excludeList: [],      // No excludeList
                extensions: {"webauthn.location": true}  // Include location information
                                               // in attestation
};

// Note: The following call will cause the authenticator to display UI.
webauthnAPI.makeCredential(userAccountInformation, cryptoParams, challenge, options)
    .then(function (newCredentialInfo) {
    // Send new credential info to server for verification and registration.
}).catch(function (err) {
    // No acceptable authenticator or user refused consent. Handle appropriately.
});
</pre>
   <h3 class="heading settled" data-level="10.2" id="sample-authentication"><span class="secno">10.2. </span><span class="content">Authentication</span><a class="self-link" href="#sample-authentication"></a></h3>
   <p>This is the flow when a user with an already registered credential visits a website and wants to authenticate using the
credential.</p>
   <ol>
    <li data-md="">
     <p>The user visits example.com, which serves up a script.</p>
    <li data-md="">
     <p>The script asks the client platform for a WebAuthn identity assertion, providing as much information as possible to narrow
the choice of acceptable credentials for the user. This may be obtained from the data that was stored locally after
registration, or by other means such as prompting the user for a username.</p>
    <li data-md="">
     <p>The <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-24">Relying Party</a> script runs one of the code snippets below.</p>
    <li data-md="">
     <p>The client platform searches for and locates the authenticator.</p>
    <li data-md="">
     <p>The client platform connects to the authenticator, performing any pairing actions if necessary.</p>
    <li data-md="">
     <p>The authenticator presents the user with a notification that their attention is required. On opening the
notification, the user is shown a friendly selection menu of acceptable credentials using the account information provided
when creating the credentials, along with some information on the origin that is requesting these keys.</p>
    <li data-md="">
     <p>The authenticator obtains a biometric or other authorization gesture from the user.</p>
    <li data-md="">
     <p>The authenticator returns a response to the client platform, which in turn returns a response to the Relying Party script.
If the user declined to select a credential or provide an authorization, an appropriate error is returned.</p>
    <li data-md="">
     <p>If an assertion was successfully generated and returned,</p>
     <ul>
      <li data-md="">
       <p>The script sends the assertion to the server.</p>
      <li data-md="">
       <p>The server examines the assertion and validates that it was correctly generated. If so, it looks up the identity
associated with the associated public key; that identity is now authenticated. If the public key is not recognized by
the server (e.g., deregistered by server due to inactivity) then the authentication has failed; each Relying Party will handle
this in its own way.</p>
      <li data-md="">
       <p>The server now does whatever it would otherwise do upon successful authentication -- return a success page, set
authentication cookies, etc.</p>
     </ul>
   </ol>
   <p>If the Relying Party script does not have any hints available (e.g., from locally stored data) to help it narrow the list of credentials,
then the sample code for performing such an authentication might look like this:</p>
<pre class="example highlight" id="example-48d2825e"><a class="self-link" href="#example-48d2825e"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var options = {
                timeoutSeconds = 300,  // 5 minutes
                allowList: [{ type: "ScopedCred" }]
              };

webauthnAPI.getAssertion(challenge, options)
    .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
   <p>On the other hand, if the Relying Party script has some hints to help it narrow the list of credentials, then the sample code for
performing such an authentication might look like the following. Note that this sample also demonstrates how to use the
extension for transaction authorization.</p>
<pre class="example highlight" id="example-8c7b010e"><a class="self-link" href="#example-8c7b010e"></a>var webauthnAPI = navigator.authentication;

if (!webauthnAPI) { /* Platform not capable. Handle error. */ }

var challenge = "Y2xpbWIgYSBtb3VudGFpbg";
var acceptableCredential1 = {
    type: "ScopedCred",
    id: "ISEhISEhIWhpIHRoZXJlISEhISEhIQo="
};
var acceptableCredential2 = {
    type: "ScopedCred",
    id: "cm9zZXMgYXJlIHJlZCwgdmlvbGV0cyBhcmUgYmx1ZQo="
};
    
var options = {
                timeoutSeconds: 300,  // 5 minutes
                allowList: [acceptableCredential1, acceptableCredential2];
                extensions: { 'webauthn.txauth.simple':
                   "Wave your hands in the air like you just don’t care" };
              };

webauthnAPI.getAssertion(challenge, options)
    .then(function (assertion) {
    // Send assertion to server for verification
}).catch(function (err) {
    // No acceptable credential or user refused consent. Handle appropriately.
});
</pre>
   <h3 class="heading settled" data-level="10.3" id="sample-decommissioning"><span class="secno">10.3. </span><span class="content">Decommissioning</span><a class="self-link" href="#sample-decommissioning"></a></h3>
   <p>The following are possible situations in which decommissioning a credential might be desired. Note that all of these are
handled on the server side and do not need support from the API specified here.</p>
   <ul>
    <li data-md="">
     <p>Possibility #1 -- user reports the credential as lost.</p>
     <ul>
      <li data-md="">
       <p>User goes to server.example.net, authenticates and follows a link to report a lost/stolen device.</p>
      <li data-md="">
       <p>Server returns a page showing the list of registered credentials with friendly names as configured during registration.</p>
      <li data-md="">
       <p>User selects a credential and the server deletes it from its database.</p>
      <li data-md="">
       <p>In future, the <a data-link-type="dfn" href="#relying-party" id="ref-for-relying-party-25">Relying Party</a> script does not specify this credential in any list of acceptable credentials, and assertions
signed by this credential are rejected.</p>
     </ul>
    <li data-md="">
     <p>Possibility #2 -- server deregisters the credential due to inactivity.</p>
     <ul>
      <li data-md="">
       <p>Server deletes credential from its database during maintenance activity.</p>
      <li data-md="">
       <p>In the future, the Relying Party script does not specify this credential in any list of acceptable credentials, and assertions
signed by this credential are rejected.</p>
     </ul>
    <li data-md="">
     <p>Possibility #3 -- user deletes the credential from the device.</p>
     <ul>
      <li data-md="">
       <p>User employs a device-specific method (e.g., device settings UI) to delete a credential from their device.</p>
      <li data-md="">
       <p>From this point on, this credential will not appear in any selection prompts, and no assertions can be generated with it.</p>
      <li data-md="">
       <p>Sometime later, the server deregisters this credential due to inactivity.</p>
     </ul>
   </ul>
   <h2 class="heading settled" data-level="11" id="acknowledgements"><span class="secno">11. </span><span class="content">Acknowledgements</span><a class="self-link" href="#acknowledgements"></a></h2>
    We thank the following for their contributions to, and thorough review of, this specification: Jing Jin, Giridhar Mandyam. 
  </main>
<script src="https://www.w3.org/scripts/TR/2016/fixup.js"></script>
  <h2 class="no-num no-ref heading settled" id="index"><span class="content">Index</span><a class="self-link" href="#index"></a></h2>
  <h3 class="no-num no-ref heading settled" id="index-defined-here"><span class="content">Terms defined by this specification</span><a class="self-link" href="#index-defined-here"></a></h3>
  <ul class="index">
   <li><a href="#typedefdef-aaguid">AAGUID</a><span>, in §8.2</span>
   <li><a href="#dictdef-account">Account</a><span>, in §4.3</span>
   <li><a href="#accountinformation">accountInformation</a><span>, in §4.1.1</span>
   <li>
    alg
    <ul>
     <li><a href="#dom-attestationstatement-alg">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-alg">dfn for AttestationStatement</a><span>, in §6.1</span>
    </ul>
   <li>
    algorithm
    <ul>
     <li><a href="#dom-scopedcredentialparameters-algorithm">dict-member for ScopedCredentialParameters</a><span>, in §4</span>
     <li><a href="#scopedcredentialparameters-algorithm">dfn for ScopedCredentialParameters</a><span>, in §4.4</span>
    </ul>
   <li><a href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a><span>, in §2.1</span>
   <li>
    allowList
    <ul>
     <li><a href="#dom-assertionoptions-allowlist">dict-member for AssertionOptions</a><span>, in §4</span>
     <li><a href="#assertionoptions-allowlist">dfn for AssertionOptions</a><span>, in §4.7</span>
    </ul>
   <li><a href="#androidattestation">AndroidAttestation</a><span>, in §6.3</span>
   <li><a href="#dictdef-androidattestationclientdata">AndroidAttestationClientData</a><span>, in §6.3.1</span>
   <li><a href="#assertion">Assertion</a><span>, in §3</span>
   <li><a href="#assertionchallenge">assertionChallenge</a><span>, in §4.1.2</span>
   <li><a href="#dictdef-assertionoptions">AssertionOptions</a><span>, in §4.7</span>
   <li>
    attestation
    <ul>
     <li><a href="#dom-scopedcredentialinfo-attestation">attribute for ScopedCredentialInfo</a><span>, in §4</span>
     <li><a href="#scopedcredentialinfo-attestation">dfn for ScopedCredentialInfo</a><span>, in §4.2</span>
    </ul>
   <li><a href="#attestation-certificate">Attestation Certificate</a><span>, in §3</span>
   <li><a href="#attestationchallenge">attestationChallenge</a><span>, in §4.1.1</span>
   <li><a href="#attestationstatement">AttestationStatement</a><span>, in §6.1</span>
   <li><a href="#authentication">Authentication</a><span>, in §3</span>
   <li><a href="#dom-navigator-authentication">authentication</a><span>, in §4</span>
   <li><a href="#authenticator">Authenticator</a><span>, in §3</span>
   <li><a href="#authenticator-argument">authenticator argument</a><span>, in §7.3</span>
   <li><a href="#authenticatorcancel">authenticatorCancel</a><span>, in §5.1.3</span>
   <li>
    authenticatorData
    <ul>
     <li><a href="#dom-webauthnassertion-authenticatordata">attribute for WebAuthnAssertion</a><span>, in §4</span>
     <li><a href="#authenticatordata">definition of</a><span>, in §5.2.2</span>
    </ul>
   <li><a href="#authenticatorgetassertion">authenticatorGetAssertion</a><span>, in §5.1.2</span>
   <li><a href="#authenticatormakecredential">authenticatorMakeCredential</a><span>, in §5.1.1</span>
   <li>
    AuthenticatorSelectionList
    <ul>
     <li><a href="#typedefdef-authenticatorselectionlist">(typedef)</a><span>, in §8.2</span>
     <li><a href="#authenticatorselectionlist">definition of</a><span>, in §8.2</span>
    </ul>
   <li><a href="#authorization-gesture">Authorization Gesture</a><span>, in §3</span>
   <li><a href="#base64url-encoding">Base64url Encoding</a><span>, in §2.1</span>
   <li><a href="#ceremony">Ceremony</a><span>, in §3</span>
   <li>
    challenge
    <ul>
     <li><a href="#dom-clientdata-challenge">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-challenge">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li>
    claimedAAGUID
    <ul>
     <li><a href="#dom-attestationstatement-claimedaaguid">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-claimedaaguid">dfn for AttestationStatement</a><span>, in §6.1</span>
    </ul>
   <li><a href="#client">Client</a><span>, in §3</span>
   <li><a href="#client-argument">client argument</a><span>, in §7.3</span>
   <li>
    clientData
    <ul>
     <li><a href="#dom-webauthnassertion-clientdata">attribute for WebAuthnAssertion</a><span>, in §4</span>
     <li><a href="#dom-webauthnattestation-clientdata">attribute for WebAuthnAttestation</a><span>, in §4</span>
     <li><a href="#webauthnassertion-clientdata">dfn for WebAuthnAssertion</a><span>, in §4.6</span>
     <li><a href="#webauthnattestation-clientdata">dfn for WebAuthnAttestation</a><span>, in §4.9</span>
    </ul>
   <li><a href="#dictdef-clientdata">ClientData</a><span>, in §5.2.1</span>
   <li><a href="#clientdatahash">clientDataHash</a><span>, in §5.2.3</span>
   <li><a href="#clientdatajson">clientDataJSON</a><span>, in §5.2.3</span>
   <li><a href="#conforming-user-agent">Conforming User Agent</a><span>, in §3</span>
   <li><a href="#content">content</a><span>, in §8.1</span>
   <li><a href="#contenttype">contentType</a><span>, in §8.1</span>
   <li><a href="#credential">Credential</a><span>, in §4.10.2</span>
   <li>
    credential
    <ul>
     <li><a href="#dom-scopedcredentialinfo-credential">attribute for ScopedCredentialInfo</a><span>, in §4</span>
     <li><a href="#dom-webauthnassertion-credential">attribute for WebAuthnAssertion</a><span>, in §4</span>
     <li><a href="#scopedcredentialinfo-credential">dfn for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#webauthnassertion-credential">dfn for WebAuthnAssertion</a><span>, in §4.6</span>
    </ul>
   <li><a href="#dictdef-credentialdescription">CredentialDescription</a><span>, in §4.10.3</span>
   <li><a href="#dictdef-credentialoptions">CredentialOptions</a><span>, in §4.5</span>
   <li><a href="#enumdef-credentialtype">CredentialType</a><span>, in §4.10.1</span>
   <li><a href="#dictdef-cryptokey">CryptoKey</a><span>, in §2.1</span>
   <li><a href="#cryptoparameters">cryptoParameters</a><span>, in §4.1.1</span>
   <li>
    displayName
    <ul>
     <li><a href="#dom-account-displayname">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-displayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#domexception">DOMException</a><span>, in §2.1</span>
   <li><a href="#etld1">eTLD+1</a><span>, in §3</span>
   <li>
    excludeList
    <ul>
     <li><a href="#dom-credentialoptions-excludelist">dict-member for CredentialOptions</a><span>, in §4</span>
     <li><a href="#credentialoptions-excludelist">dfn for CredentialOptions</a><span>, in §4.5</span>
    </ul>
   <li>
    extensions
    <ul>
     <li><a href="#dom-credentialoptions-extensions">dict-member for CredentialOptions</a><span>, in §4</span>
     <li><a href="#dom-assertionoptions-extensions">dict-member for AssertionOptions</a><span>, in §4</span>
     <li><a href="#credentialoptions-extensions">dfn for CredentialOptions</a><span>, in §4.5</span>
     <li><a href="#assertionoptions-extensions">dfn for AssertionOptions</a><span>, in §4.7</span>
     <li><a href="#dom-clientdata-extensions">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-extensions">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li>
    facet
    <ul>
     <li><a href="#dom-clientdata-facet">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-facet">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li><a href="#dom-webauthentication-getassertion">getAssertion(assertionChallenge)</a><span>, in §4.1.2</span>
   <li><a href="#dom-webauthentication-getassertion">getAssertion(assertionChallenge, options)</a><span>, in §4.1.2</span>
   <li>
    hashAlg
    <ul>
     <li><a href="#dom-clientdata-hashalg">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-hashalg">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li>
    id
    <ul>
     <li><a href="#dom-account-id">dict-member for Account</a><span>, in §4</span>
     <li><a href="#dom-credential-id">attribute for Credential</a><span>, in §4</span>
     <li><a href="#dom-credentialdescription-id">dict-member for CredentialDescription</a><span>, in §4</span>
     <li><a href="#account-id">dfn for Account</a><span>, in §4.3</span>
     <li><a href="#credential-id">dfn for Credential</a><span>, in §4.10.2</span>
     <li><a href="#credentialdescription-id">dfn for CredentialDescription</a><span>, in §4.10.3</span>
    </ul>
   <li>
    imageURL
    <ul>
     <li><a href="#dom-account-imageurl">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-imageurl">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li>
    isInsideSecureHardware
    <ul>
     <li><a href="#dom-androidattestationclientdata-isinsidesecurehardware">dict-member for AndroidAttestationClientData</a><span>, in §6.3.1</span>
     <li><a href="#androidattestationclientdata-isinsidesecurehardware">dfn for AndroidAttestationClientData</a><span>, in §6.3.1</span>
    </ul>
   <li><a href="#dictdef-jsonwebkey">JsonWebKey</a><span>, in §2.1</span>
   <li><a href="#dom-webauthentication-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge)</a><span>, in §4.1.1</span>
   <li><a href="#dom-webauthentication-makecredential">makeCredential(accountInformation, cryptoParameters, attestationChallenge, options)</a><span>, in §4.1.1</span>
   <li>
    name
    <ul>
     <li><a href="#dom-account-name">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-name">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li><a href="#navigator-dfn-interface-are-defined-in-html5">Navigator/dfn> interface are defined in [HTML5].</a><span>, in §2.1</span>
   <li>
    options
    <ul>
     <li><a href="#makecredential-options">dfn for makeCredential()</a><span>, in §4.1.1</span>
     <li><a href="#getassertion-options">dfn for getAssertion()</a><span>, in §4.1.2</span>
    </ul>
   <li><a href="#origin">origin</a><span>, in §2.1</span>
   <li><a href="#promises">Promises</a><span>, in §2.1</span>
   <li>
    publicKey
    <ul>
     <li><a href="#dom-scopedcredentialinfo-publickey">attribute for ScopedCredentialInfo</a><span>, in §4</span>
     <li><a href="#scopedcredentialinfo-publickey">dfn for ScopedCredentialInfo</a><span>, in §4.2</span>
     <li><a href="#dom-androidattestationclientdata-publickey">dict-member for AndroidAttestationClientData</a><span>, in §6.3.1</span>
     <li><a href="#androidattestationclientdata-publickey">dfn for AndroidAttestationClientData</a><span>, in §6.3.1</span>
    </ul>
   <li>
    rawData
    <ul>
     <li><a href="#dom-attestationstatement-rawdata">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-rawdata">dfn for AttestationStatement</a><span>, in §6.1</span>
    </ul>
   <li><a href="#registration">Registration</a><span>, in §3</span>
   <li><a href="#relying-party">Relying Party</a><span>, in §3</span>
   <li><a href="#relying-party-identifier">Relying Party Identifier</a><span>, in §3</span>
   <li>
    rpDisplayName
    <ul>
     <li><a href="#dom-account-rpdisplayname">dict-member for Account</a><span>, in §4</span>
     <li><a href="#account-rpdisplayname">dfn for Account</a><span>, in §4.3</span>
    </ul>
   <li>
    rpId
    <ul>
     <li><a href="#dom-clientdata-rpid">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-rpid">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li><a href="#rp-id">RP ID</a><span>, in §3</span>
   <li>
    safetyNetResponse
    <ul>
     <li><a href="#dom-androidattestation-safetynetresponse">attribute for AndroidAttestation</a><span>, in §6.3</span>
     <li><a href="#androidattestation-safetynetresponse">dfn for AndroidAttestation</a><span>, in §6.3</span>
    </ul>
   <li>
    ScopedCred
    <ul>
     <li><a href="#dom-credentialtype-scopedcred">enum-value for CredentialType</a><span>, in §4</span>
     <li><a href="#credentialtype-scopedcred">dfn for CredentialType</a><span>, in §4.10.1</span>
    </ul>
   <li><a href="#dom-credentialtype-scopedcred">"ScopedCred"</a><span>, in §4</span>
   <li><a href="#scoped-credential">Scoped Credential</a><span>, in §3</span>
   <li><a href="#scopedcredentialinfo">ScopedCredentialInfo</a><span>, in §4.2</span>
   <li><a href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a><span>, in §4.4</span>
   <li><a href="#secure-contexts">secure contexts</a><span>, in §4</span>
   <li>
    signature
    <ul>
     <li><a href="#dom-webauthnassertion-signature">attribute for WebAuthnAssertion</a><span>, in §4</span>
     <li><a href="#webauthnassertion-signature">dfn for WebAuthnAssertion</a><span>, in §4.6</span>
     <li><a href="#dom-attestationstatement-signature">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-signature">dfn for AttestationStatement</a><span>, in §6.1</span>
    </ul>
   <li>
    statement
    <ul>
     <li><a href="#dom-webauthnattestation-statement">attribute for WebAuthnAttestation</a><span>, in §4</span>
     <li><a href="#webauthnattestation-statement">dfn for WebAuthnAttestation</a><span>, in §4.9</span>
    </ul>
   <li>
    timeoutSeconds
    <ul>
     <li><a href="#dom-credentialoptions-timeoutseconds">dict-member for CredentialOptions</a><span>, in §4</span>
     <li><a href="#dom-assertionoptions-timeoutseconds">dict-member for AssertionOptions</a><span>, in §4</span>
     <li><a href="#credentialoptions-timeoutseconds">dfn for CredentialOptions</a><span>, in §4.5</span>
     <li><a href="#assertionoptions-timeoutseconds">dfn for AssertionOptions</a><span>, in §4.7</span>
    </ul>
   <li>
    tokenBinding
    <ul>
     <li><a href="#dom-clientdata-tokenbinding">dict-member for ClientData</a><span>, in §5.2.1</span>
     <li><a href="#clientdata-tokenbinding">dfn for ClientData</a><span>, in §5.2.1</span>
    </ul>
   <li>
    type
    <ul>
     <li><a href="#dom-scopedcredentialparameters-type">dict-member for ScopedCredentialParameters</a><span>, in §4</span>
     <li><a href="#dom-webauthnattestation-type">attribute for WebAuthnAttestation</a><span>, in §4</span>
     <li><a href="#dom-credential-type">attribute for Credential</a><span>, in §4</span>
     <li><a href="#dom-credentialdescription-type">dict-member for CredentialDescription</a><span>, in §4</span>
     <li><a href="#scopedcredentialparameters-type">dfn for ScopedCredentialParameters</a><span>, in §4.4</span>
     <li><a href="#webauthnattestation-type">dfn for WebAuthnAttestation</a><span>, in §4.9</span>
     <li><a href="#credential-type">dfn for Credential</a><span>, in §4.10.2</span>
     <li><a href="#credentialdescription-type">dfn for CredentialDescription</a><span>, in §4.10.3</span>
    </ul>
   <li>
    userAuthentication
    <ul>
     <li><a href="#dom-androidattestationclientdata-userauthentication">dict-member for AndroidAttestationClientData</a><span>, in §6.3.1</span>
     <li><a href="#androidattestationclientdata-userauthentication">dfn for AndroidAttestationClientData</a><span>, in §6.3.1</span>
    </ul>
   <li>
    userAuthenticationValidityDurationSeconds
    <ul>
     <li><a href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">dict-member for AndroidAttestationClientData</a><span>, in §6.3.1</span>
     <li><a href="#androidattestationclientdata-userauthenticationvaliditydurationseconds">dfn for AndroidAttestationClientData</a><span>, in §6.3.1</span>
    </ul>
   <li><a href="#user-consent">User Consent</a><span>, in §3</span>
   <li><a href="#user-verification">User Verification</a><span>, in §3</span>
   <li>
    version
    <ul>
     <li><a href="#dom-attestationstatement-version">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-version">dfn for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#dom-androidattestation-version">attribute for AndroidAttestation</a><span>, in §6.3</span>
     <li><a href="#androidattestation-version">dfn for AndroidAttestation</a><span>, in §6.3</span>
    </ul>
   <li><a href="#webauthentication">WebAuthentication</a><span>, in §4.1</span>
   <li><a href="#web-authentication-api">Web Authentication API</a><span>, in §4</span>
   <li><a href="#webauthn-assertion">WebAuthn Assertion</a><span>, in §3</span>
   <li><a href="#webauthnassertion">WebAuthnAssertion</a><span>, in §4.6</span>
   <li><a href="#webauthnattestation">WebAuthnAttestation</a><span>, in §4.9</span>
   <li><a href="#webauthn-client">WebAuthn Client</a><span>, in §3</span>
   <li><a href="#dictdef-webauthnextensions">WebAuthnExtensions</a><span>, in §4.8</span>
   <li>
    x5c
    <ul>
     <li><a href="#dom-attestationstatement-x5c">attribute for AttestationStatement</a><span>, in §6.1</span>
     <li><a href="#attestationstatement-x5c">dfn for AttestationStatement</a><span>, in §6.1</span>
    </ul>
  </ul>
  <h3 class="no-num no-ref heading settled" id="index-defined-elsewhere"><span class="content">Terms defined by reference</span><a class="self-link" href="#index-defined-elsewhere"></a></h3>
  <ul class="index">
   <li>
    <a data-link-type="biblio">[HTML]</a> defines the following terms:
    <ul>
     <li><a href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a>
    </ul>
   <li>
    <a data-link-type="biblio">[WebIDL-1]</a> defines the following terms:
    <ul>
     <li><a href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>
    </ul>
  </ul>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-dom4">[DOM4]
   <dd>Anne van Kesteren. <a href="https://dom.spec.whatwg.org/">DOM Standard</a>. Living Standard. URL: <a href="https://dom.spec.whatwg.org/">https://dom.spec.whatwg.org/</a>
   <dt id="biblio-fidoecdaaalgorithm">[FIDOEcdaaAlgorithm]
   <dd>R. Lindemann; A. Edgington; R. Urian. FIDO ECDAA Algorithm. FIDO Alliance Proposed Standard (To Be Published). 
   <dt id="biblio-fips-180-4">[FIPS-180-4]
   <dd><a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">FIPS PUB 180-4 Secure Hash Standard</a>. URL: <a href="http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson. <a href="https://html.spec.whatwg.org/multipage/">HTML Standard</a>. Living Standard. URL: <a href="https://html.spec.whatwg.org/multipage/">https://html.spec.whatwg.org/multipage/</a>
   <dt id="biblio-html5">[HTML5]
   <dd>Ian Hickson; et al. <a href="https://www.w3.org/html/wg/drafts/html/master/">HTML5</a>. 28 October 2014. REC. URL: <a href="https://www.w3.org/html/wg/drafts/html/master/">https://www.w3.org/html/wg/drafts/html/master/</a>
   <dt id="biblio-oscca-sm3">[OSCCA-SM3]
   <dd><a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">SM3 Cryptographic Hash Algorithm</a>. December 2010. URL: <a href="http://www.oscca.gov.cn/UpFile/20101222141857786.pdf">http://www.oscca.gov.cn/UpFile/20101222141857786.pdf</a>
   <dt id="biblio-rfc2119">[RFC2119]
   <dd>S. Bradner. <a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>. March 1997. Best Current Practice. URL: <a href="https://tools.ietf.org/html/rfc2119">https://tools.ietf.org/html/rfc2119</a>
   <dt id="biblio-rfc4648">[RFC4648]
   <dd>S. Josefsson. <a href="https://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>. October 2006. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4648">https://tools.ietf.org/html/rfc4648</a>
   <dt id="biblio-rfc7515">[RFC7515]
   <dd>M. Jones; J. Bradley; N. Sakimura. <a href="https://tools.ietf.org/html/rfc7515">JSON Web Signature (JWS)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7515">https://tools.ietf.org/html/rfc7515</a>
   <dt id="biblio-rfc7518">[RFC7518]
   <dd>M. Jones. <a href="https://tools.ietf.org/html/rfc7518">JSON Web Algorithms (JWA)</a>. May 2015. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7518">https://tools.ietf.org/html/rfc7518</a>
   <dt id="biblio-sec1">[SEC1]
   <dd><a href="http://www.secg.org/sec1-v2.pdf">SEC1: Elliptic Curve Cryptography, Version 2.0</a>. URL: <a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>
   <dt id="biblio-webcryptoapi">[WebCryptoAPI]
   <dd>Ryan Sleevi; Mark Watson. <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html">Web Cryptography API</a>. 11 December 2014. CR. URL: <a href="https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html">https://dvcs.w3.org/hg/webcrypto-api/raw-file/tip/spec/Overview.html</a>
   <dt id="biblio-webidl-1">[WebIDL-1]
   <dd>Cameron McCormack; Boris Zbarsky. <a href="https://heycam.github.io/webidl/">WebIDL Level 1</a>. 8 March 2016. CR. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-ceremony">[Ceremony]
   <dd>Carl Ellison. <a href="https://eprint.iacr.org/2007/399.pdf">Ceremony Design and Analysis</a>. 2007. URL: <a href="https://eprint.iacr.org/2007/399.pdf">https://eprint.iacr.org/2007/399.pdf</a>
   <dt id="biblio-fidometadataservice">[FIDOMetadataService]
   <dd>R. Lindemann; B. Hill; D. Baghdasaryan. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">FIDO Metadata Service v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-metadata-service-v1.0-ps-20141208.html</a>
   <dt id="biblio-fidosecref">[FIDOSecRef]
   <dd>R. Lindemann; D. Baghdasaryan; B. Hill. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">FIDO Security Reference</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-security-ref-v1.0-ps-20141208.html</a>
   <dt id="biblio-geojson">[GeoJSON]
   <dd><a href="http://geojson.org/geojson-spec.html">The GeoJSON Format Specification</a>. URL: <a href="http://geojson.org/geojson-spec.html">http://geojson.org/geojson-spec.html</a>
   <dt id="biblio-psl">[PSL]
   <dd><cite><a href="https://publicsuffix.org/">Public Suffix List</a></cite>.    Mozilla Foundation.
   <dt id="biblio-rfc3447">[RFC3447]
   <dd>J. Jonsson; B. Kaliski. <a href="https://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>. February 2003. Informational. URL: <a href="https://tools.ietf.org/html/rfc3447">https://tools.ietf.org/html/rfc3447</a>
   <dt id="biblio-rfc4055">[RFC4055]
   <dd>J. Schaad; B. Kaliski; R. Housley. <a href="https://tools.ietf.org/html/rfc4055">Additional Algorithms and Identifiers for RSA Cryptography for use in the Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. June 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4055">https://tools.ietf.org/html/rfc4055</a>
   <dt id="biblio-rfc4122">[RFC4122]
   <dd>P. Leach; M. Mealling; R. Salz. <a href="https://tools.ietf.org/html/rfc4122">A Universally Unique IDentifier (UUID) URN Namespace</a>. July 2005. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc4122">https://tools.ietf.org/html/rfc4122</a>
   <dt id="biblio-rfc4949">[RFC4949]
   <dd>R. Shirey. <a href="https://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>. August 2007. Informational. URL: <a href="https://tools.ietf.org/html/rfc4949">https://tools.ietf.org/html/rfc4949</a>
   <dt id="biblio-rfc5280">[RFC5280]
   <dd>D. Cooper; et al. <a href="https://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>. May 2008. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc5280">https://tools.ietf.org/html/rfc5280</a>
   <dt id="biblio-rfc6454">[RFC6454]
   <dd>A. Barth. <a href="https://tools.ietf.org/html/rfc6454">The Web Origin Concept</a>. December 2011. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc6454">https://tools.ietf.org/html/rfc6454</a>
   <dt id="biblio-rfc7049">[RFC7049]
   <dd>C. Bormann; P. Hoffman. <a href="https://tools.ietf.org/html/rfc7049">Concise Binary Object Representation (CBOR)</a>. October 2013. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7049">https://tools.ietf.org/html/rfc7049</a>
   <dt id="biblio-rfc7159">[RFC7159]
   <dd>T. Bray, Ed.. <a href="https://tools.ietf.org/html/rfc7159">The JavaScript Object Notation (JSON) Data Interchange Format</a>. March 2014. Proposed Standard. URL: <a href="https://tools.ietf.org/html/rfc7159">https://tools.ietf.org/html/rfc7159</a>
   <dt id="biblio-rfc7719">[RFC7719]
   <dd>P. Hoffman; A. Sullivan; K. Fujiwara. <a href="https://tools.ietf.org/html/rfc7719">DNS Terminology</a>. December 2015. Informational. URL: <a href="https://tools.ietf.org/html/rfc7719">https://tools.ietf.org/html/rfc7719</a>
   <dt id="biblio-secure-contexts">[SECURE-CONTEXTS]
   <dd>Mike West. <a href="https://w3c.github.io/webappsec-secure-contexts/">Secure Contexts</a>. 26 April 2016. WD. URL: <a href="https://w3c.github.io/webappsec-secure-contexts/">https://w3c.github.io/webappsec-secure-contexts/</a>
   <dt id="biblio-sp800-107r1">[SP800-107r1]
   <dd>Quynh Dang. <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">NIST Special Publication 800-107: Recommendation for Applications Using Approved Hash Algorithms</a>. August 2012. URL: <a href="http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf">http://csrc.nist.gov/publications/nistpubs/800-107-rev1/sp800-107-rev1.pdf</a>
   <dt id="biblio-tpmv1-2-credential-profiles">[TPMv1-2-Credential-Profiles]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf">TCG Credential Profiles for TPM Family 1.2</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profiles_V1.2_Level2_Revision8.pdf</a>
   <dt id="biblio-tpmv1-2-part2">[TPMv1-2-Part2]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf">TPM Main Part 2: TPM Structures</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Main-Part-2-TPM-Structures_v1.2_rev116_01032011.pdf</a>
   <dt id="biblio-tpmv2-ek-profile">[TPMv2-EK-Profile]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf">TCG EK Credential Profile for TPM Family 2.0</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/Credential_Profile_EK_V2.0_R14_published.pdf</a>
   <dt id="biblio-tpmv2-part2">[TPMv2-Part2]
   <dd><a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-01.16-1.pdf">Trusted Platform Module Library, Part 2: Structures</a>. URL: <a href="http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-01.16-1.pdf">http://www.trustedcomputinggroup.org/wp-content/uploads/TPM-Rev-2.0-Part-2-Structures-01.16-1.pdf</a>
   <dt id="biblio-uafprotocol">[UAFProtocol]
   <dd>R. Lindemann; et al. <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">FIDO UAF Protocol Specification v1.0</a>. FIDO Alliance Proposed Standard. URL: <a href="https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html">https://fidoalliance.org/specs/fido-uaf-v1.0-ps-20141208/fido-uaf-protocol-v1.0-ps-20141208.html</a>
  </dl>
  <h2 class="no-num no-ref heading settled" id="idl-index"><span class="content">IDL Index</span><a class="self-link" href="#idl-index"></a></h2>
<pre class="idl def"><span class="kt">partial</span> <span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="https://html.spec.whatwg.org/multipage/webappapis.html#navigator">Navigator</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthentication">WebAuthentication</a> <a class="nv" data-readonly="" data-type="WebAuthentication" href="#dom-navigator-authentication">authentication</a>;
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthentication">WebAuthentication</a> {
    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#scopedcredentialinfo">ScopedCredentialInfo</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-makecredential">makeCredential</a> (
        <a class="n" data-link-type="idl-name" href="#dictdef-account">Account</a>                                 <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-accountinformation">accountInformation</a>,
        <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a> > <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-cryptoparameters">cryptoParameters</a>,
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>                            <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-attestationchallenge">attestationChallenge</a>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-credentialoptions">CredentialOptions</a>              <a class="nv" href="#dom-webauthentication-makecredential-accountinformation-cryptoparameters-attestationchallenge-options-options">options</a>
    );

    <span class="kt">Promise</span> &lt; <a class="n" data-link-type="idl-name" href="#webauthnassertion">WebAuthnAssertion</a> > <a class="nv idl-code" data-link-type="method" href="#dom-webauthentication-getassertion">getAssertion</a> (
        <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>               <a class="nv" href="#dom-webauthentication-getassertion-assertionchallenge-options-assertionchallenge">assertionChallenge</a>,
        <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#dictdef-assertionoptions">AssertionOptions</a>  <a class="nv" href="#dom-webauthentication-getassertion-assertionchallenge-options-options">options</a>
    );
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#scopedcredentialinfo">ScopedCredentialInfo</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#credential">Credential</a>           <a class="nv" data-readonly="" data-type="Credential" href="#dom-scopedcredentialinfo-credential">credential</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#dictdef-cryptokey">CryptoKey</a>            <a class="nv" data-readonly="" data-type="CryptoKey" href="#dom-scopedcredentialinfo-publickey">publicKey</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#webauthnattestation">WebAuthnAttestation</a>  <a class="nv" data-readonly="" data-type="WebAuthnAttestation" href="#dom-scopedcredentialinfo-attestation">attestation</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-account">Account</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span> <a class="nv" data-type="DOMString " href="#dom-account-rpdisplayname">rpDisplayName</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span> <a class="nv" data-type="DOMString " href="#dom-account-displayname">displayName</a>;
    <span class="kt">DOMString</span>          <a class="nv" data-type="DOMString          " href="#dom-account-name">name</a>;
    <span class="kt">DOMString</span>          <a class="nv" data-type="DOMString          " href="#dom-account-id">id</a>;
    <span class="kt">DOMString</span>          <a class="nv" data-type="DOMString          " href="#dom-account-imageurl">imageURL</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-scopedcredentialparameters">ScopedCredentialParameters</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype">CredentialType</a>        <a class="nv" data-type="CredentialType        " href="#dom-scopedcredentialparameters-type">type</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a>   <a class="nv" data-type="AlgorithmIdentifier   " href="#dom-scopedcredentialparameters-algorithm">algorithm</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-credentialoptions">CredentialOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                       <a class="nv" data-type="unsigned long                       " href="#dom-credentialoptions-timeoutseconds">timeoutSeconds</a>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-credentialdescription">CredentialDescription</a> >  <a class="nv" data-type="sequence < CredentialDescription >  " href="#dom-credentialoptions-excludelist">excludeList</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions">WebAuthnExtensions</a>                  <a class="nv" data-type="WebAuthnExtensions                  " href="#dom-credentialoptions-extensions">extensions</a>;
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthnassertion">WebAuthnAssertion</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#credential">Credential</a>  <a class="nv" data-readonly="" data-type="Credential" href="#dom-webauthnassertion-credential">credential</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-webauthnassertion-clientdata">clientData</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-webauthnassertion-authenticatordata">authenticatorData</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span> <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-webauthnassertion-signature">signature</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-assertionoptions">AssertionOptions</a> {
    <span class="kt">unsigned</span> <span class="kt">long</span>                      <a class="nv" data-type="unsigned long                      " href="#dom-assertionoptions-timeoutseconds">timeoutSeconds</a>;
    <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#dictdef-credentialdescription">CredentialDescription</a> > <a class="nv" data-type="sequence < CredentialDescription > " href="#dom-assertionoptions-allowlist">allowList</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions">WebAuthnExtensions</a>                 <a class="nv" data-type="WebAuthnExtensions                 " href="#dom-assertionoptions-extensions">extensions</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-webauthnextensions">WebAuthnExtensions</a> {
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#webauthnattestation">WebAuthnAttestation</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-webauthnattestation-type">type</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-webauthnattestation-clientdata">clientData</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">any</span>           <a class="nv" data-readonly="" data-type="any" href="#dom-webauthnattestation-statement">statement</a>;
};

<span class="kt">enum</span> <a class="nv idl-code" data-link-type="enum" href="#enumdef-credentialtype">CredentialType</a> {
    <a class="s" href="#dom-credentialtype-scopedcred">"ScopedCred"</a>
};

<span class="kt">interface</span> <a class="nv idl-code" data-link-type="interface" href="#credential">Credential</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype">CredentialType</a> <a class="nv" data-readonly="" data-type="CredentialType" href="#dom-credential-type">type</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>    <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-credential-id">id</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-credentialdescription">CredentialDescription</a> {
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#enumdef-credentialtype">CredentialType</a> <a class="nv" data-type="CredentialType " href="#dom-credentialdescription-type">type</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a>   <a class="nv" data-type="BufferSource   " href="#dom-credentialdescription-id">id</a>;
};

<span class="kt">dictionary</span> <a class="nv idl-code" data-link-type="dictionary" href="#dictdef-clientdata">ClientData</a> {
    <span class="kt">required</span> <span class="kt">DOMString</span>           <a class="nv" data-type="DOMString           " href="#dom-clientdata-challenge">challenge</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <a class="nv" data-type="DOMString           " href="#dom-clientdata-facet">facet</a>;
    <span class="kt">required</span> <span class="kt">DOMString</span>           <a class="nv" data-type="DOMString           " href="#dom-clientdata-rpid">rpId</a>;
    <span class="kt">required</span> <a class="n" data-link-type="idl-name" href="#dictdef-algorithmidentifier">AlgorithmIdentifier</a> <a class="nv" data-type="AlgorithmIdentifier " href="#dom-clientdata-hashalg">hashAlg</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-jsonwebkey">JsonWebKey</a>                   <a class="nv" data-type="JsonWebKey                   " href="#dom-clientdata-tokenbinding">tokenBinding</a>;
    <a class="n" data-link-type="idl-name" href="#dictdef-webauthnextensions">WebAuthnExtensions</a>           <a class="nv" data-type="WebAuthnExtensions           " href="#dom-clientdata-extensions">extensions</a>;
};

<span class="kt">interface</span> <a class="nv" href="#attestationstatement">AttestationStatement</a> {
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <a class="nv" data-readonly="" data-type="unsigned long" href="#dom-attestationstatement-version">version</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-attestationstatement-claimedaaguid">claimedAAGUID</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>[]   <a class="nv" data-readonly="" data-type="DOMString[]" href="#dom-attestationstatement-x5c">x5c</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-attestationstatement-alg">alg</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-attestationstatement-rawdata">rawData</a>;
    <span class="kt">readonly</span>    <span class="kt">attribute</span> <span class="kt">ArrayBuffer</span>   <a class="nv" data-readonly="" data-type="ArrayBuffer" href="#dom-attestationstatement-signature">signature</a>;
};

<span class="kt">interface</span> <a class="nv" href="#androidattestation">AndroidAttestation</a> {
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">unsigned</span> <span class="kt">long</span> <a class="nv" data-readonly="" data-type="unsigned long" href="#dom-androidattestation-version">version</a>;
    <span class="kt">readonly</span> <span class="kt">attribute</span> <span class="kt">DOMString</span>     <a class="nv" data-readonly="" data-type="DOMString" href="#dom-androidattestation-safetynetresponse">safetyNetResponse</a>;
};

<span class="kt">dictionary</span> <a class="nv" href="#dictdef-androidattestationclientdata">AndroidAttestationClientData</a> : <a class="n" data-link-type="idl-name" href="#dictdef-clientdata">ClientData</a> {
    <a class="n" data-link-type="idl-name" href="#dictdef-jsonwebkey">JsonWebKey</a>    <a class="nv" data-type="JsonWebKey    " href="#dom-androidattestationclientdata-publickey">publicKey</a>;
    <span class="kt">boolean</span>       <a class="nv" data-type="boolean       " href="#dom-androidattestationclientdata-isinsidesecurehardware">isInsideSecureHardware</a>;
    <span class="kt">DOMString</span>     <a class="nv" data-type="DOMString     " href="#dom-androidattestationclientdata-userauthentication">userAuthentication</a>;
    <span class="kt">unsigned</span> <span class="kt">long</span> <a class="nv" data-type="unsigned long " href="#dom-androidattestationclientdata-userauthenticationvaliditydurationseconds">userAuthenticationValidityDurationSeconds</a>; // optional
};

<span class="kt">typedef</span> <span class="kt">sequence</span> &lt; <a class="n" data-link-type="idl-name" href="#typedefdef-aaguid">AAGUID</a> > <a class="nv" href="#typedefdef-authenticatorselectionlist">AuthenticatorSelectionList</a>;

<span class="kt">typedef</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a> <a class="nv" href="#typedefdef-aaguid">AAGUID</a>;

</pre>
  <aside class="dfn-panel" data-for="origin">
   <b><a href="#origin">#origin</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-origin-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-origin-2">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="promises">
   <b><a href="#promises">#promises</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-promises-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-promises-2">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="domexception">
   <b><a href="#domexception">#domexception</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-domexception-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-domexception-2">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-algorithmidentifier">
   <b><a href="#dictdef-algorithmidentifier">#dictdef-algorithmidentifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-algorithmidentifier-1">4. Web Authentication API</a>
    <li><a href="#ref-for-dictdef-algorithmidentifier-2">4.10.4. Cryptographic Algorithm Identifier (type AlgorithmIdentifier)</a>
    <li><a href="#ref-for-dictdef-algorithmidentifier-3">5.2.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-cryptokey">
   <b><a href="#dictdef-cryptokey">#dictdef-cryptokey</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-cryptokey-1">4. Web Authentication API</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-jsonwebkey">
   <b><a href="#dictdef-jsonwebkey">#dictdef-jsonwebkey</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-jsonwebkey-1">5.2.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
    <li><a href="#ref-for-dictdef-jsonwebkey-2">6.3.1. Signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestation-certificate">
   <b><a href="#attestation-certificate">#attestation-certificate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestation-certificate-1">6.1.3. Packed attestation statement certificate requirements</a>
    <li><a href="#ref-for-attestation-certificate-2">6.2.3. TPM attestation statement certificate requirements</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authentication">
   <b><a href="#authentication">#authentication</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authentication-1">1. Introduction</a> <a href="#ref-for-authentication-2">(2)</a>
    <li><a href="#ref-for-authentication-3">3. Terminology</a> <a href="#ref-for-authentication-4">(2)</a> <a href="#ref-for-authentication-5">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticator">
   <b><a href="#authenticator">#authenticator</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticator-1">1. Introduction</a> <a href="#ref-for-authenticator-2">(2)</a> <a href="#ref-for-authenticator-3">(3)</a> <a href="#ref-for-authenticator-4">(4)</a>
    <li><a href="#ref-for-authenticator-5">1.1. Use Cases</a>
    <li><a href="#ref-for-authenticator-6">2. Conformance</a>
    <li><a href="#ref-for-authenticator-7">3. Terminology</a> <a href="#ref-for-authenticator-8">(2)</a> <a href="#ref-for-authenticator-9">(3)</a> <a href="#ref-for-authenticator-10">(4)</a> <a href="#ref-for-authenticator-11">(5)</a> <a href="#ref-for-authenticator-12">(6)</a> <a href="#ref-for-authenticator-13">(7)</a>
    <li><a href="#ref-for-authenticator-14">5. WebAuthn Authenticator model</a>
    <li><a href="#ref-for-authenticator-15">5.2. Signature Format</a>
    <li><a href="#ref-for-authenticator-16">5.2.2. Authenticator data</a>
    <li><a href="#ref-for-authenticator-17">5.2.3. Generating a signature</a>
    <li><a href="#ref-for-authenticator-18">5.3. Credential Attestation Statements</a>
    <li><a href="#ref-for-authenticator-19">5.3.3.1. Privacy</a>
    <li><a href="#ref-for-authenticator-20">5.3.3.2. Attestation Certificate and Attestation Certificate CA Compromise</a>
    <li><a href="#ref-for-authenticator-21">6. Defined Attestation Formats</a>
    <li><a href="#ref-for-authenticator-22">6.1. Packed Attestation ("packed")</a>
    <li><a href="#ref-for-authenticator-23">6.1.1. Attestation rawData</a> <a href="#ref-for-authenticator-24">(2)</a>
    <li><a href="#ref-for-authenticator-25">6.1.2. Signature</a>
    <li><a href="#ref-for-authenticator-26">6.3. Android Attestation (type="android")</a>
    <li><a href="#ref-for-authenticator-27">8.3. SupportedExtensions Extension</a>
    <li><a href="#ref-for-authenticator-28">8.4. User Verification Index (UVI) Extension</a>
    <li><a href="#ref-for-authenticator-29">10. Sample scenarios</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authorization-gesture">
   <b><a href="#authorization-gesture">#authorization-gesture</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authorization-gesture-1">1.1.1. Registration</a>
    <li><a href="#ref-for-authorization-gesture-2">1.1.2. Authentication</a>
    <li><a href="#ref-for-authorization-gesture-3">1.1.3. Other use cases and configurations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ceremony">
   <b><a href="#ceremony">#ceremony</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ceremony-1">1. Introduction</a>
    <li><a href="#ref-for-ceremony-2">3. Terminology</a> <a href="#ref-for-ceremony-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="conforming-user-agent">
   <b><a href="#conforming-user-agent">#conforming-user-agent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-conforming-user-agent-1">1. Introduction</a>
    <li><a href="#ref-for-conforming-user-agent-2">2. Conformance</a> <a href="#ref-for-conforming-user-agent-3">(2)</a> <a href="#ref-for-conforming-user-agent-4">(3)</a>
    <li><a href="#ref-for-conforming-user-agent-5">3. Terminology</a> <a href="#ref-for-conforming-user-agent-6">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="etld1">
   <b><a href="#etld1">#etld1</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-etld1-1">3. Terminology</a>
    <li><a href="#ref-for-etld1-2">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-etld1-3">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="registration">
   <b><a href="#registration">#registration</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-registration-1">1. Introduction</a> <a href="#ref-for-registration-2">(2)</a>
    <li><a href="#ref-for-registration-3">3. Terminology</a> <a href="#ref-for-registration-4">(2)</a> <a href="#ref-for-registration-5">(3)</a> <a href="#ref-for-registration-6">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="relying-party">
   <b><a href="#relying-party">#relying-party</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relying-party-1">1. Introduction</a> <a href="#ref-for-relying-party-2">(2)</a> <a href="#ref-for-relying-party-3">(3)</a> <a href="#ref-for-relying-party-4">(4)</a>
    <li><a href="#ref-for-relying-party-5">3. Terminology</a> <a href="#ref-for-relying-party-6">(2)</a> <a href="#ref-for-relying-party-7">(3)</a> <a href="#ref-for-relying-party-8">(4)</a> <a href="#ref-for-relying-party-9">(5)</a> <a href="#ref-for-relying-party-10">(6)</a> <a href="#ref-for-relying-party-11">(7)</a> <a href="#ref-for-relying-party-12">(8)</a>
    <li><a href="#ref-for-relying-party-13">4.2. ScopedCredentialInfo Interface</a>
    <li><a href="#ref-for-relying-party-14">4.3. User Account Information (dictionary Account)</a>
    <li><a href="#ref-for-relying-party-15">4.5. Additional options for Credential Generation (dictionary CredentialOptions)</a>
    <li><a href="#ref-for-relying-party-16">4.9. Credential Attestation Statement (interface WebAuthnAttestation)</a> <a href="#ref-for-relying-party-17">(2)</a>
    <li><a href="#ref-for-relying-party-18">5. WebAuthn Authenticator model</a>
    <li><a href="#ref-for-relying-party-19">5.2. Signature Format</a>
    <li><a href="#ref-for-relying-party-20">6.1. Packed Attestation ("packed")</a>
    <li><a href="#ref-for-relying-party-21">7.3. Extending request parameters</a>
    <li><a href="#ref-for-relying-party-22">7.4. Extending client processing</a>
    <li><a href="#ref-for-relying-party-23">7.6. Example extension</a>
    <li><a href="#ref-for-relying-party-24">10.2. Authentication</a>
    <li><a href="#ref-for-relying-party-25">10.3. Decommissioning</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="relying-party-identifier">
   <b><a href="#relying-party-identifier">#relying-party-identifier</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-relying-party-identifier-1">5. WebAuthn Authenticator model</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="rp-id">
   <b><a href="#rp-id">#rp-id</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-rp-id-1">3. Terminology</a> <a href="#ref-for-rp-id-2">(2)</a>
    <li><a href="#ref-for-rp-id-3">5. WebAuthn Authenticator model</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="scoped-credential">
   <b><a href="#scoped-credential">#scoped-credential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-scoped-credential-1">1. Introduction</a> <a href="#ref-for-scoped-credential-2">(2)</a> <a href="#ref-for-scoped-credential-3">(3)</a> <a href="#ref-for-scoped-credential-4">(4)</a> <a href="#ref-for-scoped-credential-5">(5)</a>
    <li><a href="#ref-for-scoped-credential-6">3. Terminology</a> <a href="#ref-for-scoped-credential-7">(2)</a> <a href="#ref-for-scoped-credential-8">(3)</a> <a href="#ref-for-scoped-credential-9">(4)</a> <a href="#ref-for-scoped-credential-10">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user-consent">
   <b><a href="#user-consent">#user-consent</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-consent-1">1. Introduction</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="user-verification">
   <b><a href="#user-verification">#user-verification</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-user-verification-1">1. Introduction</a>
    <li><a href="#ref-for-user-verification-2">3. Terminology</a> <a href="#ref-for-user-verification-3">(2)</a> <a href="#ref-for-user-verification-4">(3)</a> <a href="#ref-for-user-verification-5">(4)</a> <a href="#ref-for-user-verification-6">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthn-assertion">
   <b><a href="#webauthn-assertion">#webauthn-assertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthn-assertion-1">1. Introduction</a>
    <li><a href="#ref-for-webauthn-assertion-2">3. Terminology</a> <a href="#ref-for-webauthn-assertion-3">(2)</a> <a href="#ref-for-webauthn-assertion-4">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthn-client">
   <b><a href="#webauthn-client">#webauthn-client</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthn-client-1">3. Terminology</a> <a href="#ref-for-webauthn-client-2">(2)</a>
    <li><a href="#ref-for-webauthn-client-3">5.2. Signature Format</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="web-authentication-api">
   <b><a href="#web-authentication-api">#web-authentication-api</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-web-authentication-api-1">1. Introduction</a> <a href="#ref-for-web-authentication-api-2">(2)</a> <a href="#ref-for-web-authentication-api-3">(3)</a>
    <li><a href="#ref-for-web-authentication-api-4">3. Terminology</a> <a href="#ref-for-web-authentication-api-5">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthentication">
   <b><a href="#webauthentication">#webauthentication</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthentication-1">4. Web Authentication API</a> <a href="#ref-for-webauthentication-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-makecredential">
   <b><a href="#dom-webauthentication-makecredential">#dom-webauthentication-makecredential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-makecredential-1">1. Introduction</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-2">4. Web Authentication API</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-3">4.10.3. Credential Descriptor (dictionary CredentialDescription)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-4">6.3.2. Verifying AndroidClientData specific contextual bindings</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-5">7. WebAuthn Extensions</a> <a href="#ref-for-dom-webauthentication-makecredential-6">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-7">7.2. Defining extensions</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-8">7.3. Extending request parameters</a> <a href="#ref-for-dom-webauthentication-makecredential-9">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-makecredential-10">8.2. Authenticator Selection Extension</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="accountinformation">
   <b><a href="#accountinformation">#accountinformation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-accountinformation-1">4.1.1. Create a new credential (makeCredential() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="cryptoparameters">
   <b><a href="#cryptoparameters">#cryptoparameters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-cryptoparameters-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-cryptoparameters-2">(2)</a> <a href="#ref-for-cryptoparameters-3">(3)</a> <a href="#ref-for-cryptoparameters-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="attestationchallenge">
   <b><a href="#attestationchallenge">#attestationchallenge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-attestationchallenge-1">4.1.1. Create a new credential (makeCredential() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-webauthentication-getassertion">
   <b><a href="#dom-webauthentication-getassertion">#dom-webauthentication-getassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-webauthentication-getassertion-1">1. Introduction</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-2">3. Terminology</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-3">4. Web Authentication API</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-4">4.8. WebAuthn Assertion Extensions (dictionary WebAuthnExtensions)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-5">4.10.3. Credential Descriptor (dictionary CredentialDescription)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-6">7. WebAuthn Extensions</a> <a href="#ref-for-dom-webauthentication-getassertion-7">(2)</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-8">7.2. Defining extensions</a>
    <li><a href="#ref-for-dom-webauthentication-getassertion-9">7.3. Extending request parameters</a> <a href="#ref-for-dom-webauthentication-getassertion-10">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="assertionchallenge">
   <b><a href="#assertionchallenge">#assertionchallenge</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assertionchallenge-1">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="scopedcredentialinfo">
   <b><a href="#scopedcredentialinfo">#scopedcredentialinfo</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-scopedcredentialinfo-1">4. Web Authentication API</a> <a href="#ref-for-scopedcredentialinfo-2">(2)</a>
    <li><a href="#ref-for-scopedcredentialinfo-3">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-scopedcredentialinfo-4">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-account">
   <b><a href="#dictdef-account">#dictdef-account</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-account-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-account-2">(2)</a>
    <li><a href="#ref-for-dictdef-account-3">5.1.1. The authenticatorMakeCredential operation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-scopedcredentialparameters">
   <b><a href="#dictdef-scopedcredentialparameters">#dictdef-scopedcredentialparameters</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-scopedcredentialparameters-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-scopedcredentialparameters-2">(2)</a>
    <li><a href="#ref-for-dictdef-scopedcredentialparameters-3">4.1.1. Create a new credential (makeCredential() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-credentialoptions">
   <b><a href="#dictdef-credentialoptions">#dictdef-credentialoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-credentialoptions-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-credentialoptions-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credentialoptions-timeoutseconds">
   <b><a href="#credentialoptions-timeoutseconds">#credentialoptions-timeoutseconds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credentialoptions-timeoutseconds-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-credentialoptions-timeoutseconds-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credentialoptions-excludelist">
   <b><a href="#credentialoptions-excludelist">#credentialoptions-excludelist</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credentialoptions-excludelist-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-credentialoptions-excludelist-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credentialoptions-extensions">
   <b><a href="#credentialoptions-extensions">#credentialoptions-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credentialoptions-extensions-1">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-credentialoptions-extensions-2">7.3. Extending request parameters</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthnassertion">
   <b><a href="#webauthnassertion">#webauthnassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthnassertion-1">3. Terminology</a>
    <li><a href="#ref-for-webauthnassertion-2">4. Web Authentication API</a> <a href="#ref-for-webauthnassertion-3">(2)</a>
    <li><a href="#ref-for-webauthnassertion-4">4.1.2. Use an existing credential (getAssertion() method)</a>
    <li><a href="#ref-for-webauthnassertion-5">5.2.3. Generating a signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-assertionoptions">
   <b><a href="#dictdef-assertionoptions">#dictdef-assertionoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-assertionoptions-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-assertionoptions-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="assertionoptions-timeoutseconds">
   <b><a href="#assertionoptions-timeoutseconds">#assertionoptions-timeoutseconds</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assertionoptions-timeoutseconds-1">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-assertionoptions-timeoutseconds-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="assertionoptions-allowlist">
   <b><a href="#assertionoptions-allowlist">#assertionoptions-allowlist</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assertionoptions-allowlist-1">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="assertionoptions-extensions">
   <b><a href="#assertionoptions-extensions">#assertionoptions-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-assertionoptions-extensions-1">4.1.2. Use an existing credential (getAssertion() method)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-webauthnextensions">
   <b><a href="#dictdef-webauthnextensions">#dictdef-webauthnextensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-webauthnextensions-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-webauthnextensions-2">(2)</a> <a href="#ref-for-dictdef-webauthnextensions-3">(3)</a>
    <li><a href="#ref-for-dictdef-webauthnextensions-4">5.2.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="webauthnattestation">
   <b><a href="#webauthnattestation">#webauthnattestation</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-webauthnattestation-1">4. Web Authentication API</a> <a href="#ref-for-webauthnattestation-2">(2)</a>
    <li><a href="#ref-for-webauthnattestation-3">5.2.3. Generating a signature</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="enumdef-credentialtype">
   <b><a href="#enumdef-credentialtype">#enumdef-credentialtype</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-enumdef-credentialtype-1">4. Web Authentication API</a> <a href="#ref-for-enumdef-credentialtype-2">(2)</a> <a href="#ref-for-enumdef-credentialtype-3">(3)</a> <a href="#ref-for-enumdef-credentialtype-4">(4)</a>
    <li><a href="#ref-for-enumdef-credentialtype-5">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-enumdef-credentialtype-6">4.10.2. Unique Identifier for Credential (interface Credential)</a>
    <li><a href="#ref-for-enumdef-credentialtype-7">5.1.1. The authenticatorMakeCredential operation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="credential">
   <b><a href="#credential">#credential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-credential-1">4. Web Authentication API</a> <a href="#ref-for-credential-2">(2)</a> <a href="#ref-for-credential-3">(3)</a>
    <li><a href="#ref-for-credential-4">4.10.3. Credential Descriptor (dictionary CredentialDescription)</a>
    <li><a href="#ref-for-credential-5">5.1.1. The authenticatorMakeCredential operation</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-credentialdescription">
   <b><a href="#dictdef-credentialdescription">#dictdef-credentialdescription</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-credentialdescription-1">4. Web Authentication API</a> <a href="#ref-for-dictdef-credentialdescription-2">(2)</a> <a href="#ref-for-dictdef-credentialdescription-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatormakecredential">
   <b><a href="#authenticatormakecredential">#authenticatormakecredential</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatormakecredential-1">3. Terminology</a> <a href="#ref-for-authenticatormakecredential-2">(2)</a>
    <li><a href="#ref-for-authenticatormakecredential-3">4.1.1. Create a new credential (makeCredential() method)</a>
    <li><a href="#ref-for-authenticatormakecredential-4">5.1.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatormakecredential-5">(2)</a>
    <li><a href="#ref-for-authenticatormakecredential-6">7. WebAuthn Extensions</a>
    <li><a href="#ref-for-authenticatormakecredential-7">7.2. Defining extensions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatorgetassertion">
   <b><a href="#authenticatorgetassertion">#authenticatorgetassertion</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatorgetassertion-1">3. Terminology</a> <a href="#ref-for-authenticatorgetassertion-2">(2)</a>
    <li><a href="#ref-for-authenticatorgetassertion-3">4.1.2. Use an existing credential (getAssertion() method)</a>
    <li><a href="#ref-for-authenticatorgetassertion-4">5.1.3. The authenticatorCancel operation</a> <a href="#ref-for-authenticatorgetassertion-5">(2)</a>
    <li><a href="#ref-for-authenticatorgetassertion-6">5.2.2. Authenticator data</a>
    <li><a href="#ref-for-authenticatorgetassertion-7">7. WebAuthn Extensions</a>
    <li><a href="#ref-for-authenticatorgetassertion-8">7.2. Defining extensions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatorcancel">
   <b><a href="#authenticatorcancel">#authenticatorcancel</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatorcancel-1">4.1.1. Create a new credential (makeCredential() method)</a> <a href="#ref-for-authenticatorcancel-2">(2)</a> <a href="#ref-for-authenticatorcancel-3">(3)</a>
    <li><a href="#ref-for-authenticatorcancel-4">4.1.2. Use an existing credential (getAssertion() method)</a> <a href="#ref-for-authenticatorcancel-5">(2)</a> <a href="#ref-for-authenticatorcancel-6">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dictdef-clientdata">
   <b><a href="#dictdef-clientdata">#dictdef-clientdata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dictdef-clientdata-1">5.2.1. Client data used in WebAuthn signatures (dictionary ClientData)</a>
    <li><a href="#ref-for-dictdef-clientdata-2">5.2.3. Generating a signature</a> <a href="#ref-for-dictdef-clientdata-3">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-4">6.3.1. Signature</a>
    <li><a href="#ref-for-dictdef-clientdata-5">7. WebAuthn Extensions</a> <a href="#ref-for-dictdef-clientdata-6">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-7">7.2. Defining extensions</a> <a href="#ref-for-dictdef-clientdata-8">(2)</a>
    <li><a href="#ref-for-dictdef-clientdata-9">7.4. Extending client processing</a> <a href="#ref-for-dictdef-clientdata-10">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdata-hashalg">
   <b><a href="#clientdata-hashalg">#clientdata-hashalg</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdata-hashalg-1">5.2.3. Generating a signature</a> <a href="#ref-for-clientdata-hashalg-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdata-extensions">
   <b><a href="#clientdata-extensions">#clientdata-extensions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdata-extensions-1">7.4. Extending client processing</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="authenticatordata">
   <b><a href="#authenticatordata">#authenticatordata</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-authenticatordata-1">5.1.2. The authenticatorGetAssertion operation</a>
    <li><a href="#ref-for-authenticatordata-2">5.2.3. Generating a signature</a> <a href="#ref-for-authenticatordata-3">(2)</a>
    <li><a href="#ref-for-authenticatordata-4">7. WebAuthn Extensions</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdatajson">
   <b><a href="#clientdatajson">#clientdatajson</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdatajson-1">4.9. Credential Attestation Statement (interface WebAuthnAttestation)</a>
    <li><a href="#ref-for-clientdatajson-2">5.2.3. Generating a signature</a> <a href="#ref-for-clientdatajson-3">(2)</a> <a href="#ref-for-clientdatajson-4">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="clientdatahash">
   <b><a href="#clientdatahash">#clientdatahash</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-clientdatahash-1">5.2.3. Generating a signature</a> <a href="#ref-for-clientdatahash-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="client-argument">
   <b><a href="#client-argument">#client-argument</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-client-argument-1">7.3. Extending request parameters</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="content">
   <b><a href="#content">#content</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-content-1">8.1. Transaction authorization</a> <a href="#ref-for-content-2">(2)</a> <a href="#ref-for-content-3">(3)</a> <a href="#ref-for-content-4">(4)</a> <a href="#ref-for-content-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-authenticatorselectionlist">
   <b><a href="#typedefdef-authenticatorselectionlist">#typedefdef-authenticatorselectionlist</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-authenticatorselectionlist-1">8.2. Authenticator Selection Extension</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="typedefdef-aaguid">
   <b><a href="#typedefdef-aaguid">#typedefdef-aaguid</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-typedefdef-aaguid-1">8.2. Authenticator Selection Extension</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>